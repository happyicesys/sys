import{_ as b}from"./Button.97b1564e.js";import{_ as P}from"./Modal.934cf1a6.js";import{_ as j}from"./MultiSelect.9cef86ba.js";import{g as w,Q as k,h as E,c as h,a as y,w as v,p as L,o as s,b as o,f as n,l as r,t as d,n as i,d as C,u as c,k as N,F as I,O as S}from"./app.a6aad98f.js";import{r as T,a as U}from"./ChevronDoubleUpIcon.667ae553.js";import{r as Y}from"./PencilSquareIcon.518a4297.js";import{r as z}from"./CheckCircleIcon.9b9a1727.js";import"./keyboard.5a52b4b6.js";import"./disposables.eeb45e0a.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.1a2eb786.js";const A={key:0,class:"text-gray-600"},G={key:1},J={key:2},Q={class:"flex flex-col"},H={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},K={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},R={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},W={class:"table-fixed min-w-full divide-y divide-gray-300"},X={class:"bg-gray-50"},Z=o("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," # ",-1),ee={key:0,scope:"col",class:"w-2/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},te=o("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Sold ",-1),se=o("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Bal ",-1),oe=o("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Cap ",-1),ne={scope:"col",class:"w-2/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},re={key:0},ae={key:1,scope:"col",class:"w-2/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},de={key:0},ce=o("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Group ",-1),ie=o("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Error ",-1),le={key:2,scope:"col",class:"w-3/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},ue={key:3,scope:"col",class:"w-3/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},pe={key:4,scope:"col",class:"w-3/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},me={key:5,scope:"col",class:"w-3/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},xe={class:"bg-white"},_e={key:0,class:"whitespace-nowrap text-sm font-semibold text-gray-900 text-center"},ye={class:"flex justify-center items-center"},ve=["src"],ge={key:0},fe={class:"font-bold"},he={key:0},be={key:0},we={key:1,class:"break-normal text-xs"},ke=o("br",null,null,-1),Ce={key:1,class:"font-normal text-xs text-gray-700"},De={key:5,class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},$e={class:"flex justify-center space-x-1"},Oe=o("span",null," Dispense ",-1),Se={class:"flex justify-between"},qe={key:0,class:"flex space-x-1"},Ve=o("span",null," Edit Product ",-1),Be={key:1,class:"flex space-x-1"},Fe=o("span",null," Save ",-1),Me={key:0,class:"flex flex-col text-blue-800 text-sm p-3"},Pe={key:0,class:""},je={key:1},Je={__name:"ChannelOverview",props:{productOptions:Object,vend:Object,showModal:Boolean},emits:["modalClose"],setup(t,{emit:q}){const g=t,l=w([]),u=k().props.auth.operatorCountry,D=k().props.auth.permissions,$=w([]),f=w(!1);E(()=>{$.value=g.productOptions.data.map(a=>({id:a.id,full_name:a.full_name+(a.desc?" "+a.desc:"")})),l.value=g.vend.vendChannelsJson.map(a=>({...a,product:a.product?{...a.product,option_data:{id:a.product.id,full_name:a.product.code+" - "+a.product.name+(a.product.desc?" "+a.product.desc:"")}}:null}))});const x=k().props.auth.profile,_=w(!1),O=q;function V(a){S.post("/vends/"+g.vend.id+"/dispense-product",{channel_id:a.id},{preserveScroll:!0,onSuccess:()=>{O("modalClose")}})}function B(){_.value?S.post("/vends/"+g.vend.id+"/edit-products",{channels:l.value.map(a=>({id:a.id,product_id:a.product.id,edited_product_id:a.product.option_data.id}))},{preserveScroll:!0,onSuccess:()=>{_.value=!1,O("modalClose")}}):_.value=!0}function F(a){return moment(a).format("YYMMDD hh:mm A")}return(a,p)=>(s(),h(L,{to:"body"},[y(P,{open:t.showModal,onModalClose:p[3]||(p[3]=e=>a.$emit("modalClose"))},{header:v(()=>[o("div",{class:i(["flex flex-col md:flex-row space-x-2",[t.vend.is_active?"text-black":"text-gray-500"]])},[g.profile?(s(),n("span",A," Channel Overview ")):r("",!0),t.vend.code?(s(),n("span",G," ID# "+d(t.vend.code),1)):r("",!0),t.vend.customer_code?(s(),n("span",J," ("+d(t.vend.customer_code?t.vend.customer_code:null)+") "+d(t.vend.customer_name?t.vend.customer_name:null),1)):r("",!0)],2)]),default:v(()=>[o("div",Q,[o("div",H,[o("div",K,[o("div",R,[o("table",W,[o("thead",X,[o("tr",null,[Z,t.vend.product_mapping_name?(s(),n("th",ee," Image ")):r("",!0),te,se,oe,o("th",ne,[C(" Price "),c(x)&&c(x).base_currency?(s(),n("span",re," ("+d(c(x).base_currency.currency_symbol)+") ",1)):r("",!0)]),l.value.some(e=>"amount2"in e)?(s(),n("th",ae,[C(" Price 2 "),c(x)&&c(x).base_currency?(s(),n("span",de," ("+d(c(x).base_currency.currency_symbol)+") ",1)):r("",!0)])):r("",!0),ce,ie,t.vend.product_mapping_name?(s(),n("th",le," Product ")):r("",!0),l.value.some(e=>"sku_code"in e)?(s(),n("th",ue," Product Code ")):r("",!0),l.value.some(e=>"qty_not_available_duration"in e)?(s(),n("th",pe," Last Out Of Stock Duration ")):r("",!0),c(D).includes("admin-access vends")?(s(),n("th",me,[!f.value&&t.vend.is_mqtt?(s(),h(b,{key:0,class:"inline-flex space-x-1 items-center rounded-md border border-green bg-gray-200 px-4 py-2 md:px-3 text-sm font-medium leading-4 text-gray-800 shadow-sm hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:p[0]||(p[0]=e=>f.value=!0)},{default:v(()=>[y(c(T),{class:"h-3 w-3","aria-hidden":"true"})]),_:1})):r("",!0),f.value&&t.vend.is_mqtt?(s(),h(b,{key:1,class:"inline-flex space-x-1 items-center rounded-md border border-green bg-gray-300 px-4 py-2 md:px-3 text-sm font-medium leading-4 text-gray-800 shadow-sm hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:p[1]||(p[1]=e=>f.value=!1)},{default:v(()=>[y(c(U),{class:"h-3 w-3","aria-hidden":"true"})]),_:1})):r("",!0)])):r("",!0)])]),o("tbody",xe,[(s(!0),n(I,null,N(l.value,(e,M)=>(s(),n("tr",{key:e.id,class:i(M%2===0?void 0:"bg-gray-50")},[o("td",{class:i(["whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold sm:pl-6 text-center",[t.vend.is_active?"text-gray-900":"text-gray-500"]])},d(e.code),3),t.vend.product_mapping_name?(s(),n("td",_e,[o("div",ye,[e.product&&e.product.thumbnail?(s(),n("img",{key:0,class:"h-16 w-16 rounded-full",src:e.product.thumbnail.full_url,alt:""},null,8,ve)):r("",!0)])])):r("",!0),o("td",{class:i(["whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium sm:pl-6 text-center",[t.vend.is_active?"text-blue-600":"text-gray-400"]])},d(e.capacity-e.qty),3),o("td",{class:i(["whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium sm:pl-6 text-center",[t.vend.is_active?"text-gray-900":"text-gray-400"]])},d(e.qty),3),o("td",{class:i(["whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium sm:pl-6 text-center",[t.vend.is_active?"text-gray-900":"text-gray-400"]])},d(e.capacity),3),o("td",{class:i(["whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium sm:pl-6 text-center",[t.vend.is_active?"text-gray-900":"text-gray-400"]])},d((e.amount/100).toLocaleString(void 0,{minimumFractionDigits:c(u).is_currency_exponent_hidden?0:c(u).currency_exponent,maximumFractionDigits:c(u).is_currency_exponent_hidden?0:c(u).currency_exponent})),3),l.value.some(m=>"amount2"in m)?(s(),n("td",{key:1,class:i(["whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium sm:pl-6 text-center",[t.vend.is_active?"text-gray-900":"text-gray-400"]])},d((e.amount2/100).toLocaleString(void 0,{minimumFractionDigits:c(u).is_currency_exponent_hidden?0:c(u).currency_exponent,maximumFractionDigits:c(u).is_currency_exponent_hidden?0:c(u).currency_exponent})),3)):r("",!0),o("td",{class:i(["whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium sm:pl-6 text-center",[t.vend.is_active?"text-gray-900":"text-gray-400"]])},d(e.discount_group),3),o("td",{class:i(["py-1 pl-1 pr-1 text-xs font-medium sm:pl-1 text-center",[t.vend.is_active?"text-gray-900":"text-gray-400"]])},[e.vend_channel_error_logs&&e.vend_channel_error_logs[0]&&e.vend_channel_error_logs[0].is_error_cleared==0?(s(),n("span",ge,[o("div",{class:i([e.vend_channel_error_logs[0].vend_channel_error.code==4||e.vend_channel_error_logs[0].vend_channel_error.code==5||e.vend_channel_error_logs[0].vend_channel_error.code==7?" text-blue-800":" text-red-800"])},[o("span",fe," ("+d(e.vend_channel_error_logs[0].vend_channel_error.code)+") ",1),o("div",null,d(F(e.vend_channel_error_logs[0].created_at)),1)],2)])):r("",!0)],2),t.vend.product_mapping_name?(s(),n("td",{key:2,class:i(["py-4 text-sm font-semibold text-center",[t.vend.is_active?"text-gray-900":"text-gray-400"]])},[_.value?(s(),n("span",Ce,[y(j,{modelValue:e.product.option_data,"onUpdate:modelValue":m=>e.product.option_data=m,options:$.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","onUpdate:modelValue","options"])])):(s(),n("span",he,[e.product&&e.product.code?(s(),n("span",be,d(e.product.code),1)):r("",!0),e.product&&e.product.name?(s(),n("span",we,[ke,C(" "+d(e.product.name),1)])):r("",!0)]))],2)):r("",!0),l.value.some(m=>"sku_code"in m)?(s(),n("td",{key:3,class:i(["whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium sm:pl-6 text-center",[t.vend.is_active?"text-gray-900":"text-gray-400"]])},d(e.sku_code),3)):r("",!0),l.value.some(m=>"qty_not_available_duration"in m)?(s(),n("td",{key:4,class:i(["whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium sm:pl-6 text-center",[t.vend.is_active?"text-gray-900":"text-gray-400"]])},d(e.qty_not_available_duration),3)):r("",!0),c(D).includes("admin-access vends")&&t.vend.is_active?(s(),n("td",De,[o("div",$e,[t.vend.is_mqtt&&f.value?(s(),h(b,{key:0,type:"button",class:"bg-yellow-300 hover:bg-yellow-400 px-1 py-1 text-xs text-gray-800 flex space-x-1",onClick:m=>V(e)},{default:v(()=>[Oe]),_:2},1032,["onClick"])):r("",!0)])])):r("",!0)],2))),128))])])])])])]),o("div",Se,[o("span",null,[t.vend.product_mapping_name?(s(),h(b,{key:0,type:"button",class:i(["px-2 py-1 mt-2 ml-1 text-xs flex space-x-1",[_.value?"bg-green-300 hover:bg-green-400 text-green-800":"bg-gray-300 hover:bg-gray-400 text-gray-800"]]),onClick:p[2]||(p[2]=e=>B())},{default:v(()=>[_.value?(s(),n("span",Be,[y(c(z),{class:"w-4 h-4"}),Fe])):(s(),n("span",qe,[y(c(Y),{class:"w-4 h-4"}),Ve]))]),_:1},8,["class"])):r("",!0)]),t.vend.product_mapping_name?(s(),n("span",Me,[t.vend.product_mapping_name?(s(),n("span",Pe,d(t.vend.product_mapping_name),1)):r("",!0),t.vend.product_mapping_remarks?(s(),n("span",je,d(t.vend.product_mapping_remarks),1)):r("",!0)])):r("",!0)])]),_:1},8,["open"])]))}};export{Je as default};
