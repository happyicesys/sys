import{g as p,T as x,K as h,S as $,h as j,f as v,a as i,u,w as m,F as N,o as n,Z as E,b as t,d as c,t as _,l as d,n as k,e as F,c as f,m as Y,v as A,i as P}from"./app.7a52fff4.js";import{_ as q}from"./Authenticated.c11b5ceb.js";import{_ as y}from"./Button.ad148267.js";import{_ as H}from"./DatePicker.2e50075e.js";import{_ as V}from"./FormInput.19b26ce1.js";import{_ as B}from"./MultiSelect.c8f00172.js";import{_ as I,r as K,a as T}from"./SearchVendCodeInput.95ecf875.js";import{r as z}from"./ArrowUturnLeftIcon.988ce1f8.js";import{r as R}from"./ArrowUturnDownIcon.e50bcac0.js";import{r as Z}from"./CheckCircleIcon.f084039b.js";import"./open-closed.236ff056.js";import"./use-resolve-button-type.bfc763d7.js";import"./RectangleStackIcon.d4391480.js";import"./main.67ae498c.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.ce716651.js";import"./MagnifyingGlassCircleIcon.0fe22ba2.js";import"./disposables.d4b95036.js";const G={class:"font-semibold text-xl text-gray-800 leading-tight"},J={key:0},L={key:1},Q=t("br",null,null,-1),W={key:2},X=t("br",null,null,-1),ee={class:"flex flex-col"},te={class:"font-bold"},se={class:"m-2 sm:mx-5 sm:my-3 px-1 sm:px-2 lg:px-3"},oe={class:"mt-6 flex flex-col"},ae={class:"-my-2 -mx-4 sm:-mx-6 lg:-mx-8"},le={class:"shadow-sm ring-1 ring-black ring-opacity-5 overflow-scroll p-5"},re=["onSubmit"],ne={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-2"},ie={class:"sm:col-span-6"},de={class:"sm:col-span-6"},ue={class:"relative flex items-start"},me={class:"flex h-6 items-center"},ce=["disabled"],ve=t("div",{class:"ml-3 text-sm leading-6"},[t("label",{for:"is_customer",class:"font-medium text-gray-900"},"Customer Binding?"),c(" "+_(" ")+" "),t("span",{id:"is_customer",class:"text-gray-500"},[t("span",{class:"sr-only"},"Customer Binding?"),c("retrieve customer data from cms")])],-1),pe={key:0,class:"sm:col-span-6"},_e=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),fe={key:1,class:"sm:col-span-6"},ge={class:"sm:col-span-6"},ye=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Operator ",-1),be={class:"sm:col-span-3"},xe={class:"sm:col-span-6"},he={class:"sm:col-span-6"},ke={class:"flex flex-col space-y-1 sm:flex-row sm:space-x-1 sm:space-y-0 mt-5 justify-end"},Ve=t("span",null," Back ",-1),we=t("span",null," Unbind Customer ",-1),Ce={key:0,class:"flex"},Se={key:1,class:"flex"},$e=t("span",null," Save ",-1),ze={__name:"Edit",props:{adminCustomerOptions:Object,operatorOptions:Object,vend:Object,type:String},setup(s){const r=s,w=p([]);p([]);const e=p(x(S()));p(!1);const C=p([]),b=p("");h().props.auth.operatorCountry,h().props.auth.operatorRole;const g=h().props.auth.permissions;p($().format("HH:mm:ss")),j(()=>{r.type=="create"?b.value="Create New":b.value="Edit",w.value=r.adminCustomerOptions.map(o=>({id:o.id,full_name:o.cust_id+" - "+o.company})),C.value=[...r.operatorOptions.data.map(o=>({id:o.id,full_name:o.full_name}))],e.value=r.vend&&r.vend.id?x(r.vend):x(S()),e.value.name=r.vend.name,r.vend.customer_id&&(e.value.is_customer=!0,e.value.customer_id={id:r.vend.person_id,full_name:r.vend.customer_code+" - "+r.vend.customer_name}),r.vend.operator_id&&(e.value.operator_id={id:r.vend.operator_id,full_name:r.vend.operator_name})});function S(){return{code:"",name:"",begin_date:$().format("YYYY-MM-DD"),customer_id:"",operator_id:"",serial_num:"",termination_date:"",private_key:""}}function O(o){e.value.code=o.code}function U(){e.value.clearErrors(),r.type==="create"&&e.value.transform(o=>({...o,customer_id:o.customer_id?o.customer_id.id:null,operator_id:o.operator_id?o.operator_id.id:null})).post("/vends/create",{preserveState:!0,replace:!0}),r.type==="update"&&e.value.transform(o=>({...o,customer_id:o.customer_id?o.customer_id.id:null,operator_id:o.operator_id?o.operator_id.id:null})).post("/vends/"+e.value.id+"/update",{preserveState:!0,replace:!0})}function D(o){e.value.post("/vends/"+o+"/unbind",{onSuccess:()=>{e.value.is_customer=!1,e.value.customer_id="",e.value.begin_date=""},preserveState:!0,replace:!0})}function M(){e.value.post("/settings/"+e.value.id+"/toggle-activation",{})}return(o,a)=>(n(),v(N,null,[i(u(E),{title:"VM Management"}),i(q,null,{header:m(()=>[t("h2",G,[c(_(b.value)+" Vending Machine ",1),s.type=="update"?(n(),v("span",J,_(s.vend.code),1)):d("",!0),s.vend.customer_name?(n(),v("span",L,[Q,c(" "+_(s.vend.customer_code)+" - "+_(s.vend.customer_name),1)])):!s.vend.customer_name&&s.vend.name?(n(),v("span",W,[X,c(" "+_(s.vend.name),1)])):d("",!0)]),t("span",null,[s.vend.is_active!=null?(n(),v("div",{key:0,class:k(["inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border min-w-fit",[s.vend.is_active?"bg-green-200":"bg-red-200"]])},[t("div",ee,[t("span",te,_(s.vend.is_active?"Active":"Inactive"),1)])],2)):d("",!0)])]),default:m(()=>[t("div",se,[t("div",oe,[t("div",ae,[t("div",le,[t("form",{onSubmit:F(U,["prevent"]),id:"submit"},[t("div",ne,[t("div",ie,[s.type=="update"?(n(),f(V,{key:0,modelValue:e.value.code,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.code=l),error:e.value.errors.code,required:"true",disabled:s.vend.code},{default:m(()=>[c(" Code ")]),_:1},8,["modelValue","error","disabled"])):d("",!0),s.type=="create"?(n(),f(I,{key:1,modelValue:e.value.code,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.code=l),onSelected:O,required:"true",error:e.value.errors.code},{default:m(()=>[c(" Code ")]),_:1},8,["modelValue","error"])):d("",!0)]),t("div",de,[t("div",ue,[t("div",me,[Y(t("input",{"aria-describedby":"is_customer","onUpdate:modelValue":a[2]||(a[2]=l=>e.value.is_customer=l),disabled:s.vend.customer_id&&s.type=="update",name:"is_customer",type:"checkbox",class:k(["h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600",[s.vend.customer_id&&s.type=="update"?"bg-gray-200 hover:cursor-not-allowed":""]])},null,10,ce),[[A,e.value.is_customer]])]),ve])]),e.value.is_customer?(n(),v("div",pe,[_e,i(B,{modelValue:e.value.customer_id,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.customer_id=l),options:w.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"])])):d("",!0),e.value.is_customer?d("",!0):(n(),v("div",fe,[i(V,{modelValue:e.value.name,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.name=l),error:e.value.errors.name},{default:m(()=>[c(" Name ")]),_:1},8,["modelValue","error"])])),t("div",ge,[ye,i(B,{modelValue:e.value.operator_id,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.operator_id=l),options:C.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"])]),t("div",be,[u(g).includes("update vends")?(n(),f(H,{key:0,modelValue:e.value.begin_date,"onUpdate:modelValue":a[6]||(a[6]=l=>e.value.begin_date=l),error:e.value.errors.begin_date,onInput:a[7]||(a[7]=l=>o.onDateFromChanged())},{default:m(()=>[c(" Begin Date ")]),_:1},8,["modelValue","error"])):d("",!0)]),t("div",xe,[i(V,{modelValue:e.value.private_key,"onUpdate:modelValue":a[8]||(a[8]=l=>e.value.private_key=l),error:e.value.errors.private_key,disabled:!u(g).includes("update vends")},{default:m(()=>[c(" Private Key ")]),_:1},8,["modelValue","error","disabled"])])]),t("div",he,[t("div",ke,[i(u(P),{href:"/settings",class:"bg-gray-300 hover:bg-gray-400 text-gray-700 rounded"},{default:m(()=>[i(y,{class:"space-x-1"},{default:m(()=>[i(u(z),{class:"w-4 h-4"}),Ve]),_:1})]),_:1}),s.vend.customer_id&&u(g).includes("update vends")?(n(),f(y,{key:0,type:"button",class:"bg-yellow-500 hover:bg-yellow-600 text-white flex space-x-1",onClick:a[9]||(a[9]=l=>D(e.value.id))},{default:m(()=>[i(u(R),{class:"w-4 h-4"}),we]),_:1})):d("",!0),u(g).includes("update vends")&&s.vend.is_active!=null?(n(),f(y,{key:1,type:"button",class:k(["text-white flex space-x-1",[s.vend.is_active?"bg-yellow-500 hover:bg-yellow-600":"bg-green-500 hover:bg-green-600"]]),onClick:a[10]||(a[10]=l=>M())},{default:m(()=>[s.vend.is_active?d("",!0):(n(),v("span",Ce,[i(u(K),{class:"w-4 h-4 pt-1"}),c("Activate ")])),s.vend.is_active?(n(),v("span",Se,[i(u(T),{class:"w-4 h-4 pt-1"}),c("Deactivate ")])):d("",!0)]),_:1},8,["class"])):d("",!0),u(g).includes("update vends")?(n(),f(y,{key:2,type:"submit",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1"},{default:m(()=>[i(u(Z),{class:"w-4 h-4"}),$e]),_:1})):d("",!0)])])],40,re)])])])])]),_:1})],64))}};export{ze as default};
