import{g as v,T as w,Q as F,h as U,f as l,a as c,u,w as m,F as j,o as d,Z as I,b as e,t as p,e as g,l as r,c as f,d as x,m as J,S as P,i as R,k as A,n as H,O as L}from"./app.23f69410.js";import{_ as T}from"./Authenticated.c333a0a9.js";import{_ as h}from"./Button.e02061ca.js";import{_ as $}from"./DatePicker.c363f5ff.js";import{_ as D}from"./MultiSelect.0de761bc.js";import{r as z}from"./CheckCircleIcon.b60b0ec7.js";import{r as K}from"./ArrowPathIcon.81a1df20.js";import{r as Q}from"./ArrowUturnLeftIcon.12a5659c.js";import{r as Y}from"./XCircleIcon.311d6b8e.js";import{r as Z}from"./PaperClipIcon.36098c01.js";import"./keyboard.0c05cab2.js";import"./use-resolve-button-type.8f594bcf.js";import"./RectangleStackIcon.86791b6c.js";import"./main.1b1d7bb9.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.b143ea91.js";const q={class:"font-semibold text-xl text-gray-800 leading-tight"},G={class:"m-2 sm:mx-5 sm:my-3 px-1 sm:px-2 lg:px-3"},W={class:"mt-6 flex flex-col"},X={class:"-my-2 -mx-4 sm:-mx-6 lg:-mx-8"},ee={class:"shadow-sm ring-1 ring-black ring-opacity-5 p-5 mb-3"},te={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},se=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Vending Machine ")])])],-1),oe={key:0,class:"sm:col-span-5"},ne=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vend ID# ",-1),ie={class:"mt-1"},de=["value"],ae={class:"sm:col-span-2"},re={class:"sm:col-span-2"},le={class:"sm:col-span-5"},ce=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Is Factory? ",-1),ue={key:0,class:"text-sm text-red-600"},me={class:"sm:col-span-6"},ve={class:"flex space-x-1"},_e=e("span",null," Save Vending Machine ",-1),pe=e("span",null," Restart ",-1),ge=e("div",{class:"relative mb-5"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-2 bg-white text-lg font-medium text-gray-900 rounded"}," Customer ")])],-1),fe={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},xe={class:"sm:col-span-6"},he={key:0,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-green-300"},be=e("div",{class:"flex flex-col"}," From CMS ",-1),ye=[be],we={key:1,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-gray-300"},ke=e("div",{class:"flex flex-col"}," No Customer Binding ",-1),Ce=[ke],Ve={key:0,class:"sm:col-span-6"},Se=e("legend",{class:"sr-only"},"Plan",-1),Oe={class:"space-y-5"},je={class:"relative flex items-start"},$e={class:"flex h-6 items-center"},De=e("div",{class:"ml-3 text-sm leading-6"},[e("label",{for:"is_existing",class:"font-medium text-gray-900"},"Select Existing Customer")],-1),Ee={key:1,class:"sm:col-span-6"},Ne={class:"sm:col-span-6"},Me=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),Be={key:2,class:"sm:col-span-6"},Fe=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),Ue={class:"mt-1"},Ie=["value"],Je={key:3,class:"sm:col-span-6"},Pe=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),Re={class:"mt-1"},Ae=["value"],He={key:4,class:"sm:col-span-6 text-blue-600 text-xs"},Le=["href"],Te={key:5,class:"sm:col-span-6 text-blue-600 text-xs"},ze=["href"],Ke={class:"sm:col-span-6 pb-3"},Qe={class:"flex justify-between"},Ye={class:"flex space-x-1"},Ze=e("span",null," Back ",-1),qe=e("span",null," Unbind VM & Customer ",-1),Ge={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},We=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," APK Logs ")])])],-1),Xe={class:"sm:col-span-6 flex flex-col mt-3"},et={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},tt={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},st={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},ot={class:"min-w-full divide-y divide-gray-300"},nt=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," # "),e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Created At "),e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," File ")])],-1),it={class:"bg-white"},dt={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},at={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},rt={class:"whitespace-nowrap py-4 text-sm text-center"},lt={class:"flex w-0 space-x-2 items-center"},ct=["href"],ut={key:0},mt=e("td",{colspan:"3",class:"whitespace-nowrap py-4 text-sm font-medium text-black text-center"}," No records found ",-1),vt=[mt],$t={__name:"Edit",props:{adminCustomerOptions:Object,countries:Object,operatorOptions:Object,vend:Object,type:String},setup(t){const n=t,o=v(w(S())),k=v([]),b=v([{id:"true",value:"Yes"},{id:"false",value:"No"}]),C=v([]),y=v(1),V=v([]),_=F().props.auth.permissions;function S(){return{id:"",begin_date:"",code:"",customer_id:"",customer:{operator_id:"",begin_date:"",termination_date:"",id:"",code:"",name:"",address:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""},contact:{name:"",email:"",phone_country_id:"",phone_num:""}},termination_date:"",is_testing:""}}U(()=>{C.value=n.countries.data,V.value=n.operatorOptions.data,o.value=n.vend?w({...n.vend,is_testing:n.vend.is_testing==1?b.value.find(i=>i.id==="true"):b.value.find(i=>i.id==="false"),customer:{...JSON.parse(JSON.stringify(n.vend.customer)),code:n.vend.customer&&n.vend.customer.person_id?n.vend.customer.virtual_customer_code+" ("+n.vend.customer.virtual_customer_prefix+")":n.vend.customer?n.vend.customer.code:null,operator_id:n.vend.customer&&n.vend.customer.operator_id?V.value.find(i=>i.id===n.vend.customer.operator_id):null,contact:n.vend.customer?{...JSON.parse(JSON.stringify(n.vend.customer.contact))}:{name:"",email:"",phone_country_id:"",phone_num:""},address:n.vend.customer?{...n.vend.customer.delivery_address,country_id:n.vend&&n.vend.customer&&n.vend.customer.delivery_address?C.value.find(i=>i.id===n.vend.customer.delivery_address.country_id):null}:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""}}}):w(S()),k.value=n.adminCustomerOptions.data.map(i=>({id:i.id,full_name:i.person_id?i.virtual_customer_code+" ("+i.virtual_customer_prefix+") - "+i.name:i.code+" - "+i.name}))});function E(i){L.post("/vends/"+i+"/restart",{},{preserveScroll:!0,preserveState:!0,replace:!0,onSuccess:()=>{emit("modalClose")}})}function N(i){o.value.clearErrors(),o.value.transform(s=>({...s,begin_date:s.begin_date&&s.begin_date!="Invalid date"?s.begin_date:null,termination_date:s.termination_date&&s.termination_date!="Invalid date"?s.termination_date:null,is_testing:s.is_testing.id})).post("/vends/"+i+"/update",{onSuccess:()=>{},preserveState:!0,replace:!0})}function M(){o.value.clearErrors(),o.value.post("/vends/"+o.value.id+"/update",{onSuccess:()=>{emit("modalClose")},preserveState:!0,replace:!0})}function B(i){o.value.post("/vends/"+i+"/unbind-customer/vends",{onSuccess:()=>{},preserveState:!0,replace:!0})}return(i,s)=>(d(),l(j,null,[c(u(I),{title:"VM Edit"}),c(T,null,{header:m(()=>[e("h2",q," Editing Vending Machine "+p(t.vend.code),1)]),default:m(()=>[e("div",G,[e("div",W,[e("div",X,[e("div",ee,[e("form",{onSubmit:g(M,["prevent"]),id:"submit"},[e("div",te,[se,t.vend?(d(),l("div",oe,[ne,e("div",ie,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:t.vend?t.vend.code:"",disabled:""},null,8,de)])])):r("",!0),e("div",ae,[u(_).includes("update vends")?(d(),f($,{key:0,modelValue:o.value.begin_date,"onUpdate:modelValue":s[0]||(s[0]=a=>o.value.begin_date=a),error:o.value.errors.begin_date,onInput:s[1]||(s[1]=a=>i.onDateFromChanged())},{default:m(()=>[x(" Begin Date ")]),_:1},8,["modelValue","error"])):r("",!0)]),e("div",re,[u(_).includes("update vends")?(d(),f($,{key:0,modelValue:o.value.termination_date,"onUpdate:modelValue":s[2]||(s[2]=a=>o.value.termination_date=a),error:o.value.errors.termination_date,minDate:o.value.begin_date},{default:m(()=>[x(" Retired Date ")]),_:1},8,["modelValue","error","minDate"])):r("",!0)]),e("div",le,[ce,c(D,{modelValue:o.value.is_testing,"onUpdate:modelValue":s[3]||(s[3]=a=>o.value.is_testing=a),options:b.value,trackBy:"id",valueProp:"id",label:"value",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),o.value.errors["customer.is_testing"]?(d(),l("div",ue,p(o.value.errors["customer.is_testing"]),1)):r("",!0)]),e("div",me,[e("span",ve,[u(_).includes("update vends")?(d(),f(h,{key:0,type:"button",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1",onClick:s[4]||(s[4]=g(a=>N(o.value.id),["prevent"]))},{default:m(()=>[c(u(z),{class:"w-4 h-4"}),_e]),_:1})):r("",!0),c(h,{class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:s[5]||(s[5]=g(a=>E(t.vend.id),["prevent"]))},{default:m(()=>[c(u(K),{class:"w-4 h-4"}),pe]),_:1})])])]),ge,e("div",fe,[e("div",xe,[o.value.customer.person_id?(d(),l("div",he,ye)):r("",!0),!o.value.customer||!o.value.customer.id?(d(),l("div",we,Ce)):r("",!0)]),o.value.customer.id?r("",!0):(d(),l("fieldset",Ve,[Se,e("div",Oe,[e("div",je,[e("div",$e,[J(e("input",{id:"isExisting","aria-describedby":"is-existing-description",name:"isExisting",type:"radio","onUpdate:modelValue":s[6]||(s[6]=a=>y.value=a),value:"1",class:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-600"},null,512),[[P,y.value]])]),De])])])),!t.vend.customer&&y.value==1?(d(),l("div",Ee,[e("div",Ne,[Me,c(D,{modelValue:o.value.customer_id,"onUpdate:modelValue":s[7]||(s[7]=a=>o.value.customer_id=a),options:k.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"])])])):r("",!0),t.vend.customer&&t.vend.customer.person_id?(d(),l("div",Be,[Fe,e("div",Ue,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:"#"+(t.vend.customer.id+1e4)+" - "+t.vend.customer_code+" - "+t.vend.customer_name,disabled:""},null,8,Ie)])])):r("",!0),t.vend.customer&&!t.vend.customer.person_id?(d(),l("div",Je,[Pe,e("div",Re,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:"#"+(t.vend.customer.id+1e4)+" - "+(t.vend.customer.code?t.vend.customer.code:"")+" - "+t.vend.customer_name,disabled:""},null,8,Ae)])])):r("",!0),t.vend.customer&&t.vend.customer.person_id?(d(),l("div",He,[x(" ** Customer Data only editable from CMS "),e("span",null,[e("a",{class:"text-blue-700",target:"_blank",href:"//admin.happyice.com.sg/person/"+t.vend.customer.person_id+"/edit"}," (Click Here) ",8,Le)])])):r("",!0),t.vend.customer&&!t.vend.customer.person_id?(d(),l("div",Te,[x(" ** Edit customer data "),e("span",null,[e("a",{class:"text-blue-700",target:"_blank",href:"/customers/"+t.vend.customer.id+"/edit"}," (Click Here) ",8,ze)])])):r("",!0)]),e("div",Ke,[e("span",Qe,[e("span",Ye,[c(u(R),{href:"/vends"},{default:m(()=>[c(h,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1"},{default:m(()=>[c(u(Q),{class:"w-4 h-4"}),Ze]),_:1})]),_:1})]),t.vend&&t.vend.customer&&u(_).includes("update vends")?(d(),f(h,{key:0,type:"button",class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:s[8]||(s[8]=g(a=>B(o.value.id),["prevent"]))},{default:m(()=>[c(u(Y),{class:"w-4 h-4"}),qe]),_:1})):r("",!0)])]),e("div",Ge,[We,e("div",Xe,[e("div",et,[e("div",tt,[e("div",st,[e("table",ot,[nt,e("tbody",it,[(d(!0),l(j,null,A(t.vend.logs,(a,O)=>(d(),l("tr",{key:a.id,class:H(O%2===0?void 0:"bg-gray-50")},[e("td",dt,p(O+1),1),e("td",at,p(a.created_at),1),e("td",rt,[e("div",lt,[c(u(Z),{class:"h-5 w-5 flex-shrink-0 text-gray-400","aria-hidden":"true"}),e("a",{href:a.full_url,target:"_blank",class:"font-medium text-indigo-600 hover:text-indigo-500"},"Download",8,ct)])])],2))),128)),!t.vend.logs||!t.vend.logs.length?(d(),l("tr",ut,vt)):r("",!0)])])])])])])])],32)])])])])]),_:1})],64))}};export{$t as default};
