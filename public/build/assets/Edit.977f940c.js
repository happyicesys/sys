import{g as v,T as w,Q as U,h as J,f as a,a as c,u,w as m,F as j,o as d,Z as P,b as e,t as h,e as g,l,c as p,d as b,m as R,S as A,i as H,k as L,n as T,O as z}from"./app.23f69410.js";import{_ as K}from"./Authenticated.c333a0a9.js";import{_ as f}from"./Button.e02061ca.js";import{_ as $}from"./DatePicker.c363f5ff.js";import{_ as E}from"./MultiSelect.0de761bc.js";import{r as D}from"./CheckCircleIcon.b60b0ec7.js";import{r as Q}from"./ArrowPathIcon.81a1df20.js";import{r as Y}from"./ArrowUturnLeftIcon.12a5659c.js";import{r as Z}from"./XCircleIcon.311d6b8e.js";import{r as q}from"./PaperClipIcon.36098c01.js";import"./keyboard.0c05cab2.js";import"./use-resolve-button-type.8f594bcf.js";import"./RectangleStackIcon.86791b6c.js";import"./main.1b1d7bb9.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.b143ea91.js";const G={class:"font-semibold text-xl text-gray-800 leading-tight"},W={class:"m-2 sm:mx-5 sm:my-3 px-1 sm:px-2 lg:px-3"},X={class:"mt-6 flex flex-col"},ee={class:"-my-2 -mx-4 sm:-mx-6 lg:-mx-8"},te={class:"shadow-sm ring-1 ring-black ring-opacity-5 p-5 mb-3"},se={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},oe=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Vending Machine ")])])],-1),ne={key:0,class:"sm:col-span-5"},ie=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vend ID# ",-1),de={class:"mt-1"},re=["value"],le={class:"sm:col-span-2"},ae={class:"sm:col-span-2"},ce={class:"sm:col-span-5"},ue=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Is Factory? ",-1),me={key:0,class:"text-sm text-red-600"},ve={class:"sm:col-span-6"},_e={class:"flex space-x-1"},ge=e("span",null," Save Vending Machine ",-1),pe=e("span",null," Restart ",-1),fe=e("div",{class:"relative mb-5"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-2 bg-white text-lg font-medium text-gray-900 rounded"}," Customer ")])],-1),xe={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},he={class:"sm:col-span-6"},be={key:0,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-green-300"},ye=e("div",{class:"flex flex-col"}," From CMS ",-1),we=[ye],ke={key:1,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-gray-300"},Ce=e("div",{class:"flex flex-col"}," No Customer Binding ",-1),Se=[Ce],Ve={key:0,class:"sm:col-span-6"},Oe=e("legend",{class:"sr-only"},"Plan",-1),je={class:"space-y-5"},$e={class:"relative flex items-start"},Ee={class:"flex h-6 items-center"},De=e("div",{class:"ml-3 text-sm leading-6"},[e("label",{for:"is_existing",class:"font-medium text-gray-900"},"Select Existing Customer")],-1),Ne={key:1,class:"sm:col-span-6"},Me={class:"sm:col-span-6"},Be=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),Fe={key:2,class:"sm:col-span-6"},Ie=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),Ue={class:"mt-1"},Je=["value"],Pe={key:3,class:"sm:col-span-6"},Re=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),Ae={class:"mt-1"},He=["value"],Le={key:4,class:"sm:col-span-6 text-blue-600 text-xs"},Te=["href"],ze={key:5,class:"sm:col-span-6 text-blue-600 text-xs"},Ke=["href"],Qe={class:"sm:col-span-6 pt-3"},Ye={class:"flex justify-between"},Ze={class:"flex space-x-1"},qe=e("span",null," Save Customer ",-1),Ge=e("span",null," Back ",-1),We=e("span",null," Unbind VM & Customer ",-1),Xe={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},et=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," APK Logs ")])])],-1),tt={class:"sm:col-span-6 flex flex-col mt-3"},st={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},ot={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},nt={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},it={class:"min-w-full divide-y divide-gray-300"},dt=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," # "),e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Created At "),e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," File ")])],-1),rt={class:"bg-white"},lt={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},at={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},ct={class:"whitespace-nowrap py-4 text-sm text-center"},ut={class:"flex w-0 space-x-2 items-center"},mt=["href"],vt={key:0},_t=e("td",{colspan:"3",class:"whitespace-nowrap py-4 text-sm font-medium text-black text-center"}," No records found ",-1),gt=[_t],Dt={__name:"Edit",props:{adminCustomerOptions:Object,countries:Object,operatorOptions:Object,vend:Object,type:String},setup(s){const n=s,i=v(w(V())),k=v([]),y=v([{id:"true",value:"Yes"},{id:"false",value:"No"}]),C=v([]),x=v(1),S=v([]),_=U().props.auth.permissions;function V(){return{id:"",begin_date:"",code:"",customer_id:"",customer:{operator_id:"",begin_date:"",termination_date:"",id:"",code:"",name:"",address:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""},contact:{name:"",email:"",phone_country_id:"",phone_num:""}},termination_date:"",is_testing:""}}J(()=>{C.value=n.countries.data,S.value=n.operatorOptions.data,i.value=n.vend?w({...n.vend,is_testing:n.vend.is_testing==1?y.value.find(o=>o.id==="true"):y.value.find(o=>o.id==="false"),customer:{...JSON.parse(JSON.stringify(n.vend.customer)),code:n.vend.customer&&n.vend.customer.person_id?n.vend.customer.virtual_customer_code+" ("+n.vend.customer.virtual_customer_prefix+")":n.vend.customer?n.vend.customer.code:null,operator_id:n.vend.customer&&n.vend.customer.operator_id?S.value.find(o=>o.id===n.vend.customer.operator_id):null,contact:n.vend.customer?{...JSON.parse(JSON.stringify(n.vend.customer.contact))}:{name:"",email:"",phone_country_id:"",phone_num:""},address:n.vend.customer?{...n.vend.customer.delivery_address,country_id:n.vend&&n.vend.customer&&n.vend.customer.delivery_address?C.value.find(o=>o.id===n.vend.customer.delivery_address.country_id):null}:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""}}}):w(V()),k.value=n.adminCustomerOptions.data.map(o=>({id:o.id,full_name:o.person_id?o.virtual_customer_code+" ("+o.virtual_customer_prefix+") - "+o.name:o.code+" - "+o.name}))});function N(o){z.post("/vends/"+o+"/restart",{},{preserveScroll:!0,preserveState:!0,replace:!0,onSuccess:()=>{emit("modalClose")}})}function M(o){i.value.clearErrors(),i.value.transform(t=>({...t,customer:{...t.customer,begin_date:t.customer.begin_date&&t.customer.begin_date!="Invalid date"?t.customer.begin_date:null,termination_date:t.customer.termination_date&&t.customer.termination_date!="Invalid date"?t.customer.termination_date:null,operator_id:t.customer.operator_id?t.customer.operator_id.id:null,contact:{...t.customer.contact,phone_country_id:t.customer.contact.phone_country_id?t.customer.contact.phone_country_id.id:null},address:{...t.customer.address,country_id:t.customer.address.country_id?t.customer.address.country_id.id:null}},customer_id:t.customer_id?t.customer_id.id:null,is_existing:x.value})).post("/customers/"+o+"/update",{onSuccess:()=>{},preserveState:!0,replace:!0})}function B(o){i.value.clearErrors(),i.value.transform(t=>({...t,begin_date:t.begin_date&&t.begin_date!="Invalid date"?t.begin_date:null,termination_date:t.termination_date&&t.termination_date!="Invalid date"?t.termination_date:null,is_testing:t.is_testing.id})).post("/vends/"+o+"/update",{onSuccess:()=>{},preserveState:!0,replace:!0})}function F(){i.value.clearErrors(),i.value.post("/vends/"+i.value.id+"/update",{onSuccess:()=>{emit("modalClose")},preserveState:!0,replace:!0})}function I(o){i.value.post("/vends/"+o+"/unbind-customer/settings",{onSuccess:()=>{},preserveState:!0,replace:!0})}return(o,t)=>(d(),a(j,null,[c(u(P),{title:"VM Edit"}),c(K,null,{header:m(()=>[e("h2",G," Editing Vending Machine "+h(s.vend.code),1)]),default:m(()=>[e("div",W,[e("div",X,[e("div",ee,[e("div",te,[e("form",{onSubmit:g(F,["prevent"]),id:"submit"},[e("div",se,[oe,s.vend?(d(),a("div",ne,[ie,e("div",de,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:s.vend?s.vend.code:"",disabled:""},null,8,re)])])):l("",!0),e("div",le,[u(_).includes("update vends")?(d(),p($,{key:0,modelValue:i.value.begin_date,"onUpdate:modelValue":t[0]||(t[0]=r=>i.value.begin_date=r),error:i.value.errors.begin_date,onInput:t[1]||(t[1]=r=>o.onDateFromChanged())},{default:m(()=>[b(" Begin Date ")]),_:1},8,["modelValue","error"])):l("",!0)]),e("div",ae,[u(_).includes("update vends")?(d(),p($,{key:0,modelValue:i.value.termination_date,"onUpdate:modelValue":t[2]||(t[2]=r=>i.value.termination_date=r),error:i.value.errors.termination_date,minDate:i.value.begin_date},{default:m(()=>[b(" Retired Date ")]),_:1},8,["modelValue","error","minDate"])):l("",!0)]),e("div",ce,[ue,c(E,{modelValue:i.value.is_testing,"onUpdate:modelValue":t[3]||(t[3]=r=>i.value.is_testing=r),options:y.value,trackBy:"id",valueProp:"id",label:"value",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),i.value.errors["customer.is_testing"]?(d(),a("div",me,h(i.value.errors["customer.is_testing"]),1)):l("",!0)]),e("div",ve,[e("span",_e,[u(_).includes("update vends")?(d(),p(f,{key:0,type:"button",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1",onClick:t[4]||(t[4]=g(r=>B(s.vend.id),["prevent"]))},{default:m(()=>[c(u(D),{class:"w-4 h-4"}),ge]),_:1})):l("",!0),c(f,{class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:t[5]||(t[5]=g(r=>N(s.vend.id),["prevent"]))},{default:m(()=>[c(u(Q),{class:"w-4 h-4"}),pe]),_:1})])])]),e("div",null,[fe,e("div",xe,[e("div",he,[s.vend.customer.person_id?(d(),a("div",be,we)):l("",!0),!s.vend.customer||!s.vend.customer.id?(d(),a("div",ke,Se)):l("",!0)]),s.vend.customer.id?l("",!0):(d(),a("fieldset",Ve,[Oe,e("div",je,[e("div",$e,[e("div",Ee,[R(e("input",{id:"isExisting","aria-describedby":"is-existing-description",name:"isExisting",type:"radio","onUpdate:modelValue":t[6]||(t[6]=r=>x.value=r),value:"1",class:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-600"},null,512),[[A,x.value]])]),De])])])),!s.vend.customer.id&&x.value==1?(d(),a("div",Ne,[e("div",Me,[Be,c(E,{modelValue:i.value.customer_id,"onUpdate:modelValue":t[7]||(t[7]=r=>i.value.customer_id=r),options:k.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"])])])):l("",!0),s.vend.customer&&s.vend.customer.person_id?(d(),a("div",Fe,[Ie,e("div",Ue,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:"#"+(s.vend.customer.id+1e4)+" - "+s.vend.customer_code+" - "+s.vend.customer_name,disabled:""},null,8,Je)])])):l("",!0),s.vend.customer&&!s.vend.customer.person_id?(d(),a("div",Pe,[Re,e("div",Ae,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:"#"+(s.vend.customer.id+1e4)+" - "+(s.vend.customer.code?s.vend.customer.code:"")+" - "+s.vend.customer_name,disabled:""},null,8,He)])])):l("",!0),s.vend.customer&&s.vend.customer.person_id?(d(),a("div",Le,[b(" ** Customer Data only editable from CMS "),e("span",null,[e("a",{class:"text-blue-700",target:"_blank",href:"//admin.happyice.com.sg/person/"+s.vend.customer.person_id+"/edit"}," (Click Here) ",8,Te)])])):l("",!0),s.vend.customer&&!s.vend.customer.person_id?(d(),a("div",ze,[b(" ** Edit customer data "),e("span",null,[e("a",{class:"text-blue-700",target:"_blank",href:"/customers/"+s.vend.customer.id+"/edit"}," (Click Here) ",8,Ke)])])):l("",!0),e("div",Qe,[e("span",Ye,[e("span",Ze,[u(_).includes("update vends")&&!s.vend.customer?(d(),p(f,{key:0,type:"button",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1",onClick:t[8]||(t[8]=g(r=>M(i.value.customer_id),["prevent"]))},{default:m(()=>[c(u(D),{class:"w-4 h-4"}),qe]),_:1})):l("",!0),c(u(H),{href:"/settings"},{default:m(()=>[c(f,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1"},{default:m(()=>[c(u(Y),{class:"w-4 h-4"}),Ge]),_:1})]),_:1})]),s.vend&&s.vend.customer&&u(_).includes("update vends")?(d(),p(f,{key:0,type:"button",class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:t[9]||(t[9]=g(r=>I(i.value.id),["prevent"]))},{default:m(()=>[c(u(Z),{class:"w-4 h-4"}),We]),_:1})):l("",!0)])])])]),e("div",Xe,[et,e("div",tt,[e("div",st,[e("div",ot,[e("div",nt,[e("table",it,[dt,e("tbody",rt,[(d(!0),a(j,null,L(s.vend.logs,(r,O)=>(d(),a("tr",{key:r.id,class:T(O%2===0?void 0:"bg-gray-50")},[e("td",lt,h(O+1),1),e("td",at,h(r.created_at),1),e("td",ct,[e("div",ut,[c(u(q),{class:"h-5 w-5 flex-shrink-0 text-gray-400","aria-hidden":"true"}),e("a",{href:r.full_url,target:"_blank",class:"font-medium text-indigo-600 hover:text-indigo-500"},"Download",8,mt)])])],2))),128)),!s.vend.logs||!s.vend.logs.length?(d(),a("tr",vt,gt)):l("",!0)])])])])])])])],32)])])])])]),_:1})],64))}};export{Dt as default};
