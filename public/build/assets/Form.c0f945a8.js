import{o as s,g as a,d as t,i as m,u as b,l as F,j as z,c as f,a as n,w as c,p as i,T as Y,t as p,b as v,n as w,F as q,m as E,e as M,f as g,_ as L}from"./app.60900316.js";import{_ as h}from"./Button.8416fd87.js";import{_ as P}from"./DatePicker.6195aad0.js";import T from"./Uom.11755106.js";import{_ as k}from"./FormInput.d5fc89e1.js";import{_ as G}from"./FormTextarea.af5db9ec.js";import{_ as H}from"./MultiSelect.88abf703.js";import{_ as R}from"./Modal.e5368931.js";import{r as W}from"./RectangleStackIcon.5fd2f3be.js";import{r as I}from"./PlusCircleIcon.93115d8a.js";import{r as J}from"./ArrowUturnLeftIcon.3f37c62a.js";import{r as K}from"./CheckCircleIcon.0ff426f5.js";import{r as Q}from"./BackspaceIcon.484bbcad.js";import"./main.b03c98d0.js";import"./open-closed.ce7cb872.js";function X(l,_){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M2 4.75C2 3.784 2.784 3 3.75 3h4.836c.464 0 .909.184 1.237.513l1.414 1.414a.25.25 0 00.177.073h4.836c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0116.25 17H3.75A1.75 1.75 0 012 15.25V4.75zm10.25 7a.75.75 0 000-1.5h-4.5a.75.75 0 000 1.5h4.5z","clip-rule":"evenodd"})])}function Z(l,_){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M3.75 3A1.75 1.75 0 002 4.75v10.5c0 .966.784 1.75 1.75 1.75h12.5A1.75 1.75 0 0018 15.25v-8.5A1.75 1.75 0 0016.25 5h-4.836a.25.25 0 01-.177-.073L9.823 3.513A1.75 1.75 0 008.586 3H3.75zM10 8a.75.75 0 01.75.75v1.5h1.5a.75.75 0 010 1.5h-1.5v1.5a.75.75 0 01-1.5 0v-1.5h-1.5a.75.75 0 010-1.5h1.5v-1.5A.75.75 0 0110 8z","clip-rule":"evenodd"})])}const ee={class:"flex flex-col md:flex-row space-x-2"},te={key:0,class:"text-gray-600"},se={key:1},oe={key:2,class:"text-gray-600"},ae=["onSubmit"],re={class:"grid grid-cols-1 gap-y-3 gap-x-3 sm:grid-cols-6"},le={class:"sm:col-span-6 pb-3"},de={class:"mt-1 flex flex-col md:flex-row space-y-2 md:space-y-0 items-center"},ie={class:"h-28 w-28 overflow-hidden rounded-full bg-gray-100"},ne=["src"],ce=["value"],ue={key:0,class:"text-sm text-red-600"},me={class:"sm:col-span-2"},pe=g(" Code "),ve={class:"sm:col-span-4"},_e=g(" Name "),fe={class:"sm:col-span-6"},he=g(" Desc "),ge={class:"col-span-12 sm:col-span-6"},xe=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Operator ",-1),ye={key:0,class:"text-sm text-red-600"},be={key:0,class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},we=t("div",{class:"relative"},[t("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[t("div",{class:"w-full border-t border-gray-300"})]),t("div",{class:"relative flex justify-center"},[t("span",{class:"px-3 bg-white text-lg font-medium text-gray-900"}," Unit Cost")])],-1),ke=[we],Ce={key:1,class:"sm:col-span-3"},Ve=g(" Unit Cost "),$e={key:2,class:"sm:col-span-3"},Me=g(" Start Date "),Oe=t("span",{class:"text-[9px]"}," (Leave blank to start NOW) ",-1),Se={key:3,class:"sm:col-span-6 flex justify-start"},Ue=t("span",null," Add ",-1),Ne={key:4,class:"sm:col-span-6 flex flex-col mt-3"},je={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},Ae={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},Be={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},De={class:"min-w-full divide-y divide-gray-300"},Fe=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," # "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Unit Cost "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Start Date "),t("th")])],-1),ze={class:"bg-white"},Ye={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},qe={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},Ee={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},Le={class:"whitespace-nowrap py-4 text-sm text-center"},Pe={key:1,class:"inline-flex items-center rounded-md bg-indigo-50 px-1.5 py-0.5 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-700/10"},Te={key:0},Ge=t("td",{colspan:"4",class:"whitespace-nowrap py-4 text-sm font-medium text-black-600 text-center"}," No Results Found ",-1),He=[Ge],Re={class:"sm:col-span-6"},We={class:"flex space-x-1 mt-5 pt-5 justify-end"},Ie=t("span",null," Back ",-1),Je={key:0,class:"flex space-x-1 items-center"},Ke=t("span",null," Deactivate ",-1),Qe={key:1,class:"flex space-x-1 items-center"},Xe=t("span",null," Activate ",-1),Ze=t("span",null," Save ",-1),ft={__name:"Form",props:{categories:Object,categoryGroups:Object,product:Object,uoms:Object,type:String,showModal:Boolean,operatorOptions:Object,permissions:[Array,Object]},emits:["modalClose"],setup(l,{emit:_}){const u=l,O=m([]),S=m([]),y=m(!1),U=m([]),x=m([]),e=m(b(V())),C=m([]);F().props.value.auth.operatorRole,z(()=>{e.value=u.product?b(u.product):b(V()),O.value=u.categories.data.map(d=>({id:d.id,name:d.name})),S.value=u.categoryGroups.data.map(d=>({id:d.id,name:d.name})),U.value=u.uoms.data.map(d=>({id:d.id,name:d.name})),C.value=u.operatorOptions.slice(1),x.value=u.product?u.product.unitCosts:null});function V(){return{code:"",date_from:"",desc:"",name:"",thumbnail:"",is_inventory:1,is_commission:"",is_supermarket_fee:"",category_id:"",category_group_id:"",operator_id:"",unit_cost:"",date_from:""}}function N(){e.value.clearErrors(),u.type==="create"&&e.value.transform(d=>({...d,operator_id:d.operator_id.id})).post("/products/create",{onSuccess:()=>{_("modalClose")},preserveState:!0,replace:!0}),u.type==="update"&&e.value.transform(d=>({...d,operator_id:d.operator_id.id})).post("/products/"+e.value.id+"/update",{onSuccess:()=>{_("modalClose")},preserveState:!0,replace:!0})}function j(){e.value.post("/products/"+e.value.id+"/toggle-activate-deactivate",{onSuccess:()=>{_("modalClose")},preserveState:!0,replace:!0})}function A(){y.value=!1}function B(){x.value.unshift({cost:e.value.unit_cost,date_from:e.value.date_from?e.value.date_from:L().format("YYYY-MM-DD")})}function D(d){x.value.splice(x.value.indexOf(d),1)}return(d,r)=>(s(),f(Y,{to:"body"},[n(R,{open:l.showModal,onModalClose:r[9]||(r[9]=o=>d.$emit("modalClose"))},{header:c(()=>[t("div",ee,[l.product?(s(),a("span",te," Editing ")):i("",!0),u.product?(s(),a("span",se,p(l.product.name),1)):(s(),a("span",oe," Create New Product "))])]),default:c(()=>[t("form",{onSubmit:M(N,["prevent"]),id:"submit"},[t("div",re,[t("div",le,[t("div",de,[t("span",ie,[l.product&&l.product.thumbnail?(s(),a("img",{key:0,class:"h-28 w-28 rounded-full border",src:l.product.thumbnail.full_url,alt:""},null,8,ne)):i("",!0),n(v(W),{class:"h-28 w-28 text-gray-300"})]),l.permissions.includes("update products")?(s(),a("input",{key:0,type:"file",onInput:r[0]||(r[0]=o=>e.value.thumbnail=o.target.files[0]),class:"ml-5 rounded-md border border-gray-300 bg-white py-2 px-3 text-sm font-medium leading-4 text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},null,32)):i("",!0),e.value.progress?(s(),a("progress",{key:1,value:e.value.progress.percentage,max:"100"},p(e.value.progress.percentage)+"% ",9,ce)):i("",!0)]),e.value.errors.thumbnail?(s(),a("div",ue,p(e.value.errors.thumbnail),1)):i("",!0)]),t("div",me,[n(k,{modelValue:e.value.code,"onUpdate:modelValue":r[1]||(r[1]=o=>e.value.code=o),error:e.value.errors.code,disabled:!l.permissions.includes("update products"),required:"true"},{default:c(()=>[pe]),_:1},8,["modelValue","error","disabled"])]),t("div",ve,[n(k,{modelValue:e.value.name,"onUpdate:modelValue":r[2]||(r[2]=o=>e.value.name=o),error:e.value.errors.name,disabled:!l.permissions.includes("update products"),required:"true"},{default:c(()=>[_e]),_:1},8,["modelValue","error","disabled"])]),t("div",fe,[n(G,{modelValue:e.value.desc,"onUpdate:modelValue":r[3]||(r[3]=o=>e.value.desc=o),disabled:!l.permissions.includes("update products"),error:e.value.errors.desc},{default:c(()=>[he]),_:1},8,["modelValue","disabled","error"])]),t("div",ge,[xe,n(H,{modelValue:e.value.operator_id,"onUpdate:modelValue":r[4]||(r[4]=o=>e.value.operator_id=o),options:C.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"top",class:"mt-1"},null,8,["modelValue","options"]),e.value.errors.operator_id?(s(),a("div",ye,p(e.value.errors.operator_id),1)):i("",!0)]),e.value.id?(s(),a("div",be,ke)):i("",!0),e.value.id?(s(),a("div",Ce,[n(k,{modelValue:e.value.unit_cost,"onUpdate:modelValue":r[5]||(r[5]=o=>e.value.unit_cost=o),error:e.value.errors.unit_cost,required:"true"},{default:c(()=>[Ve]),_:1},8,["modelValue","error"])])):i("",!0),e.value.id?(s(),a("div",$e,[n(P,{modelValue:e.value.date_from,"onUpdate:modelValue":r[6]||(r[6]=o=>e.value.date_from=o)},{default:c(()=>[Me,Oe]),_:1},8,["modelValue"])])):i("",!0),e.value.id?(s(),a("div",Se,[n(h,{type:"button",onClick:r[7]||(r[7]=o=>B()),class:w(["bg-green-500 hover:bg-green-600 text-white",[!e.value.unit_cost||isNaN(e.value.unit_cost)?"opacity-50 cursor-not-allowed":""]]),disabled:!e.value.unit_cost||isNaN(e.value.unit_cost)},{default:c(()=>[n(v(I),{class:"w-4 h-4"}),Ue]),_:1},8,["class","disabled"])])):i("",!0),e.value.id?(s(),a("div",Ne,[t("div",je,[t("div",Ae,[t("div",Be,[t("table",De,[Fe,t("tbody",ze,[(s(!0),a(q,null,E(l.product.unitCosts,(o,$)=>(s(),a("tr",{key:o.id,class:w($%2===0?void 0:"bg-gray-50")},[t("td",Ye,p($+1),1),t("td",qe,p(o.cost),1),t("td",Ee,p(o.date_from),1),t("td",Le,[o.id?i("",!0):(s(),f(h,{key:0,class:"bg-red-400 hover:bg-red-500 text-white",onClick:et=>D(o)},{default:c(()=>[n(v(Q),{class:"w-4 h-4"})]),_:2},1032,["onClick"])),o.is_current?(s(),a("span",Pe," Current ")):i("",!0)])],2))),128)),l.product.unitCosts.length?i("",!0):(s(),a("tr",Te,He))])])])])])])):i("",!0)]),t("div",Re,[t("div",We,[n(h,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1",onClick:r[8]||(r[8]=M(o=>d.$emit("modalClose"),["prevent"])),form:"submit"},{default:c(()=>[n(v(J),{class:"w-4 h-4"}),Ie]),_:1}),e.value.id&&l.permissions.includes("update products")?(s(),f(h,{key:0,type:"button",onClick:j,class:w(["text-white",[e.value.is_active?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"]])},{default:c(()=>[t("div",null,[e.value.is_active?(s(),a("span",Je,[n(v(X),{class:"w-4 h-4"}),Ke])):(s(),a("span",Qe,[n(v(Z),{class:"w-4 h-4"}),Xe]))])]),_:1},8,["class"])):i("",!0),l.permissions.includes("update products")?(s(),f(h,{key:1,type:"submit",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1"},{default:c(()=>[n(v(K),{class:"w-4 h-4"}),Ze]),_:1})):i("",!0)])])],40,ae)]),_:1},8,["open"]),y.value?(s(),f(T,{key:0,product:l.product,uoms:l.uoms,showModal:y.value,onModalClose:A},null,8,["product","uoms","showModal"])):i("",!0)]))}};export{ft as default};
