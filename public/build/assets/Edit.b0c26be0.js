import{g as _,T as w,Q as U,h as A,f as r,a as c,u,w as m,F as N,o as d,Z as I,b as e,t as p,e as g,n as $,l,c as x,d as h,m as P,S as J,i as R,k as H,O as L}from"./app.8898d4aa.js";import{_ as T}from"./Authenticated.91c411f9.js";import{_ as b}from"./Button.fba1dbc6.js";import{_ as D}from"./DatePicker.3befee5f.js";import{_ as k}from"./MultiSelect.a357f5ed.js";import{r as z}from"./CheckCircleIcon.63aaa26f.js";import{r as K}from"./ArrowPathIcon.36da423f.js";import{r as Q}from"./ArrowUturnLeftIcon.716437d7.js";import{r as Y}from"./XCircleIcon.2e042461.js";import{r as Z}from"./PaperClipIcon.2d0e9d98.js";import"./keyboard.f049aad0.js";import"./use-resolve-button-type.aeca7380.js";import"./RectangleStackIcon.ef635f5d.js";import"./main.31cf9f45.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.449d6c17.js";const q={class:"font-semibold text-xl text-gray-800 leading-tight"},G={class:"m-2 sm:mx-5 sm:my-3 px-1 sm:px-2 lg:px-3"},W={class:"mt-6 flex flex-col"},X={class:"-my-2 -mx-4 sm:-mx-6 lg:-mx-8"},ee={class:"shadow-sm ring-1 ring-black ring-opacity-5 p-5 mb-3"},te={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},se=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Vending Machine ")])])],-1),oe={class:"sm:col-span-6"},ie={key:0},ne={key:1},de={key:0,class:"sm:col-span-5"},ae=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vend ID# ",-1),le={class:"mt-1"},re=["value"],ce={class:"sm:col-span-2"},ue={class:"sm:col-span-2"},me={class:"sm:col-span-3"},ve=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Is Factory? ",-1),_e={key:0,class:"text-sm text-red-600"},pe={class:"sm:col-span-3"},fe=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Is Active? (Vending Machine) ",-1),ge={key:0,class:"text-sm text-red-600"},xe={class:"sm:col-span-6"},he={class:"flex space-x-1"},be=e("span",null," Save Vending Machine ",-1),ye=e("span",null," Restart ",-1),we=e("div",{class:"relative mb-5"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-2 bg-white text-lg font-medium text-gray-900 rounded"}," Customer ")])],-1),ke={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},Ve={class:"sm:col-span-6"},Ce={key:0,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-green-300"},Se=e("div",{class:"flex flex-col"}," From CMS ",-1),Oe=[Se],je={key:1,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-gray-300"},Ne=e("div",{class:"flex flex-col"}," No Customer Binding ",-1),$e=[Ne],De={key:0,class:"sm:col-span-6"},Ee=e("legend",{class:"sr-only"},"Plan",-1),Me={class:"space-y-5"},Be={class:"relative flex items-start"},Fe={class:"flex h-6 items-center"},Ue=e("div",{class:"ml-3 text-sm leading-6"},[e("label",{for:"is_existing",class:"font-medium text-gray-900"},"Select Existing Customer")],-1),Ae={key:1,class:"sm:col-span-6"},Ie={class:"sm:col-span-6"},Pe=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),Je={key:2,class:"sm:col-span-6"},Re=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),He={class:"mt-1"},Le=["value"],Te={key:3,class:"sm:col-span-6"},ze=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),Ke={class:"mt-1"},Qe=["value"],Ye={key:4,class:"sm:col-span-6 text-blue-600 text-xs"},Ze=["href"],qe={key:5,class:"sm:col-span-6 text-blue-600 text-xs"},Ge=["href"],We={class:"sm:col-span-6 pb-3"},Xe={class:"flex justify-between"},et={class:"flex space-x-1"},tt=e("span",null," Back ",-1),st=e("span",null," Unbind VM & Customer ",-1),ot={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},it=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," APK Logs ")])])],-1),nt={class:"sm:col-span-6 flex flex-col mt-3"},dt={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},at={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},lt={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},rt={class:"min-w-full divide-y divide-gray-300"},ct=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," # "),e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Created At "),e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," File ")])],-1),ut={class:"bg-white"},mt={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},vt={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},_t={class:"whitespace-nowrap py-4 text-sm text-center"},pt={class:"flex w-0 space-x-2 items-center"},ft=["href"],gt={key:0},xt=e("td",{colspan:"3",class:"whitespace-nowrap py-4 text-sm font-medium text-black text-center"}," No records found ",-1),ht=[xt],Ft={__name:"Edit",props:{adminCustomerOptions:Object,countries:Object,operatorOptions:Object,vend:Object,type:String},setup(t){const n=t,s=_(w(O())),V=_([]),v=_([{id:"true",value:"Yes"},{id:"false",value:"No"}]),C=_([]),y=_(1),S=_([]),f=U().props.auth.permissions;function O(){return{id:"",begin_date:"",code:"",customer_id:"",customer:{operator_id:"",begin_date:"",termination_date:"",id:"",code:"",name:"",address:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""},contact:{name:"",email:"",phone_country_id:"",phone_num:""}},termination_date:"",is_testing:"",is_active:""}}A(()=>{C.value=n.countries.data,S.value=n.operatorOptions.data,s.value=n.vend?w({...n.vend,is_active:n.vend.is_active==1?v.value.find(i=>i.id==="true"):v.value.find(i=>i.id==="false"),is_testing:n.vend.is_testing==1?v.value.find(i=>i.id==="true"):v.value.find(i=>i.id==="false"),customer:{...JSON.parse(JSON.stringify(n.vend.customer)),code:n.vend.customer&&n.vend.customer.person_id?n.vend.customer.virtual_customer_code+" ("+n.vend.customer.virtual_customer_prefix+")":n.vend.customer?n.vend.customer.code:null,operator_id:n.vend.customer&&n.vend.customer.operator_id?S.value.find(i=>i.id===n.vend.customer.operator_id):null,contact:n.vend.customer?{...JSON.parse(JSON.stringify(n.vend.customer.contact))}:{name:"",email:"",phone_country_id:"",phone_num:""},address:n.vend.customer?{...n.vend.customer.delivery_address,country_id:n.vend&&n.vend.customer&&n.vend.customer.delivery_address?C.value.find(i=>i.id===n.vend.customer.delivery_address.country_id):null}:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""}}}):w(O()),V.value=n.adminCustomerOptions.data.map(i=>({id:i.id,full_name:i.person_id?i.virtual_customer_code+" ("+i.virtual_customer_prefix+") - "+i.name:i.code+" - "+i.name}))});function E(i){L.post("/vends/"+i+"/restart",{},{preserveScroll:!0,preserveState:!0,replace:!0,onSuccess:()=>{emit("modalClose")}})}function M(i){s.value.clearErrors(),s.value.transform(o=>({...o,begin_date:o.begin_date&&o.begin_date!="Invalid date"?o.begin_date:null,termination_date:o.termination_date&&o.termination_date!="Invalid date"?o.termination_date:null,is_active:o.is_active.id,is_testing:o.is_testing.id})).post("/vends/"+i+"/update",{onSuccess:()=>{},preserveState:!0,replace:!0})}function B(){s.value.clearErrors(),s.value.post("/vends/"+s.value.id+"/update",{onSuccess:()=>{emit("modalClose")},preserveState:!0,replace:!0})}function F(i){s.value.post("/vends/"+i+"/unbind-customer/vends",{onSuccess:()=>{},preserveState:!0,replace:!0})}return(i,o)=>(d(),r(N,null,[c(u(I),{title:"VM Edit"}),c(T,null,{header:m(()=>[e("h2",q," Editing Vending Machine "+p(t.vend.code),1)]),default:m(()=>[e("div",G,[e("div",W,[e("div",X,[e("div",ee,[e("form",{onSubmit:g(B,["prevent"]),id:"submit"},[e("div",te,[se,e("div",oe,[e("div",{class:$(["inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit",[t.vend.is_active?"bg-green-300":"bg-red-300"]])},[t.vend.is_active?(d(),r("span",ie," Active ")):l("",!0),t.vend.is_active?l("",!0):(d(),r("span",ne," Not Active "))],2)]),t.vend?(d(),r("div",de,[ae,e("div",le,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:t.vend?t.vend.code:"",disabled:""},null,8,re)])])):l("",!0),e("div",ce,[u(f).includes("update vends")?(d(),x(D,{key:0,modelValue:s.value.begin_date,"onUpdate:modelValue":o[0]||(o[0]=a=>s.value.begin_date=a),error:s.value.errors.begin_date,onInput:o[1]||(o[1]=a=>i.onDateFromChanged())},{default:m(()=>[h(" Begin Date ")]),_:1},8,["modelValue","error"])):l("",!0)]),e("div",ue,[u(f).includes("update vends")?(d(),x(D,{key:0,modelValue:s.value.termination_date,"onUpdate:modelValue":o[2]||(o[2]=a=>s.value.termination_date=a),error:s.value.errors.termination_date,minDate:s.value.begin_date},{default:m(()=>[h(" Retired Date ")]),_:1},8,["modelValue","error","minDate"])):l("",!0)]),e("div",me,[ve,c(k,{modelValue:s.value.is_testing,"onUpdate:modelValue":o[3]||(o[3]=a=>s.value.is_testing=a),options:v.value,trackBy:"id",valueProp:"id",label:"value",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),s.value.errors["customer.is_testing"]?(d(),r("div",_e,p(s.value.errors["customer.is_testing"]),1)):l("",!0)]),e("div",pe,[fe,c(k,{modelValue:s.value.is_active,"onUpdate:modelValue":o[4]||(o[4]=a=>s.value.is_active=a),options:v.value,trackBy:"id",valueProp:"id",label:"value",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),s.value.errors.is_active?(d(),r("div",ge,p(s.value.errors.is_active),1)):l("",!0)]),e("div",xe,[e("span",he,[u(f).includes("update vends")?(d(),x(b,{key:0,type:"button",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1",onClick:o[5]||(o[5]=g(a=>M(s.value.id),["prevent"]))},{default:m(()=>[c(u(z),{class:"w-4 h-4"}),be]),_:1})):l("",!0),c(b,{class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:o[6]||(o[6]=g(a=>E(t.vend.id),["prevent"]))},{default:m(()=>[c(u(K),{class:"w-4 h-4"}),ye]),_:1})])])]),we,e("div",ke,[e("div",Ve,[s.value.customer.person_id?(d(),r("div",Ce,Oe)):l("",!0),!s.value.customer||!s.value.customer.id?(d(),r("div",je,$e)):l("",!0)]),s.value.customer.id?l("",!0):(d(),r("fieldset",De,[Ee,e("div",Me,[e("div",Be,[e("div",Fe,[P(e("input",{id:"isExisting","aria-describedby":"is-existing-description",name:"isExisting",type:"radio","onUpdate:modelValue":o[7]||(o[7]=a=>y.value=a),value:"1",class:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-600"},null,512),[[J,y.value]])]),Ue])])])),!t.vend.customer&&y.value==1?(d(),r("div",Ae,[e("div",Ie,[Pe,c(k,{modelValue:s.value.customer_id,"onUpdate:modelValue":o[8]||(o[8]=a=>s.value.customer_id=a),options:V.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"])])])):l("",!0),t.vend.customer&&t.vend.customer.person_id?(d(),r("div",Je,[Re,e("div",He,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:"#"+(t.vend.customer.id+1e4)+" - "+t.vend.customer_code+" - "+t.vend.customer_name,disabled:""},null,8,Le)])])):l("",!0),t.vend.customer&&!t.vend.customer.person_id?(d(),r("div",Te,[ze,e("div",Ke,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:"#"+(t.vend.customer.id+1e4)+" - "+(t.vend.customer.code?t.vend.customer.code:"")+" - "+t.vend.customer_name,disabled:""},null,8,Qe)])])):l("",!0),t.vend.customer&&t.vend.customer.person_id?(d(),r("div",Ye,[h(" ** Customer Data only editable from CMS "),e("span",null,[e("a",{class:"text-blue-700",target:"_blank",href:"//admin.happyice.com.sg/person/"+t.vend.customer.person_id+"/edit"}," (Click Here) ",8,Ze)])])):l("",!0),t.vend.customer&&!t.vend.customer.person_id?(d(),r("div",qe,[h(" ** Edit customer data "),e("span",null,[e("a",{class:"text-blue-700",target:"_blank",href:"/customers/"+t.vend.customer.id+"/edit"}," (Click Here) ",8,Ge)])])):l("",!0)]),e("div",We,[e("span",Xe,[e("span",et,[c(u(R),{href:"/vends"},{default:m(()=>[c(b,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1"},{default:m(()=>[c(u(Q),{class:"w-4 h-4"}),tt]),_:1})]),_:1})]),t.vend&&t.vend.customer&&u(f).includes("update vends")?(d(),x(b,{key:0,type:"button",class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:o[9]||(o[9]=g(a=>F(s.value.id),["prevent"]))},{default:m(()=>[c(u(Y),{class:"w-4 h-4"}),st]),_:1})):l("",!0)])]),e("div",ot,[it,e("div",nt,[e("div",dt,[e("div",at,[e("div",lt,[e("table",rt,[ct,e("tbody",ut,[(d(!0),r(N,null,H(t.vend.logs,(a,j)=>(d(),r("tr",{key:a.id,class:$(j%2===0?void 0:"bg-gray-50")},[e("td",mt,p(j+1),1),e("td",vt,p(a.created_at),1),e("td",_t,[e("div",pt,[c(u(Z),{class:"h-5 w-5 flex-shrink-0 text-gray-400","aria-hidden":"true"}),e("a",{href:a.full_url,target:"_blank",class:"font-medium text-indigo-600 hover:text-indigo-500"},"Download",8,ft)])])],2))),128)),!t.vend.logs||!t.vend.logs.length?(d(),r("tr",gt,ht)):l("",!0)])])])])])])])],32)])])])])]),_:1})],64))}};export{Ft as default};
