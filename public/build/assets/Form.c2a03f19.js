import{i as _,u as V,j as E,o,c as O,a as n,w as c,T as R,d as t,g as l,p as r,t as m,n as f,b as v,f as p,F as A,m as G,e as q}from"./app.36e1754b.js";import{_ as g}from"./Button.ff469b1e.js";import{_ as h}from"./FormInput.93371870.js";import{_ as J}from"./FormTextarea.1f49b46f.js";import{_ as K}from"./Modal.b527d4cb.js";import{_ as b}from"./MultiSelect.2410e0b9.js";import{r as C}from"./PlusCircleIcon.1b7af532.js";import{r as L}from"./ArrowUturnLeftIcon.f04500ae.js";import{r as Q}from"./CheckCircleIcon.e9252ac9.js";import{r as N}from"./BackspaceIcon.74542f9d.js";import"./open-closed.62caa5ef.js";const H={class:"flex flex-col md:flex-row space-x-2"},W={key:0,class:"text-gray-600"},X={key:1},Y={key:2,class:"text-gray-600"},Z=["onSubmit"],I={class:"grid grid-cols-1 gap-y-3 gap-x-3 sm:grid-cols-6"},ee={class:"sm:col-span-2"},te=p(" Code "),ae={class:"sm:col-span-4"},se=p(" Name "),oe={class:"sm:col-span-6"},le=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Country ",-1),ne={key:0,class:"text-sm text-red-600"},re={class:"sm:col-span-6"},de=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Timezone ",-1),ie={key:0,class:"text-sm text-red-600"},me={class:"sm:col-span-6"},ce=p(" Remarks "),ue={key:0,class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},pe=t("div",{class:"relative"},[t("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[t("div",{class:"w-full border-t border-gray-300"})]),t("div",{class:"relative flex justify-center"},[t("span",{class:"px-3 bg-white text-lg font-medium text-gray-900"}," QR Payment Gateway(s) ")])],-1),ye=[pe],_e=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Payment Gateway ",-1),ve={key:0,class:"text-sm text-red-600"},ge={key:2,class:"sm:col-span-1"},xe=t("span",null," Add ",-1),fe={key:3,class:"sm:col-span-3"},we={key:4,class:"sm:col-span-3"},he={key:5,class:"sm:col-span-3"},be={key:6,class:"sm:col-span-3"},ke=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"},[p(" Type "),t("span",{class:"text-red-500"},"*")],-1),Ve={key:0,class:"text-sm text-red-600"},Oe={key:7,class:"sm:col-span-6 flex justify-end"},Ce=t("span",null," Add ",-1),je={key:8,class:"sm:col-span-6 flex flex-col mt-3"},Be={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},$e={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},Pe={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},Se={class:"min-w-full divide-y divide-gray-300"},ze=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," # "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Name "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Type "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Private Key "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Action ")])],-1),Ae={class:"bg-white"},Ge={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},Ne={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},Ue={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},Te={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},Me={class:"whitespace-nowrap py-4 text-sm text-center"},Fe={key:0},De=t("td",{colspan:"5",class:"whitespace-nowrap py-4 text-sm font-medium text-center"}," No Result Found ",-1),Ee=[De],Re={key:9,class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},qe=t("div",{class:"relative"},[t("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[t("div",{class:"w-full border-t border-gray-300"})]),t("div",{class:"relative flex justify-center"},[t("span",{class:"px-3 bg-white text-lg font-medium text-gray-900"}," Access Vending Machine(s) ")])],-1),Je=[qe],Ke={key:10,class:"sm:col-span-5"},Le=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vending Machine to Bind ",-1),Qe={key:0,class:"text-sm text-red-600"},He={key:11,class:"sm:col-span-1"},We=t("span",null," Add ",-1),Xe={key:12,class:"sm:col-span-6 flex flex-col mt-3"},Ye={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},Ze={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},Ie={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},et={class:"min-w-full divide-y divide-gray-300"},tt=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," # "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Vend ID "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Name "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Action ")])],-1),at={class:"bg-white"},st={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},ot={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},lt={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},nt={key:0},rt=t("br",null,null,-1),dt={key:1},it={class:"whitespace-nowrap py-4 text-sm text-center"},mt={key:0},ct=t("td",{colspan:"4",class:"whitespace-nowrap py-4 text-sm font-medium text-red-600 text-center"}," No Binding = Access to All ",-1),ut=[ct],pt={class:"sm:col-span-6"},yt={class:"flex space-x-1 mt-5 justify-end"},_t=t("span",null," Back ",-1),vt=t("span",null," Save ",-1),Bt={__name:"Form",props:{countries:[Array,Object],operator:Object,timezones:[Array,Object],type:String,showModal:Boolean,countryPaymentGateways:[Array,Object],operatorPaymentGatewayTypes:[Array,Object],unbindedVends:[Array,Object],permissions:[Array,Object]},emits:["modalClose"],setup(u,{emit:j}){const d=u,B=_([]),e=_(V(S())),$=_([]),k=_([]),x=_([]),P=_([]),y=_([]);E(()=>{k.value=d.countryPaymentGateways.data,B.value=d.countries.data,$.value=d.timezones.map((i,s)=>({id:s,name:i})),k.value=d.countryPaymentGateways.data,P.value=d.operatorPaymentGatewayTypes,y.value=d.unbindedVends.data,x.value=d.operator?d.operator.operatorPaymentGateways:null,e.value=d.operator?V(d.operator):V(S())});function S(){return{id:"",code:"",name:"",country_id:"",payment_gateway_id:"",payment_gateway_type:"",payment_gateway_key1:"",payment_gateway_key2:"",payment_gateway_key3:"",timezone:"",remarks:"",vend_id:""}}function U(){d.operator.vends.indexOf(e.value.vend_id)<0&&(d.operator.vends.push(e.value.vend_id),d.operator.vends.sort((i,s)=>i.code-s.code),y.value.splice(y.value.indexOf(e.value.vend_id),1),y.value.sort((i,s)=>i.code-s.code))}function T(i){d.operator.vends.splice(d.operator.vends.indexOf(i),1),y.value.push(i),y.value.sort((s,a)=>s.code-a.code)}function z(){x.value.indexOf(e.value.payment_gateway)<0&&x.value.push({id:e.value.payment_gateway_id,key1:e.value.payment_gateway_key1,key2:e.value.payment_gateway_key2,key3:e.value.payment_gateway_key3,type:e.value.payment_gateway_type.id,paymentGateway:JSON.parse(JSON.stringify(e.value.payment_gateway))})}function M(i){x.value.splice(x.value.indexOf(i),1)}function F(){e.value.clearErrors(),d.type==="create"&&e.value.transform(i=>({...i,timezone:i.timezone.name,country_id:i.country_id.id})).post("/operators/create",{onSuccess:()=>{j("modalClose")},preserveState:!0,replace:!0}),d.type==="update"&&e.value.transform(i=>({...i,timezone:i.timezone.name,country_id:i.country_id.id,operator:d.operator,paymentGateways:x.value})).post("/operators/"+e.value.id+"/update",{onSuccess:()=>{j("modalClose")},preserveState:!0,replace:!0})}return(i,s)=>(o(),O(R,{to:"body"},[n(K,{open:u.showModal,onModalClose:s[15]||(s[15]=a=>i.$emit("modalClose"))},{header:c(()=>[t("div",H,[d.operator?(o(),l("span",W," Editing ")):r("",!0),d.operator?(o(),l("span",X,m(d.operator.name),1)):(o(),l("span",Y," Create New Operator "))])]),default:c(()=>[t("form",{onSubmit:q(F,["prevent"]),id:"submit"},[t("div",I,[t("div",ee,[n(h,{modelValue:e.value.code,"onUpdate:modelValue":s[0]||(s[0]=a=>e.value.code=a),error:e.value.errors.code},{default:c(()=>[te]),_:1},8,["modelValue","error"])]),t("div",ae,[n(h,{modelValue:e.value.name,"onUpdate:modelValue":s[1]||(s[1]=a=>e.value.name=a),error:e.value.errors.name,required:"true"},{default:c(()=>[se]),_:1},8,["modelValue","error"])]),t("div",oe,[le,n(b,{modelValue:e.value.country_id,"onUpdate:modelValue":s[2]||(s[2]=a=>e.value.country_id=a),options:B.value,trackBy:"id",valueProp:"id",label:"name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),e.value.errors.country_id?(o(),l("div",ne,m(e.value.errors.country_id),1)):r("",!0)]),t("div",re,[de,n(b,{modelValue:e.value.timezone,"onUpdate:modelValue":s[3]||(s[3]=a=>e.value.timezone=a),options:$.value,trackBy:"id",valueProp:"id",label:"name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),e.value.errors.timezone?(o(),l("div",ie,m(e.value.errors.timezone),1)):r("",!0)]),t("div",me,[n(J,{modelValue:e.value.remarks,"onUpdate:modelValue":s[4]||(s[4]=a=>e.value.remarks=a),error:e.value.errors.remarks},{default:c(()=>[ce]),_:1},8,["modelValue","error"])]),e.value.id?(o(),l("div",ue,ye)):r("",!0),e.value.id?(o(),l("div",{key:1,class:f([e.value.payment_gateway?"sm:col-span-6":"sm:col-span-5"])},[_e,n(b,{modelValue:e.value.payment_gateway,"onUpdate:modelValue":s[5]||(s[5]=a=>e.value.payment_gateway=a),options:k.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1",ref:"multiselect"},null,8,["modelValue","options"]),e.value.errors.payment_gateway?(o(),l("div",ve,m(e.value.errors.payment_gateway),1)):r("",!0)],2)):r("",!0),e.value.id&&!e.value.payment_gateway?(o(),l("div",ge,[n(g,{type:"button",onClick:s[6]||(s[6]=a=>z()),class:f(["bg-green-500 hover:bg-green-600 text-white flex space-x-1 sm:mt-6",[!e.value.payment_gateway||!e.value.payment_gateway_type?"opacity-50 cursor-not-allowed":""]]),disabled:!e.value.payment_gateway||!e.value.payment_gateway_type},{default:c(()=>[n(v(C),{class:"w-4 h-4"}),xe]),_:1},8,["class","disabled"])])):r("",!0),e.value.id&&e.value.payment_gateway&&e.value.payment_gateway.key1_name?(o(),l("div",fe,[n(h,{modelValue:e.value.payment_gateway_key1,"onUpdate:modelValue":s[7]||(s[7]=a=>e.value.payment_gateway_key1=a),error:e.value.errors.payment_gateway_key1,required:"true"},{default:c(()=>[p(m(e.value.payment_gateway.key1_name),1)]),_:1},8,["modelValue","error"])])):r("",!0),e.value.id&&e.value.payment_gateway&&e.value.payment_gateway.key2_name?(o(),l("div",we,[n(h,{modelValue:e.value.payment_gateway_key2,"onUpdate:modelValue":s[8]||(s[8]=a=>e.value.payment_gateway_key2=a),error:e.value.errors.payment_gateway_key2},{default:c(()=>[p(m(e.value.payment_gateway.key2_name),1)]),_:1},8,["modelValue","error"])])):r("",!0),e.value.id&&e.value.payment_gateway&&e.value.payment_gateway.key3_name?(o(),l("div",he,[n(h,{modelValue:e.value.payment_gateway_key3,"onUpdate:modelValue":s[9]||(s[9]=a=>e.value.payment_gateway_key3=a),error:e.value.errors.payment_gateway_key3},{default:c(()=>[p(m(e.value.payment_gateway.key3_name),1)]),_:1},8,["modelValue","error"])])):r("",!0),e.value.id&&e.value.payment_gateway?(o(),l("div",be,[ke,n(b,{modelValue:e.value.payment_gateway_type,"onUpdate:modelValue":s[10]||(s[10]=a=>e.value.payment_gateway_type=a),options:P.value,trackBy:"id",valueProp:"id",label:"id",placeholder:"Select","open-direction":"bottom",class:"mt-1",ref:"multiselect"},null,8,["modelValue","options"]),e.value.errors.payment_gateway_type?(o(),l("div",Ve,m(e.value.errors.payment_gateway_type),1)):r("",!0)])):r("",!0),e.value.id&&e.value.payment_gateway?(o(),l("div",Oe,[n(g,{type:"button",onClick:s[11]||(s[11]=a=>z()),class:f(["bg-green-500 hover:bg-green-600 text-white",[!e.value.payment_gateway||!e.value.payment_gateway_type||!e.value.payment_gateway_key1?"opacity-50 cursor-not-allowed":""]]),disabled:!e.value.payment_gateway||!e.value.payment_gateway_type||!e.value.payment_gateway_key1||!u.permissions.includes("update operators")},{default:c(()=>[n(v(C),{class:"w-4 h-4"}),Ce]),_:1},8,["class","disabled"])])):r("",!0),e.value.id?(o(),l("div",je,[t("div",Be,[t("div",$e,[t("div",Pe,[t("table",Se,[ze,t("tbody",Ae,[(o(!0),l(A,null,G(u.operator.operatorPaymentGateways,(a,w)=>(o(),l("tr",{key:a.id,class:f(w%2===0?void 0:"bg-gray-50")},[t("td",Ge,m(w+1),1),t("td",Ne,m(a.paymentGateway.name),1),t("td",Ue,m(a.type),1),t("td",Te,m(a.key1),1),t("td",Me,[n(g,{class:"bg-red-400 hover:bg-red-500 text-white",onClick:D=>M(a)},{default:c(()=>[n(v(N),{class:"w-4 h-4"})]),_:2},1032,["onClick"])])],2))),128)),u.operator.operatorPaymentGateways.length?r("",!0):(o(),l("tr",Fe,Ee))])])])])])])):r("",!0),e.value.id?(o(),l("div",Re,Je)):r("",!0),e.value.id?(o(),l("div",Ke,[Le,n(b,{modelValue:e.value.vend_id,"onUpdate:modelValue":s[12]||(s[12]=a=>e.value.vend_id=a),options:y.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1",ref:"multiselect"},null,8,["modelValue","options"]),e.value.errors.vend_id?(o(),l("div",Qe,m(e.value.errors.vend_id),1)):r("",!0)])):r("",!0),e.value.id?(o(),l("div",He,[n(g,{type:"button",onClick:s[13]||(s[13]=a=>U()),class:f(["bg-green-500 hover:bg-green-600 text-white flex space-x-1 sm:mt-6",[e.value.vend_id?"":"opacity-50 cursor-not-allowed"]]),disabled:!e.value.vend_id&&!u.permissions.includes("update operators")},{default:c(()=>[n(v(C),{class:"w-4 h-4"}),We]),_:1},8,["class","disabled"])])):r("",!0),e.value.id?(o(),l("div",Xe,[t("div",Ye,[t("div",Ze,[t("div",Ie,[t("table",et,[tt,t("tbody",at,[(o(!0),l(A,null,G(u.operator.vends,(a,w)=>(o(),l("tr",{key:a.id,class:f(w%2===0?void 0:"bg-gray-50")},[t("td",st,m(w+1),1),t("td",ot,m(a.code),1),t("td",lt,[a.latestVendBinding&&a.latestVendBinding.customer?(o(),l("span",nt,[p(m(a.latestVendBinding.customer.code)+" ",1),rt,p(" "+m(a.latestVendBinding.customer.name),1)])):(o(),l("span",dt,m(a.name),1))]),t("td",it,[u.permissions.includes("update operators")?(o(),O(g,{key:0,class:"bg-red-400 hover:bg-red-500 text-white",onClick:D=>T(a)},{default:c(()=>[n(v(N),{class:"w-4 h-4"})]),_:2},1032,["onClick"])):r("",!0)])],2))),128)),u.operator.vends.length?r("",!0):(o(),l("tr",mt,ut))])])])])])])):r("",!0)]),t("div",pt,[t("div",yt,[n(g,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1",onClick:s[14]||(s[14]=a=>i.$emit("modalClose")),form:"submit"},{default:c(()=>[n(v(L),{class:"w-4 h-4"}),_t]),_:1}),u.permissions.includes("update operators")?(o(),O(g,{key:0,type:"submit",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1"},{default:c(()=>[n(v(Q),{class:"w-4 h-4"}),vt]),_:1})):r("",!0)])])],40,Z)]),_:1},8,["open"])]))}};export{Bt as default};
