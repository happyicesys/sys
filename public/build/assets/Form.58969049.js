import{i as _,u as V,j as D,o,c as C,a as n,w as c,T as E,d as t,g as l,p as r,t as m,n as f,b as v,f as p,F as G,m as z,e as q}from"./app.60900316.js";import{_ as g}from"./Button.8416fd87.js";import{_ as w}from"./FormInput.d5fc89e1.js";import{_ as J}from"./FormTextarea.af5db9ec.js";import{_ as K}from"./Modal.e5368931.js";import{_ as b}from"./MultiSelect.88abf703.js";import{r as O}from"./PlusCircleIcon.93115d8a.js";import{r as L}from"./ArrowUturnLeftIcon.3f37c62a.js";import{r as Q}from"./CheckCircleIcon.0ff426f5.js";import{r as N}from"./BackspaceIcon.484bbcad.js";import"./open-closed.ce7cb872.js";const H={class:"flex flex-col md:flex-row space-x-2"},W={key:0,class:"text-gray-600"},X={key:1},Y={key:2,class:"text-gray-600"},Z=["onSubmit"],I={class:"grid grid-cols-1 gap-y-3 gap-x-3 sm:grid-cols-6"},ee={class:"sm:col-span-2"},te=p(" Code "),ae={class:"sm:col-span-4"},se=p(" Name "),oe={class:"sm:col-span-3"},le=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Country ",-1),ne={key:0,class:"text-sm text-red-600"},re={class:"sm:col-span-3"},de=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Timezone ",-1),ie={key:0,class:"text-sm text-red-600"},me={class:"sm:col-span-4"},ce=p(" GST or VAT Rate (%) "),ue=t("span",{class:"text-[9px]"}," (For Gross Margin Calculation) ",-1),pe={class:"sm:col-span-6"},ye=p(" Remarks "),_e={key:0,class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},ve=t("div",{class:"relative"},[t("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[t("div",{class:"w-full border-t border-gray-300"})]),t("div",{class:"relative flex justify-center"},[t("span",{class:"px-3 bg-white text-lg font-medium text-gray-900"}," QR Payment Gateway(s) ")])],-1),ge=[ve],xe=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Payment Gateway ",-1),fe={key:0,class:"text-sm text-red-600"},we={key:2,class:"sm:col-span-1"},he=t("span",null," Add ",-1),be={key:3,class:"sm:col-span-3"},ke={key:4,class:"sm:col-span-3"},Ve={key:5,class:"sm:col-span-3"},Ce={key:6,class:"sm:col-span-3"},Oe=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"},[p(" Type "),t("span",{class:"text-red-500"},"*")],-1),je={key:0,class:"text-sm text-red-600"},Be={key:7,class:"sm:col-span-6 flex justify-end"},Se=t("span",null," Add ",-1),$e={key:8,class:"sm:col-span-6 flex flex-col mt-3"},Pe={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},Ae={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},Ge={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},ze={class:"min-w-full divide-y divide-gray-300"},Ne=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," # "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Name "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Type "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Private Key "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Action ")])],-1),Ue={class:"bg-white"},Te={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},Me={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},Fe={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},Re={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},De={class:"whitespace-nowrap py-4 text-sm text-center"},Ee={key:0},qe=t("td",{colspan:"5",class:"whitespace-nowrap py-4 text-sm font-medium text-center"}," No Result Found ",-1),Je=[qe],Ke={key:9,class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},Le=t("div",{class:"relative"},[t("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[t("div",{class:"w-full border-t border-gray-300"})]),t("div",{class:"relative flex justify-center"},[t("span",{class:"px-3 bg-white text-lg font-medium text-gray-900"}," Access Vending Machine(s) ")])],-1),Qe=[Le],He={key:10,class:"sm:col-span-5"},We=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vending Machine to Bind ",-1),Xe={key:0,class:"text-sm text-red-600"},Ye={key:11,class:"sm:col-span-1"},Ze=t("span",null," Add ",-1),Ie={key:12,class:"sm:col-span-6 flex flex-col mt-3"},et={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},tt={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},at={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},st={class:"min-w-full divide-y divide-gray-300"},ot=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," # "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Vend ID "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Name "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Action ")])],-1),lt={class:"bg-white"},nt={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},rt={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},dt={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},it={key:0},mt=t("br",null,null,-1),ct={key:1},ut={class:"whitespace-nowrap py-4 text-sm text-center"},pt={key:0},yt=t("td",{colspan:"4",class:"whitespace-nowrap py-4 text-sm font-medium text-red-600 text-center"}," No Binding = Access to All ",-1),_t=[yt],vt={class:"sm:col-span-6"},gt={class:"flex space-x-1 mt-5 justify-end"},xt=t("span",null," Back ",-1),ft=t("span",null," Save ",-1),Pt={__name:"Form",props:{countries:[Array,Object],operator:Object,timezones:[Array,Object],type:String,showModal:Boolean,countryPaymentGateways:[Array,Object],operatorPaymentGatewayTypes:[Array,Object],unbindedVends:[Array,Object],permissions:[Array,Object]},emits:["modalClose"],setup(u,{emit:j}){const d=u,B=_([]),e=_(V(P())),S=_([]),k=_([]),x=_([]),$=_([]),y=_([]);D(()=>{k.value=d.countryPaymentGateways.data,B.value=d.countries.data,S.value=d.timezones.map((i,s)=>({id:s,name:i})),k.value=d.countryPaymentGateways.data,$.value=d.operatorPaymentGatewayTypes,y.value=d.unbindedVends.data,x.value=d.operator?d.operator.operatorPaymentGateways:null,e.value=d.operator?V(d.operator):V(P())});function P(){return{id:"",code:"",name:"",gst_vat_rate:"",country_id:"",payment_gateway_id:"",payment_gateway_type:"",payment_gateway_key1:"",payment_gateway_key2:"",payment_gateway_key3:"",timezone:"",remarks:"",vend_id:""}}function U(){d.operator.vends.indexOf(e.value.vend_id)<0&&(d.operator.vends.push(e.value.vend_id),d.operator.vends.sort((i,s)=>i.code-s.code),y.value.splice(y.value.indexOf(e.value.vend_id),1),y.value.sort((i,s)=>i.code-s.code))}function T(i){d.operator.vends.splice(d.operator.vends.indexOf(i),1),y.value.push(i),y.value.sort((s,a)=>s.code-a.code)}function A(){x.value.indexOf(e.value.payment_gateway)<0&&x.value.push({id:e.value.payment_gateway_id,key1:e.value.payment_gateway_key1,key2:e.value.payment_gateway_key2,key3:e.value.payment_gateway_key3,type:e.value.payment_gateway_type.id,paymentGateway:JSON.parse(JSON.stringify(e.value.payment_gateway))})}function M(i){x.value.splice(x.value.indexOf(i),1)}function F(){e.value.clearErrors(),d.type==="create"&&e.value.transform(i=>({...i,timezone:i.timezone.name,country_id:i.country_id.id})).post("/operators/create",{onSuccess:()=>{j("modalClose")},preserveState:!0,replace:!0}),d.type==="update"&&e.value.transform(i=>({...i,timezone:i.timezone.name,country_id:i.country_id.id,operator:d.operator,paymentGateways:x.value})).post("/operators/"+e.value.id+"/update",{onSuccess:()=>{j("modalClose")},preserveState:!0,replace:!0})}return(i,s)=>(o(),C(E,{to:"body"},[n(K,{open:u.showModal,onModalClose:s[16]||(s[16]=a=>i.$emit("modalClose"))},{header:c(()=>[t("div",H,[d.operator?(o(),l("span",W," Editing ")):r("",!0),d.operator?(o(),l("span",X,m(d.operator.name),1)):(o(),l("span",Y," Create New Operator "))])]),default:c(()=>[t("form",{onSubmit:q(F,["prevent"]),id:"submit"},[t("div",I,[t("div",ee,[n(w,{modelValue:e.value.code,"onUpdate:modelValue":s[0]||(s[0]=a=>e.value.code=a),error:e.value.errors.code},{default:c(()=>[te]),_:1},8,["modelValue","error"])]),t("div",ae,[n(w,{modelValue:e.value.name,"onUpdate:modelValue":s[1]||(s[1]=a=>e.value.name=a),error:e.value.errors.name,required:"true"},{default:c(()=>[se]),_:1},8,["modelValue","error"])]),t("div",oe,[le,n(b,{modelValue:e.value.country_id,"onUpdate:modelValue":s[2]||(s[2]=a=>e.value.country_id=a),options:B.value,trackBy:"id",valueProp:"id",label:"name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),e.value.errors.country_id?(o(),l("div",ne,m(e.value.errors.country_id),1)):r("",!0)]),t("div",re,[de,n(b,{modelValue:e.value.timezone,"onUpdate:modelValue":s[3]||(s[3]=a=>e.value.timezone=a),options:S.value,trackBy:"id",valueProp:"id",label:"name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),e.value.errors.timezone?(o(),l("div",ie,m(e.value.errors.timezone),1)):r("",!0)]),t("div",me,[n(w,{modelValue:e.value.gst_vat_rate,"onUpdate:modelValue":s[4]||(s[4]=a=>e.value.gst_vat_rate=a),error:e.value.errors.gst_vat_rate},{default:c(()=>[ce,ue]),_:1},8,["modelValue","error"])]),t("div",pe,[n(J,{modelValue:e.value.remarks,"onUpdate:modelValue":s[5]||(s[5]=a=>e.value.remarks=a),error:e.value.errors.remarks},{default:c(()=>[ye]),_:1},8,["modelValue","error"])]),e.value.id?(o(),l("div",_e,ge)):r("",!0),e.value.id?(o(),l("div",{key:1,class:f([e.value.payment_gateway?"sm:col-span-6":"sm:col-span-5"])},[xe,n(b,{modelValue:e.value.payment_gateway,"onUpdate:modelValue":s[6]||(s[6]=a=>e.value.payment_gateway=a),options:k.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1",ref:"multiselect"},null,8,["modelValue","options"]),e.value.errors.payment_gateway?(o(),l("div",fe,m(e.value.errors.payment_gateway),1)):r("",!0)],2)):r("",!0),e.value.id&&!e.value.payment_gateway?(o(),l("div",we,[n(g,{type:"button",onClick:s[7]||(s[7]=a=>A()),class:f(["bg-green-500 hover:bg-green-600 text-white flex space-x-1 sm:mt-6",[!e.value.payment_gateway||!e.value.payment_gateway_type?"opacity-50 cursor-not-allowed":""]]),disabled:!e.value.payment_gateway||!e.value.payment_gateway_type},{default:c(()=>[n(v(O),{class:"w-4 h-4"}),he]),_:1},8,["class","disabled"])])):r("",!0),e.value.id&&e.value.payment_gateway&&e.value.payment_gateway.key1_name?(o(),l("div",be,[n(w,{modelValue:e.value.payment_gateway_key1,"onUpdate:modelValue":s[8]||(s[8]=a=>e.value.payment_gateway_key1=a),error:e.value.errors.payment_gateway_key1,required:"true"},{default:c(()=>[p(m(e.value.payment_gateway.key1_name),1)]),_:1},8,["modelValue","error"])])):r("",!0),e.value.id&&e.value.payment_gateway&&e.value.payment_gateway.key2_name?(o(),l("div",ke,[n(w,{modelValue:e.value.payment_gateway_key2,"onUpdate:modelValue":s[9]||(s[9]=a=>e.value.payment_gateway_key2=a),error:e.value.errors.payment_gateway_key2},{default:c(()=>[p(m(e.value.payment_gateway.key2_name),1)]),_:1},8,["modelValue","error"])])):r("",!0),e.value.id&&e.value.payment_gateway&&e.value.payment_gateway.key3_name?(o(),l("div",Ve,[n(w,{modelValue:e.value.payment_gateway_key3,"onUpdate:modelValue":s[10]||(s[10]=a=>e.value.payment_gateway_key3=a),error:e.value.errors.payment_gateway_key3},{default:c(()=>[p(m(e.value.payment_gateway.key3_name),1)]),_:1},8,["modelValue","error"])])):r("",!0),e.value.id&&e.value.payment_gateway?(o(),l("div",Ce,[Oe,n(b,{modelValue:e.value.payment_gateway_type,"onUpdate:modelValue":s[11]||(s[11]=a=>e.value.payment_gateway_type=a),options:$.value,trackBy:"id",valueProp:"id",label:"id",placeholder:"Select","open-direction":"bottom",class:"mt-1",ref:"multiselect"},null,8,["modelValue","options"]),e.value.errors.payment_gateway_type?(o(),l("div",je,m(e.value.errors.payment_gateway_type),1)):r("",!0)])):r("",!0),e.value.id&&e.value.payment_gateway?(o(),l("div",Be,[n(g,{type:"button",onClick:s[12]||(s[12]=a=>A()),class:f(["bg-green-500 hover:bg-green-600 text-white",[!e.value.payment_gateway||!e.value.payment_gateway_type||!e.value.payment_gateway_key1?"opacity-50 cursor-not-allowed":""]]),disabled:!e.value.payment_gateway||!e.value.payment_gateway_type||!e.value.payment_gateway_key1||!u.permissions.includes("update operators")},{default:c(()=>[n(v(O),{class:"w-4 h-4"}),Se]),_:1},8,["class","disabled"])])):r("",!0),e.value.id?(o(),l("div",$e,[t("div",Pe,[t("div",Ae,[t("div",Ge,[t("table",ze,[Ne,t("tbody",Ue,[(o(!0),l(G,null,z(u.operator.operatorPaymentGateways,(a,h)=>(o(),l("tr",{key:a.id,class:f(h%2===0?void 0:"bg-gray-50")},[t("td",Te,m(h+1),1),t("td",Me,m(a.paymentGateway.name),1),t("td",Fe,m(a.type),1),t("td",Re,m(a.key1),1),t("td",De,[n(g,{class:"bg-red-400 hover:bg-red-500 text-white",onClick:R=>M(a)},{default:c(()=>[n(v(N),{class:"w-4 h-4"})]),_:2},1032,["onClick"])])],2))),128)),u.operator.operatorPaymentGateways.length?r("",!0):(o(),l("tr",Ee,Je))])])])])])])):r("",!0),e.value.id?(o(),l("div",Ke,Qe)):r("",!0),e.value.id?(o(),l("div",He,[We,n(b,{modelValue:e.value.vend_id,"onUpdate:modelValue":s[13]||(s[13]=a=>e.value.vend_id=a),options:y.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1",ref:"multiselect"},null,8,["modelValue","options"]),e.value.errors.vend_id?(o(),l("div",Xe,m(e.value.errors.vend_id),1)):r("",!0)])):r("",!0),e.value.id?(o(),l("div",Ye,[n(g,{type:"button",onClick:s[14]||(s[14]=a=>U()),class:f(["bg-green-500 hover:bg-green-600 text-white flex space-x-1 sm:mt-6",[e.value.vend_id?"":"opacity-50 cursor-not-allowed"]]),disabled:!e.value.vend_id&&!u.permissions.includes("update operators")},{default:c(()=>[n(v(O),{class:"w-4 h-4"}),Ze]),_:1},8,["class","disabled"])])):r("",!0),e.value.id?(o(),l("div",Ie,[t("div",et,[t("div",tt,[t("div",at,[t("table",st,[ot,t("tbody",lt,[(o(!0),l(G,null,z(u.operator.vends,(a,h)=>(o(),l("tr",{key:a.id,class:f(h%2===0?void 0:"bg-gray-50")},[t("td",nt,m(h+1),1),t("td",rt,m(a.code),1),t("td",dt,[a.latestVendBinding&&a.latestVendBinding.customer?(o(),l("span",it,[p(m(a.latestVendBinding.customer.code)+" ",1),mt,p(" "+m(a.latestVendBinding.customer.name),1)])):(o(),l("span",ct,m(a.name),1))]),t("td",ut,[u.permissions.includes("update operators")?(o(),C(g,{key:0,class:"bg-red-400 hover:bg-red-500 text-white",onClick:R=>T(a)},{default:c(()=>[n(v(N),{class:"w-4 h-4"})]),_:2},1032,["onClick"])):r("",!0)])],2))),128)),u.operator.vends.length?r("",!0):(o(),l("tr",pt,_t))])])])])])])):r("",!0)]),t("div",vt,[t("div",gt,[n(g,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1",onClick:s[15]||(s[15]=a=>i.$emit("modalClose")),form:"submit"},{default:c(()=>[n(v(L),{class:"w-4 h-4"}),xt]),_:1}),u.permissions.includes("update operators")?(o(),C(g,{key:0,type:"submit",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1"},{default:c(()=>[n(v(Q),{class:"w-4 h-4"}),ft]),_:1})):r("",!0)])])],40,Z)]),_:1},8,["open"])]))}};export{Pt as default};
