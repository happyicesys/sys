import{g as p,T as k,Q as I,h as A,f as c,a as l,u as _,w as i,F as P,o as n,Z as L,b as e,e as g,n as N,l as u,d as m,c as x,t as w,i as M,O as T}from"./app.23f69410.js";import{_ as F}from"./Authenticated.c333a0a9.js";import{_ as y}from"./Button.e02061ca.js";import{_ as J}from"./DatePicker.c363f5ff.js";import{_ as v}from"./FormInput.f5a3658d.js";import{_ as h}from"./MultiSelect.0de761bc.js";import{_ as G}from"./SearchAddressInput.296cac40.js";import{r as q}from"./CheckCircleIcon.b60b0ec7.js";import{r as z}from"./ArrowUturnLeftIcon.12a5659c.js";import{r as U}from"./XCircleIcon.311d6b8e.js";import"./keyboard.0c05cab2.js";import"./use-resolve-button-type.8f594bcf.js";import"./RectangleStackIcon.86791b6c.js";import"./main.1b1d7bb9.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.b143ea91.js";import"./combobox.30efb808.js";import"./disposables.ac22ed1c.js";import"./MagnifyingGlassCircleIcon.e80ecbef.js";const H=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Editing Customer ",-1),K={class:"m-2 sm:mx-5 sm:my-3 px-1 sm:px-2 lg:px-3"},Q={class:"mt-6 flex flex-col"},R={class:"-my-2 -mx-4 sm:-mx-6 lg:-mx-8"},Y={class:"shadow-sm ring-1 ring-black ring-opacity-5 p-5 mb-3"},Z={class:"pb-5"},W=e("div",{class:"relative mb-5"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-2 bg-white text-lg font-medium text-gray-900 rounded"}," Customer ")])],-1),X={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},ee={class:"sm:col-span-6 flex space-x-1"},te={key:0},se={key:1},oe={key:0,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-green-300"},de=e("div",{class:"flex flex-col"}," From CMS ",-1),le=[de],re={key:1,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-gray-300"},ae=e("div",{class:"flex flex-col"}," No Customer Binding ",-1),ie=[ae],ne={key:0,class:"sm:col-span-1"},ue=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," ID ",-1),ce={class:"mt-1"},me=["value"],ve={key:1,class:"sm:col-span-5"},_e=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),pe={class:"mt-1"},fe=["value"],be={key:2,class:"sm:col-span-6 grid grid-cols-1 gap-3 sm:grid-cols-6"},ge={class:"sm:col-span-2"},xe={class:"sm:col-span-3"},ye={key:3,class:"sm:col-span-6 text-blue-600 text-xs"},he=["href"],Ve={class:"sm:col-span-2"},ke={key:0,class:"sm:col-span-6 grid grid-cols-1 gap-3 sm:grid-cols-6"},we=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-6 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-4 bg-white text-lg font-medium text-gray-900 rounded"}," Contact ")])])],-1),Ce={class:"sm:col-span-3"},Se={class:"sm:col-span-3"},Oe={class:"sm:col-span-2"},Ne=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Phone Code ",-1),Ue={key:0,class:"text-sm text-red-600"},je={class:"sm:col-span-4"},Be=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Address ")])])],-1),De={class:"sm:col-span-6"},$e={class:"sm:col-span-3"},Ee={class:"sm:col-span-3"},Ie={class:"sm:col-span-3"},Ae={class:"sm:col-span-3"},Pe={class:"sm:col-span-3"},Le=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Country ",-1),Me={key:0,class:"text-sm text-red-600"},Te={class:"sm:col-span-3 hidden"},Fe={class:"sm:col-span-3 hidden"},Je=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Operator ")])])],-1),Ge={class:"col-span-12 sm:col-span-6"},qe=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"},[m(" Operator "),e("span",{class:"text-red-500"}," * ")],-1),ze={key:0,class:"text-sm text-red-600"},He=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Vending Machine ")])])],-1),Ke={key:1,class:"sm:col-span-6 mb-3"},Qe=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vend ID# ",-1),Re={class:"mt-1"},Ye=["value"],Ze={key:2,class:"sm:col-span-6"},We=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vend ID# ",-1),Xe={class:"sm:col-span-6 mt-3"},et={class:"flex justify-between"},tt={class:"flex space-x-1"},st=e("span",null," Save Customer ",-1),ot=e("span",null," Back ",-1),dt=e("span",null," Unbind VM & Customer ",-1),lt=e("span",null," Delete Customer ",-1),wt={__name:"Edit",props:{vendOptions:Object,countries:Object,operatorOptions:Object,customer:Object,type:String},setup(o){const r=o,t=p(k(O()));p([]),p([{id:"true",value:"Yes"},{id:"false",value:"No"}]);const f=p([]),C=p(1),V=p([]),b=I().props.auth.permissions,S=p([]);function O(){return{id:"",customer_id:"",person_id:"",operator_id:"",begin_date:"",termination_date:"",code:"",name:"",address:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""},contact:{name:"",email:"",phone_country_id:"",phone_num:""},vend_id:""}}A(()=>{f.value=r.countries.data,V.value=r.operatorOptions.data,t.value=r.customer?k({...JSON.parse(JSON.stringify(r.customer)),code:r.customer&&r.customer.person_id?r.customer.virtual_customer_code+" ("+r.customer.virtual_customer_prefix+")":r.customer?r.customer.code:null,operator_id:r.customer&&r.customer.operator_id?V.value.find(a=>a.id===r.customer.operator_id):null,vend_id:"",person_id:r.customer?r.customer.person_id:null,contact:r.customer?{...JSON.parse(JSON.stringify(r.customer.contact))}:{name:"",email:"",phone_country_id:"",phone_num:""},address:r.customer?{...r.customer.delivery_address,country_id:r.customer&&r.customer.delivery_address?f.value.find(a=>a.id===r.customer.delivery_address.country_id):null}:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""}}):k(O()),S.value=r.vendOptions.map(a=>({id:a.id,full_name:a.code}))});function j(a){t.value.clearErrors(),t.value.delete("/customers/"+a,{onSuccess:()=>{T.push("/customers")},preserveState:!0,replace:!0})}function B(a){t.value.clearErrors(),t.value.transform(s=>({id:s.vend_id?s.vend_id.id:null,customer:{...s,begin_date:s.begin_date&&s.begin_date!="Invalid date"?s.begin_date:null,termination_date:s.termination_date&&s.termination_date!="Invalid date"?s.termination_date:null,operator_id:s.operator_id?s.operator_id.id:null,contact:{...s.contact,phone_country_id:s.contact.phone_country_id?s.contact.phone_country_id.id:null},address:{...s.address,country_id:s.address.country_id?s.address.country_id.id:null},vend_id:s.vend_id?s.vend_id.id:null}})).post("/customers/"+a+"/update",{onSuccess:()=>{},preserveState:!0,replace:!0})}function D(){t.value.clearErrors(),t.value.post("/customers/"+t.value.id+"/update",{onSuccess:()=>{emit("modalClose")},preserveState:!0,replace:!0})}function $(a){t.value.address={block_num:a.BLK_NO,building:a.BUILDING,country_id:f.value[0],latitude:a.LATITUDE,longitude:a.LONGTITUDE,postcode:a.POSTAL,street_name:a.ROAD_NAME,unit_num:""}}function E(a){t.value.post("/vends/"+a+"/unbind-customer",{onSuccess:()=>{},preserveState:!0,replace:!0})}return(a,s)=>(n(),c(P,null,[l(_(L),{title:"Customer"}),l(F,null,{header:i(()=>[H]),default:i(()=>[e("div",K,[e("div",Q,[e("div",R,[e("div",Y,[e("form",{onSubmit:g(D,["prevent"]),id:"submit"},[e("div",Z,[W,e("div",X,[e("div",ee,[e("div",{class:N(["inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit",[o.customer.is_active?"bg-green-300":"bg-red-300"]])},[o.customer.is_active?(n(),c("span",te," Active ")):u("",!0),o.customer.is_active?u("",!0):(n(),c("span",se," Not Active "))],2),o.customer.person_id?(n(),c("div",oe,le)):u("",!0),o.customer.vend?u("",!0):(n(),c("div",re,ie))]),o.customer.id?(n(),c("div",ne,[ue,e("div",ce,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:o.customer.id+1e4,disabled:""},null,8,me)])])):u("",!0),o.customer.id&&o.customer.person_id?(n(),c("div",ve,[_e,e("div",pe,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:o.customer.person_id?o.customer.virtual_customer_code+" ("+o.customer.virtual_customer_prefix+") - "+o.customer.name:o.customer.code+" - "+o.customer.name,disabled:""},null,8,fe)])])):u("",!0),o.customer.id&&!o.customer.person_id||!o.customer.id&&C.value!=1?(n(),c("div",be,[e("div",ge,[l(v,{modelValue:t.value.code,"onUpdate:modelValue":s[0]||(s[0]=d=>t.value.code=d),error:t.value.errors.code,disabled:t.value.person_id},{default:i(()=>[m(" Cust Code ")]),_:1},8,["modelValue","error","disabled"])]),e("div",xe,[l(v,{modelValue:t.value.name,"onUpdate:modelValue":s[1]||(s[1]=d=>t.value.name=d),error:t.value.errors.name,required:"true",disabled:t.value.person_id},{default:i(()=>[m(" Cust Name ")]),_:1},8,["modelValue","error","disabled"])])])):u("",!0),o.customer.person_id?(n(),c("div",ye,[m(" ** Customer Data only editable from CMS "),e("span",null,[e("a",{class:N([t.value.person_id?"text-blue-700":"text-gray-500"]),target:"_blank",href:"//admin.happyice.com.sg/person/"+t.value.person_id+"/edit"}," (Click Here) ",10,he)])])):u("",!0),e("div",Ve,[_(b).includes("update customers")?(n(),x(J,{key:0,modelValue:t.value.begin_date,"onUpdate:modelValue":s[2]||(s[2]=d=>t.value.begin_date=d),error:t.value.errors.begin_date,onInput:s[3]||(s[3]=d=>a.onDateFromChanged())},{default:i(()=>[m(" Begin Date ")]),_:1},8,["modelValue","error"])):u("",!0)])]),o.customer.id&&!o.customer.person_id||!o.customer.id&&C.value!=1?(n(),c("div",ke,[we,e("div",Ce,[l(v,{modelValue:t.value.contact.name,"onUpdate:modelValue":s[4]||(s[4]=d=>t.value.contact.name=d),error:t.value.errors["contact.name"],disabled:o.customer.person_id},{default:i(()=>[m(" Name ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Se,[l(v,{modelValue:t.value.contact.email,"onUpdate:modelValue":s[5]||(s[5]=d=>t.value.contact.email=d),error:t.value.errors["contact.email"],disabled:o.customer.person_id},{default:i(()=>[m(" Email ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Oe,[Ne,l(h,{modelValue:t.value.contact.phone_country_id,"onUpdate:modelValue":s[6]||(s[6]=d=>t.value.contact.phone_country_id=d),options:f.value,disabled:t.value.person_id,trackBy:"id",valueProp:"id",label:"phone_code",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options","disabled"]),t.value.errors["contact.phone_country_id"]?(n(),c("div",Ue,w(t.value.errors["contact.phone_country_id"]),1)):u("",!0)]),e("div",je,[l(v,{modelValue:t.value.contact.phone_num,"onUpdate:modelValue":s[7]||(s[7]=d=>t.value.contact.phone_num=d),error:t.value.errors["contact.phone_num"],disabled:o.customer.person_id},{default:i(()=>[m(" Phone Number ")]),_:1},8,["modelValue","error","disabled"])]),Be,e("div",De,[l(G,{modelValue:t.value.address.postcode,"onUpdate:modelValue":s[8]||(s[8]=d=>t.value.address.postcode=d),onSelected:$,error:t.value.errors["address.postcode"],disabled:o.customer.person_id},{default:i(()=>[m(" Postcode ")]),_:1},8,["modelValue","error","disabled"])]),e("div",$e,[l(v,{modelValue:t.value.address.unit_num,"onUpdate:modelValue":s[9]||(s[9]=d=>t.value.address.unit_num=d),error:t.value.errors["address.unit_num"]},{default:i(()=>[m(" Unit Num ")]),_:1},8,["modelValue","error"])]),e("div",Ee,[l(v,{modelValue:t.value.address.block_num,"onUpdate:modelValue":s[10]||(s[10]=d=>t.value.address.block_num=d),error:t.value.errors["address.block_num"],disabled:o.customer.person_id},{default:i(()=>[m(" Block Num ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Ie,[l(v,{modelValue:t.value.address.building,"onUpdate:modelValue":s[11]||(s[11]=d=>t.value.address.building=d),error:t.value.errors["address.building"],disabled:o.customer.person_id},{default:i(()=>[m(" Building Name ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Ae,[l(v,{modelValue:t.value.address.street_name,"onUpdate:modelValue":s[12]||(s[12]=d=>t.value.address.street_name=d),error:t.value.errors["address.street_name"],disabled:o.customer.person_id},{default:i(()=>[m(" Street Name ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Pe,[Le,l(h,{modelValue:t.value.address.country_id,"onUpdate:modelValue":s[13]||(s[13]=d=>t.value.address.country_id=d),options:f.value,trackBy:"id",valueProp:"id",label:"name",placeholder:"Select","open-direction":"bottom",class:"mt-1",disabled:o.customer.person_id},null,8,["modelValue","options","disabled"]),t.value.errors["address.country_id"]?(n(),c("div",Me,w(t.value.errors["address.country_id"]),1)):u("",!0)]),e("div",Te,[l(v,{modelValue:t.value.address.latitude,"onUpdate:modelValue":s[14]||(s[14]=d=>t.value.address.latitude=d)},{default:i(()=>[m(" Latitude ")]),_:1},8,["modelValue"])]),e("div",Fe,[l(v,{modelValue:t.value.address.longitude,"onUpdate:modelValue":s[15]||(s[15]=d=>t.value.address.longitude=d)},{default:i(()=>[m(" Longitude ")]),_:1},8,["modelValue"])])])):u("",!0),Je,e("div",Ge,[qe,l(h,{modelValue:t.value.operator_id,"onUpdate:modelValue":s[16]||(s[16]=d=>t.value.operator_id=d),options:V.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"top",class:"mt-1"},null,8,["modelValue","options"]),t.value.errors.operator_id?(n(),c("div",ze,w(t.value.errors.operator_id),1)):u("",!0)]),He,o.customer.vend?(n(),c("div",Ke,[Qe,e("div",Re,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:o.customer.vend?o.customer.vend.code:"",disabled:""},null,8,Ye)])])):u("",!0),o.customer.vend?u("",!0):(n(),c("div",Ze,[We,l(h,{modelValue:t.value.vend_id,"onUpdate:modelValue":s[17]||(s[17]=d=>t.value.vend_id=d),options:S.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"])])),e("div",Xe,[e("span",et,[e("span",tt,[_(b).includes("update customers")?(n(),x(y,{key:0,type:"button",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1",onClick:s[18]||(s[18]=g(d=>B(t.value.id),["prevent"]))},{default:i(()=>[l(_(q),{class:"w-4 h-4"}),st]),_:1})):u("",!0),l(_(M),{href:"/customers"},{default:i(()=>[l(y,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1"},{default:i(()=>[l(_(z),{class:"w-4 h-4"}),ot]),_:1})]),_:1})]),o.customer.vend&&_(b).includes("update customers")?(n(),x(y,{key:0,type:"button",class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:s[19]||(s[19]=g(d=>E(o.customer.vend.id),["prevent"]))},{default:i(()=>[l(_(U),{class:"w-4 h-4"}),dt]),_:1})):u("",!0),!o.customer.vend&&_(b).includes("update customers")?(n(),x(y,{key:1,type:"button",class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:s[20]||(s[20]=g(d=>j(o.customer.id),["prevent"]))},{default:i(()=>[l(_(U),{class:"w-4 h-4"}),lt]),_:1})):u("",!0)])])])],32)])])])])]),_:1})],64))}};export{wt as default};
