import{_ as b}from"./Button.d3f743fe.js";import{_ as B,r as S}from"./Modal.9d4f1d67.js";import{_ as j}from"./MultiSelect.9391f970.js";import{h as y,j as M,K as E,c as f,a as u,w as _,s as N,o as s,b as e,f as d,m as r,t as c,d as w,u as i,l as P,F as q,n as v,O as k}from"./app.d9ed6624.js";import{r as F}from"./PencilSquareIcon.203e2435.js";import"./open-closed.192a527e.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.c5b8fdd1.js";const A={class:"flex flex-col md:flex-row space-x-2"},I={key:0,class:"text-gray-600"},L={key:1},T={key:2},U={class:"flex flex-col"},Y={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},z={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},J={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},K={class:"table-fixed min-w-full divide-y divide-gray-300"},G={class:"bg-gray-50"},H=e("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," # ",-1),Q={key:0,scope:"col",class:"w-2/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},R=e("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Sold ",-1),W=e("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Bal ",-1),X=e("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Cap ",-1),Z={scope:"col",class:"w-2/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},ee={key:0},te=e("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Error ",-1),se={key:1,scope:"col",class:"w-3/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},oe=e("th",{scope:"col",class:"w-3/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Action ",-1),de={class:"bg-white"},ne={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},re={key:0,class:"whitespace-nowrap text-sm font-semibold text-gray-900 text-center"},ce={class:"flex justify-center items-center"},ae=["src"],le={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-blue-600 sm:pl-6 text-center"},ie={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},pe={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},ue={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},_e={class:"py-1 pl-1 pr-1 text-xs font-medium text-gray-900 sm:pl-1 text-center"},me={key:0},xe={class:"font-bold"},ye={key:1,class:"py-4 text-sm font-semibold text-gray-900 text-center"},fe={key:0},ve={key:0},ge={key:1,class:"break-normal text-xs"},he=e("br",null,null,-1),be={key:1,class:"font-normal text-xs text-gray-700"},we={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},ke={class:"flex justify-center space-x-1"},Ce=e("span",null," Dispense ",-1),Oe={class:"flex justify-between"},De={key:0,class:"flex space-x-1"},Ve=e("span",null," Edit Product ",-1),$e={key:1,class:"flex space-x-1"},Be=e("span",null," Save ",-1),Se={key:0,class:"flex flex-col text-blue-800 text-sm p-3"},je={key:0,class:""},Me={key:1},Le={__name:"ChannelOverview",props:{productOptions:Object,vend:Object,showModal:Boolean},emits:["modalClose"],setup(n,{emit:C}){const l=n,g=y([]),m=y([]);M(()=>{g.value=l.productOptions.data.map(o=>({id:o.id,full_name:o.full_name+(o.desc?" "+o.desc:"")})),m.value=l.vend.vendChannelsJson.map(o=>({...o,product:o.product?{...o.product,option_data:{id:o.product.id,full_name:o.product.code+" - "+o.product.name+(o.product.desc?" "+o.product.desc:"")}}:null}))});const x=E().props.auth.profile,a=y(!1);function O(o){k.post("/vends/"+l.vend.id+"/dispense-product",{channel_id:o.id})}function D(){a.value?k.post("/vends/"+l.vend.id+"/edit-products",{channels:m.value.map(o=>({id:o.id,product_id:o.product.id,edited_product_id:o.product.option_data.id}))},{preserveScroll:!0,onSuccess:()=>{a.value=!1,C("modalClose")}}):a.value=!0}function V(o){return moment(o).format("YYMMDD hh:mm A")}return(o,p)=>(s(),f(N,{to:"body"},[u(B,{open:n.showModal,onModalClose:p[1]||(p[1]=t=>o.$emit("modalClose"))},{header:_(()=>[e("div",A,[l.profile?(s(),d("span",I," Channel Overview ")):r("",!0),n.vend.code?(s(),d("span",L," ID# "+c(n.vend.code),1)):r("",!0),n.vend.customer_code?(s(),d("span",T," ("+c(n.vend.customer_code?n.vend.customer_code:null)+") "+c(n.vend.customer_name?n.vend.customer_name:null),1)):r("",!0)])]),default:_(()=>[e("div",U,[e("div",Y,[e("div",z,[e("div",J,[e("table",K,[e("thead",G,[e("tr",null,[H,n.vend.product_mapping_name?(s(),d("th",Q," Image ")):r("",!0),R,W,X,e("th",Z,[w(" Price "),i(x)&&i(x).base_currency?(s(),d("span",ee," ("+c(i(x).base_currency.currency_symbol)+") ",1)):r("",!0)]),te,n.vend.product_mapping_name?(s(),d("th",se," Product ")):r("",!0),oe])]),e("tbody",de,[(s(!0),d(q,null,P(m.value,(t,$)=>(s(),d("tr",{key:t.id,class:v($%2===0?void 0:"bg-gray-50")},[e("td",ne,c(t.code),1),n.vend.product_mapping_name?(s(),d("td",re,[e("div",ce,[t.product&&t.product.thumbnail?(s(),d("img",{key:0,class:"h-16 w-16 rounded-full",src:t.product.thumbnail.full_url,alt:""},null,8,ae)):r("",!0)])])):r("",!0),e("td",le,c(t.capacity-t.qty),1),e("td",ie,c(t.qty),1),e("td",pe,c(t.capacity),1),e("td",ue,c((t.amount/100).toLocaleString(void 0,{minimumFractionDigits:2})),1),e("td",_e,[t.vend_channel_error_logs&&t.vend_channel_error_logs[0]&&t.vend_channel_error_logs[0].is_error_cleared==0?(s(),d("span",me,[e("div",{class:v([t.vend_channel_error_logs[0].vend_channel_error.code==4||t.vend_channel_error_logs[0].vend_channel_error.code==5||t.vend_channel_error_logs[0].vend_channel_error.code==7?" text-blue-800":" text-red-800"])},[e("span",xe," ("+c(t.vend_channel_error_logs[0].vend_channel_error.code)+") ",1),e("div",null,c(V(t.vend_channel_error_logs[0].created_at)),1)],2)])):r("",!0)]),n.vend.product_mapping_name?(s(),d("td",ye,[a.value?(s(),d("span",be,[u(j,{modelValue:t.product.option_data,"onUpdate:modelValue":h=>t.product.option_data=h,options:g.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","onUpdate:modelValue","options"])])):(s(),d("span",fe,[t.product&&t.product.code?(s(),d("span",ve,c(t.product.code),1)):r("",!0),t.product&&t.product.name?(s(),d("span",ge,[he,w(" "+c(t.product.name),1)])):r("",!0)]))])):r("",!0),e("td",we,[e("div",ke,[n.vend.is_mqtt?(s(),f(b,{key:0,type:"button",class:"bg-yellow-300 hover:bg-yellow-400 px-1 py-1 text-xs text-gray-800 flex space-x-1",onClick:h=>O(t)},{default:_(()=>[Ce]),_:2},1032,["onClick"])):r("",!0)])])],2))),128))])])])])])]),e("div",Oe,[e("span",null,[n.vend.product_mapping_name?(s(),f(b,{key:0,type:"button",class:v(["px-2 py-1 mt-2 ml-1 text-xs flex space-x-1",[a.value?"bg-green-300 hover:bg-green-400 text-green-800":"bg-gray-300 hover:bg-gray-400 text-gray-800"]]),onClick:p[0]||(p[0]=t=>D())},{default:_(()=>[a.value?(s(),d("span",$e,[u(i(S),{class:"w-4 h-4"}),Be])):(s(),d("span",De,[u(i(F),{class:"w-4 h-4"}),Ve]))]),_:1},8,["class"])):r("",!0)]),n.vend.product_mapping_name?(s(),d("span",Se,[n.vend.product_mapping_name?(s(),d("span",je,c(n.vend.product_mapping_name),1)):r("",!0),n.vend.product_mapping_remarks?(s(),d("span",Me,c(n.vend.product_mapping_remarks),1)):r("",!0)])):r("",!0)])]),_:1},8,["open"])]))}};export{Le as default};
