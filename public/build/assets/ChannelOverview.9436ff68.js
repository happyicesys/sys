import{_ as v}from"./Button.970da128.js";import{_ as M}from"./Modal.7ae99a25.js";import{_ as P}from"./MultiSelect.3cb2fcdc.js";import{g as h,K as S,h as j,c as g,a as _,w as x,q as F,o as t,b as s,f as o,l as n,t as c,d as b,u as a,k as E,F as L,n as k,O as q}from"./app.ec18ef6a.js";import{r as N,a as I}from"./ChevronDoubleUpIcon.4149cba2.js";import{r as T}from"./PencilSquareIcon.37ab6809.js";import{r as U}from"./CheckCircleIcon.13add622.js";import"./open-closed.21ff182f.js";import"./platform.3f464bef.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.56960726.js";const Y={class:"flex flex-col md:flex-row space-x-2"},z={key:0,class:"text-gray-600"},A={key:1},J={key:2},K={class:"flex flex-col"},Q={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},G={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},H={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},R={class:"table-fixed min-w-full divide-y divide-gray-300"},W={class:"bg-gray-50"},X=s("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," # ",-1),Z={key:0,scope:"col",class:"w-2/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},ee=s("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Sold ",-1),te=s("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Bal ",-1),se=s("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Cap ",-1),oe={scope:"col",class:"w-2/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},ne={key:0},re={key:1,scope:"col",class:"w-2/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},de={key:0},ce=s("th",{scope:"col",class:"w-1/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"}," Error ",-1),ae={key:2,scope:"col",class:"w-3/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},le={key:3,scope:"col",class:"w-3/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},ie={key:4,scope:"col",class:"w-3/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},pe={key:5,scope:"col",class:"w-3/12 px-3 py-3.5 text-center text-xs font-semibold text-gray-900"},ue={class:"bg-white"},me={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},_e={key:0,class:"whitespace-nowrap text-sm font-semibold text-gray-900 text-center"},xe={class:"flex justify-center items-center"},ye=["src"],fe={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-blue-600 sm:pl-6 text-center"},ge={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},ve={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},he={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},be={key:1,class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},ke={class:"py-1 pl-1 pr-1 text-xs font-medium text-gray-900 sm:pl-1 text-center"},we={key:0},Ce={class:"font-bold"},$e={key:2,class:"py-4 text-sm font-semibold text-gray-900 text-center"},Se={key:0},qe={key:0},De={key:1,class:"break-normal text-xs"},Oe=s("br",null,null,-1),Ve={key:1,class:"font-normal text-xs text-gray-700"},Be={key:3,class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},Me={key:4,class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},Pe={key:5,class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},je={class:"flex justify-center space-x-1"},Fe=s("span",null," Dispense ",-1),Ee={class:"flex justify-between"},Le={key:0,class:"flex space-x-1"},Ne=s("span",null," Edit Product ",-1),Ie={key:1,class:"flex space-x-1"},Te=s("span",null," Save ",-1),Ue={key:0,class:"flex flex-col text-blue-800 text-sm p-3"},Ye={key:0,class:""},ze={key:1},et={__name:"ChannelOverview",props:{productOptions:Object,vend:Object,showModal:Boolean},emits:["modalClose"],setup(d,{emit:w}){const y=d,l=h([]),C=S().props.auth.permissions,$=h([]),f=h(!1);j(()=>{$.value=y.productOptions.data.map(r=>({id:r.id,full_name:r.full_name+(r.desc?" "+r.desc:"")})),l.value=y.vend.vendChannelsJson.map(r=>({...r,product:r.product?{...r.product,option_data:{id:r.product.id,full_name:r.product.code+" - "+r.product.name+(r.product.desc?" "+r.product.desc:"")}}:null}))});const u=S().props.auth.profile,m=h(!1);function D(r){q.post("/vends/"+y.vend.id+"/dispense-product",{channel_id:r.id},{preserveScroll:!0,onSuccess:()=>{w("modalClose")}})}function O(){m.value?q.post("/vends/"+y.vend.id+"/edit-products",{channels:l.value.map(r=>({id:r.id,product_id:r.product.id,edited_product_id:r.product.option_data.id}))},{preserveScroll:!0,onSuccess:()=>{m.value=!1,w("modalClose")}}):m.value=!0}function V(r){return moment(r).format("YYMMDD hh:mm A")}return(r,i)=>(t(),g(F,{to:"body"},[_(M,{open:d.showModal,onModalClose:i[3]||(i[3]=e=>r.$emit("modalClose"))},{header:x(()=>[s("div",Y,[y.profile?(t(),o("span",z," Channel Overview ")):n("",!0),d.vend.code?(t(),o("span",A," ID# "+c(d.vend.code),1)):n("",!0),d.vend.customer_code?(t(),o("span",J," ("+c(d.vend.customer_code?d.vend.customer_code:null)+") "+c(d.vend.customer_name?d.vend.customer_name:null),1)):n("",!0)])]),default:x(()=>[s("div",K,[s("div",Q,[s("div",G,[s("div",H,[s("table",R,[s("thead",W,[s("tr",null,[X,d.vend.product_mapping_name?(t(),o("th",Z," Image ")):n("",!0),ee,te,se,s("th",oe,[b(" Price "),a(u)&&a(u).base_currency?(t(),o("span",ne," ("+c(a(u).base_currency.currency_symbol)+") ",1)):n("",!0)]),l.value.some(e=>"amount2"in e)?(t(),o("th",re,[b(" Price 2 "),a(u)&&a(u).base_currency?(t(),o("span",de," ("+c(a(u).base_currency.currency_symbol)+") ",1)):n("",!0)])):n("",!0),ce,d.vend.product_mapping_name?(t(),o("th",ae," Product ")):n("",!0),l.value.some(e=>"sku_code"in e)?(t(),o("th",le," Product ")):n("",!0),l.value.some(e=>"locked_qty"in e)?(t(),o("th",ie," Locked Qty ")):n("",!0),a(C).includes("admin-access vends")?(t(),o("th",pe,[!f.value&&d.vend.is_mqtt?(t(),g(v,{key:0,class:"inline-flex space-x-1 items-center rounded-md border border-green bg-gray-200 px-4 py-2 md:px-3 text-sm font-medium leading-4 text-gray-800 shadow-sm hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:i[0]||(i[0]=e=>f.value=!0)},{default:x(()=>[_(a(N),{class:"h-3 w-3","aria-hidden":"true"})]),_:1})):n("",!0),f.value&&d.vend.is_mqtt?(t(),g(v,{key:1,class:"inline-flex space-x-1 items-center rounded-md border border-green bg-gray-300 px-4 py-2 md:px-3 text-sm font-medium leading-4 text-gray-800 shadow-sm hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:i[1]||(i[1]=e=>f.value=!1)},{default:x(()=>[_(a(I),{class:"h-3 w-3","aria-hidden":"true"})]),_:1})):n("",!0)])):n("",!0)])]),s("tbody",ue,[(t(!0),o(L,null,E(l.value,(e,B)=>(t(),o("tr",{key:e.id,class:k(B%2===0?void 0:"bg-gray-50")},[s("td",me,c(e.code),1),d.vend.product_mapping_name?(t(),o("td",_e,[s("div",xe,[e.product&&e.product.thumbnail?(t(),o("img",{key:0,class:"h-16 w-16 rounded-full",src:e.product.thumbnail.full_url,alt:""},null,8,ye)):n("",!0)])])):n("",!0),s("td",fe,c(e.capacity-e.qty),1),s("td",ge,c(e.qty),1),s("td",ve,c(e.capacity),1),s("td",he,c((e.amount/100).toLocaleString(void 0,{minimumFractionDigits:2})),1),l.value.some(p=>"amount2"in p)?(t(),o("td",be,c((e.amount2/100).toLocaleString(void 0,{minimumFractionDigits:2})),1)):n("",!0),s("td",ke,[e.vend_channel_error_logs&&e.vend_channel_error_logs[0]&&e.vend_channel_error_logs[0].is_error_cleared==0?(t(),o("span",we,[s("div",{class:k([e.vend_channel_error_logs[0].vend_channel_error.code==4||e.vend_channel_error_logs[0].vend_channel_error.code==5||e.vend_channel_error_logs[0].vend_channel_error.code==7?" text-blue-800":" text-red-800"])},[s("span",Ce," ("+c(e.vend_channel_error_logs[0].vend_channel_error.code)+") ",1),s("div",null,c(V(e.vend_channel_error_logs[0].created_at)),1)],2)])):n("",!0)]),d.vend.product_mapping_name?(t(),o("td",$e,[m.value?(t(),o("span",Ve,[_(P,{modelValue:e.product.option_data,"onUpdate:modelValue":p=>e.product.option_data=p,options:$.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","onUpdate:modelValue","options"])])):(t(),o("span",Se,[e.product&&e.product.code?(t(),o("span",qe,c(e.product.code),1)):n("",!0),e.product&&e.product.name?(t(),o("span",De,[Oe,b(" "+c(e.product.name),1)])):n("",!0)]))])):n("",!0),l.value.some(p=>"sku_code"in p)?(t(),o("td",Be,c(e.sku_code),1)):n("",!0),l.value.some(p=>"locked_qty"in p)?(t(),o("td",Me,c(e.locked_qty),1)):n("",!0),a(C).includes("admin-access vends")?(t(),o("td",Pe,[s("div",je,[d.vend.is_mqtt&&f.value?(t(),g(v,{key:0,type:"button",class:"bg-yellow-300 hover:bg-yellow-400 px-1 py-1 text-xs text-gray-800 flex space-x-1",onClick:p=>D(e)},{default:x(()=>[Fe]),_:2},1032,["onClick"])):n("",!0)])])):n("",!0)],2))),128))])])])])])]),s("div",Ee,[s("span",null,[d.vend.product_mapping_name?(t(),g(v,{key:0,type:"button",class:k(["px-2 py-1 mt-2 ml-1 text-xs flex space-x-1",[m.value?"bg-green-300 hover:bg-green-400 text-green-800":"bg-gray-300 hover:bg-gray-400 text-gray-800"]]),onClick:i[2]||(i[2]=e=>O())},{default:x(()=>[m.value?(t(),o("span",Ie,[_(a(U),{class:"w-4 h-4"}),Te])):(t(),o("span",Le,[_(a(T),{class:"w-4 h-4"}),Ne]))]),_:1},8,["class"])):n("",!0)]),d.vend.product_mapping_name?(t(),o("span",Ue,[d.vend.product_mapping_name?(t(),o("span",Ye,c(d.vend.product_mapping_name),1)):n("",!0),d.vend.product_mapping_remarks?(t(),o("span",ze,c(d.vend.product_mapping_remarks),1)):n("",!0)])):n("",!0)])]),_:1},8,["open"])]))}};export{et as default};
