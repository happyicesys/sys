import{o,f as n,b as t,g as m,T as k,Q as Z,h as q,c as h,a as d,w as u,l as i,p as E,t as p,u as _,d as v,n as V,F as P,k as T,e as M,U as G}from"./app.8898d4aa.js";import{_ as g}from"./Button.fba1dbc6.js";import{_ as H}from"./DatePicker.3befee5f.js";import R from"./Uom.d4d156d4.js";import{_ as x}from"./FormInput.dfa6e954.js";import{_ as W}from"./FormTextarea.ea711445.js";import{_ as S}from"./MultiSelect.a357f5ed.js";import{_ as z}from"./Modal.ed692cbc.js";import{r as I}from"./RectangleStackIcon.ef635f5d.js";import{r as Q}from"./PlusCircleIcon.fedab235.js";import{r as J}from"./BackspaceIcon.5d886fae.js";import{r as K}from"./ArrowUturnLeftIcon.716437d7.js";import{r as X}from"./CheckCircleIcon.63aaa26f.js";import"./main.31cf9f45.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.449d6c17.js";import"./keyboard.f049aad0.js";import"./disposables.0ec1677e.js";function ee(r,y){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M2 4.75C2 3.784 2.784 3 3.75 3h4.836c.464 0 .909.184 1.237.513l1.414 1.414a.25.25 0 0 0 .177.073h4.836c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 16.25 17H3.75A1.75 1.75 0 0 1 2 15.25V4.75Zm10.25 7a.75.75 0 0 0 0-1.5h-4.5a.75.75 0 0 0 0 1.5h4.5Z","clip-rule":"evenodd"})])}function te(r,y){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M3.75 3A1.75 1.75 0 0 0 2 4.75v10.5c0 .966.784 1.75 1.75 1.75h12.5A1.75 1.75 0 0 0 18 15.25v-8.5A1.75 1.75 0 0 0 16.25 5h-4.836a.25.25 0 0 1-.177-.073L9.823 3.513A1.75 1.75 0 0 0 8.586 3H3.75ZM10 8a.75.75 0 0 1 .75.75v1.5h1.5a.75.75 0 0 1 0 1.5h-1.5v1.5a.75.75 0 0 1-1.5 0v-1.5h-1.5a.75.75 0 0 1 0-1.5h1.5v-1.5A.75.75 0 0 1 10 8Z","clip-rule":"evenodd"})])}const se={class:"flex flex-col md:flex-row space-x-2"},oe={key:0,class:"text-gray-600"},ae={key:1},re={key:2,class:"text-gray-600"},le={class:"grid grid-cols-1 gap-y-3 gap-x-3 sm:grid-cols-6"},ne={class:"sm:col-span-6 pb-3"},de={class:"mt-1 flex flex-col md:flex-row space-y-2 md:space-y-0 items-center"},ie={class:"h-28 w-28 overflow-hidden rounded-full bg-gray-100"},ue=["href"],ce=["src"],me=["value"],pe=t("span",{class:"text-sm p-2 text-red-600"}," * Image file, max 500kb ",-1),ve={key:0,class:"text-sm text-red-600"},_e={class:"sm:col-span-2"},fe={class:"sm:col-span-4"},he={class:"sm:col-span-6"},ge={class:"sm:col-span-2"},xe={class:"sm:col-span-2"},ye={class:"sm:col-span-2"},be=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," UOM ",-1),we={key:0,class:"text-sm text-red-600"},ke={class:"col-span-12 sm:col-span-6"},Ve=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"},[v(" Operator "),t("span",{class:"text-red-500"}," * ")],-1),Ce={key:0,class:"text-sm text-red-600"},Oe={key:0,class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},Ue=t("div",{class:"relative"},[t("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[t("div",{class:"w-full border-t border-gray-300"})]),t("div",{class:"relative flex justify-center"},[t("span",{class:"px-3 bg-white text-lg font-medium text-gray-900"}," Unit Cost")])],-1),$e=[Ue],Me={key:1,class:"sm:col-span-3"},Se={key:2,class:"sm:col-span-3"},je=t("span",{class:"text-[9px]"}," (Leave blank to start NOW) ",-1),Ne={key:3,class:"sm:col-span-6 flex justify-start"},Ae=t("span",null," Add ",-1),Be={key:4,class:"sm:col-span-6 flex flex-col mt-3"},De={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},Fe={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},Le={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},Ye={class:"min-w-full divide-y divide-gray-300"},Ze=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," # "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Unit Cost "),t("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Start Date "),t("th")])],-1),qe={class:"bg-white"},Ee={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},Pe={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},Te={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},Ge={class:"whitespace-nowrap py-4 text-sm text-center"},He={key:1,class:"inline-flex items-center rounded-md bg-indigo-50 px-1.5 py-0.5 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-700/10"},Re={key:0},We=t("td",{colspan:"4",class:"whitespace-nowrap py-4 text-sm font-medium text-black-600 text-center"}," No Results Found ",-1),ze=[We],Ie={class:"sm:col-span-6"},Qe={class:"flex space-x-1 mt-5 pt-5 justify-end"},Je=t("span",null," Back ",-1),Ke={key:0,class:"flex space-x-1 items-center"},Xe=t("span",null," Deactivate ",-1),et={key:1,class:"flex space-x-1 items-center"},tt=t("span",null," Activate ",-1),st=t("span",null," Save ",-1),bt={__name:"Form",props:{categories:Object,categoryGroups:Object,measurementUnitOptions:Object,product:Object,uoms:Object,type:String,showModal:Boolean,operatorOptions:Object,permissions:[Array,Object]},emits:["modalClose"],setup(r,{emit:y}){const c=r,b=y,j=m([]),N=m([]),C=m([]),w=m(!1),A=m([]),f=m([]),e=m(k(U())),O=m([]);Z().props.auth.operatorRole,q(()=>{e.value=c.product?k(c.product):k(U()),j.value=c.categories.data.map(l=>({id:l.id,name:l.name})),N.value=c.categoryGroups.data.map(l=>({id:l.id,name:l.name})),C.value=Object.keys(c.measurementUnitOptions).map((l,a)=>({id:l,name:l})),A.value=c.uoms.data.map(l=>({id:l.id,name:l.name})),O.value=c.operatorOptions.slice(1),f.value=c.product?c.product.unitCosts:null});function U(){return{code:"",date_from:"",desc:"",name:"",thumbnail:"",is_inventory:1,is_commission:"",is_supermarket_fee:"",category_id:"",category_group_id:"",measurement_count:"",measurement_value:"",measurement_unit:"",operator_id:"",unit_cost:"",date_from:""}}function B(){e.value.clearErrors(),c.type==="create"&&e.value.transform(l=>({...l,measurement_unit:l.measurement_unit.id,operator_id:l.operator_id.id})).post("/products/create",{onSuccess:()=>{b("modalClose")},preserveState:!0,replace:!0}),c.type==="update"&&e.value.transform(l=>({...l,measurement_unit:l.measurement_unit.id,operator_id:l.operator_id.id,unitCosts:f.value})).post("/products/"+e.value.id+"/update",{onSuccess:()=>{b("modalClose")},preserveScroll:!0,preserveState:!0,replace:!0})}function D(){e.value.post("/products/"+e.value.id+"/toggle-activate-deactivate",{onSuccess:()=>{b("modalClose")},preserveState:!0,replace:!0})}function F(){w.value=!1}function L(){f.value.unshift({cost:e.value.unit_cost,date_from:e.value.date_from?e.value.date_from:G().format("YYYY-MM-DD")})}function Y(l){f.value.splice(f.value.indexOf(l),1)}return(l,a)=>(o(),h(E,{to:"body"},[d(z,{open:r.showModal,onModalClose:a[12]||(a[12]=s=>l.$emit("modalClose"))},{header:u(()=>[t("div",se,[r.product?(o(),n("span",oe," Editing ")):i("",!0),c.product?(o(),n("span",ae,p(r.product.name),1)):(o(),n("span",re," Create New Product "))])]),default:u(()=>[t("form",{onSubmit:M(B,["prevent"]),id:"submit"},[t("div",le,[t("div",ne,[t("div",de,[t("span",ie,[r.product&&r.product.thumbnail?(o(),n("a",{key:0,href:r.product.thumbnail.full_url,target:"_blank"},[r.product&&r.product.thumbnail?(o(),n("img",{key:0,class:"h-28 w-28 rounded-full border",src:r.product.thumbnail.full_url,alt:""},null,8,ce)):i("",!0),d(_(I),{class:"h-28 w-28 text-gray-300"})],8,ue)):i("",!0)]),r.permissions.includes("update products")?(o(),n("input",{key:0,type:"file",onInput:a[0]||(a[0]=s=>e.value.thumbnail=s.target.files[0]),class:"ml-5 rounded-md border border-gray-300 bg-white py-2 px-3 text-sm font-medium leading-4 text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},null,32)):i("",!0),e.value.progress?(o(),n("progress",{key:1,value:e.value.progress.percentage,max:"100"},p(e.value.progress.percentage)+"% ",9,me)):i("",!0),pe]),e.value.errors.thumbnail?(o(),n("div",ve,p(e.value.errors.thumbnail),1)):i("",!0)]),t("div",_e,[d(x,{modelValue:e.value.code,"onUpdate:modelValue":a[1]||(a[1]=s=>e.value.code=s),error:e.value.errors.code,disabled:!r.permissions.includes("update products"),required:"true"},{default:u(()=>[v(" Code ")]),_:1},8,["modelValue","error","disabled"])]),t("div",fe,[d(x,{modelValue:e.value.name,"onUpdate:modelValue":a[2]||(a[2]=s=>e.value.name=s),error:e.value.errors.name,disabled:!r.permissions.includes("update products"),required:"true"},{default:u(()=>[v(" Name ")]),_:1},8,["modelValue","error","disabled"])]),t("div",he,[d(W,{modelValue:e.value.desc,"onUpdate:modelValue":a[3]||(a[3]=s=>e.value.desc=s),disabled:!r.permissions.includes("update products"),error:e.value.errors.desc},{default:u(()=>[v(" Desc ")]),_:1},8,["modelValue","disabled","error"])]),t("div",ge,[d(x,{modelValue:e.value.measurement_count,"onUpdate:modelValue":a[4]||(a[4]=s=>e.value.measurement_count=s),error:e.value.errors.measurement_count,disabled:!r.permissions.includes("update products")},{default:u(()=>[v(" Lowest Unit ")]),_:1},8,["modelValue","error","disabled"])]),t("div",xe,[d(x,{modelValue:e.value.measurement_value,"onUpdate:modelValue":a[5]||(a[5]=s=>e.value.measurement_value=s),error:e.value.errors.measurement_value,disabled:!r.permissions.includes("update products")},{default:u(()=>[v(" Volume/ Weight ")]),_:1},8,["modelValue","error","disabled"])]),t("div",ye,[be,d(S,{modelValue:e.value.measurement_unit,"onUpdate:modelValue":a[6]||(a[6]=s=>e.value.measurement_unit=s),options:C.value,trackBy:"id",valueProp:"id",label:"name",placeholder:"Select","open-direction":"top",class:"mt-1"},null,8,["modelValue","options"]),e.value.errors.measurement_unit?(o(),n("div",we,p(e.value.errors.measurement_unit),1)):i("",!0)]),t("div",ke,[Ve,d(S,{modelValue:e.value.operator_id,"onUpdate:modelValue":a[7]||(a[7]=s=>e.value.operator_id=s),options:O.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"top",class:"mt-1"},null,8,["modelValue","options"]),e.value.errors.operator_id?(o(),n("div",Ce,p(e.value.errors.operator_id),1)):i("",!0)]),e.value.id?(o(),n("div",Oe,$e)):i("",!0),e.value.id?(o(),n("div",Me,[d(x,{modelValue:e.value.unit_cost,"onUpdate:modelValue":a[8]||(a[8]=s=>e.value.unit_cost=s),error:e.value.errors.unit_cost,required:"true"},{default:u(()=>[v(" Unit Cost ")]),_:1},8,["modelValue","error"])])):i("",!0),e.value.id?(o(),n("div",Se,[d(H,{modelValue:e.value.date_from,"onUpdate:modelValue":a[9]||(a[9]=s=>e.value.date_from=s)},{default:u(()=>[v(" Start Date "),je]),_:1},8,["modelValue"])])):i("",!0),e.value.id?(o(),n("div",Ne,[d(g,{type:"button",onClick:a[10]||(a[10]=s=>L()),class:V(["bg-green-500 hover:bg-green-600 text-white",[!e.value.unit_cost||isNaN(e.value.unit_cost)?"opacity-50 cursor-not-allowed":""]]),disabled:!e.value.unit_cost||isNaN(e.value.unit_cost)},{default:u(()=>[d(_(Q),{class:"w-4 h-4"}),Ae]),_:1},8,["class","disabled"])])):i("",!0),e.value.id?(o(),n("div",Be,[t("div",De,[t("div",Fe,[t("div",Le,[t("table",Ye,[Ze,t("tbody",qe,[(o(!0),n(P,null,T(r.product.unitCosts,(s,$)=>(o(),n("tr",{key:s.id,class:V($%2===0?void 0:"bg-gray-50")},[t("td",Ee,p($+1),1),t("td",Pe,p(s.cost),1),t("td",Te,p(s.date_from),1),t("td",Ge,[s.id?i("",!0):(o(),h(g,{key:0,class:"bg-red-400 hover:bg-red-500 text-white",onClick:ot=>Y(s)},{default:u(()=>[d(_(J),{class:"w-4 h-4"})]),_:2},1032,["onClick"])),s.is_current?(o(),n("span",He," Current ")):i("",!0)])],2))),128)),r.product.unitCosts.length?i("",!0):(o(),n("tr",Re,ze))])])])])])])):i("",!0)]),t("div",Ie,[t("div",Qe,[d(g,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1",onClick:a[11]||(a[11]=M(s=>l.$emit("modalClose"),["prevent"])),form:"submit"},{default:u(()=>[d(_(K),{class:"w-4 h-4"}),Je]),_:1}),e.value.id&&r.permissions.includes("update products")?(o(),h(g,{key:0,type:"button",onClick:D,class:V(["text-white",[e.value.is_active?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"]])},{default:u(()=>[t("div",null,[e.value.is_active?(o(),n("span",Ke,[d(_(ee),{class:"w-4 h-4"}),Xe])):(o(),n("span",et,[d(_(te),{class:"w-4 h-4"}),tt]))])]),_:1},8,["class"])):i("",!0),r.permissions.includes("update products")?(o(),h(g,{key:1,type:"submit",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1"},{default:u(()=>[d(_(X),{class:"w-4 h-4"}),st]),_:1})):i("",!0)])])],32)]),_:1},8,["open"]),w.value?(o(),h(R,{key:0,product:r.product,uoms:r.uoms,showModal:w.value,onModalClose:F},null,8,["product","uoms","showModal"])):i("",!0)]))}};export{bt as default};
