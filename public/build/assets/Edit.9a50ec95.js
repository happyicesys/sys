import{g as p,T as C,Q as A,h as P,f as c,a,u as _,w as i,F as L,o as n,Z as M,b as e,e as y,n as N,l as u,d as m,t as h,c as V,i as T,O as F}from"./app.8898d4aa.js";import{_ as J}from"./Authenticated.91c411f9.js";import{_ as k}from"./Button.fba1dbc6.js";import{_ as G}from"./DatePicker.3befee5f.js";import{_ as v}from"./FormInput.dfa6e954.js";import{_ as b}from"./MultiSelect.a357f5ed.js";import{_ as q}from"./SearchAddressInput.39efbedb.js";import{r as z}from"./CheckCircleIcon.63aaa26f.js";import{r as H}from"./ArrowUturnLeftIcon.716437d7.js";import{r as j}from"./XCircleIcon.2e042461.js";import"./keyboard.f049aad0.js";import"./use-resolve-button-type.aeca7380.js";import"./RectangleStackIcon.ef635f5d.js";import"./main.31cf9f45.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.449d6c17.js";import"./combobox.b87c525d.js";import"./disposables.0ec1677e.js";import"./MagnifyingGlassCircleIcon.b67d50ca.js";const K=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Editing Customer ",-1),Q={class:"m-2 sm:mx-5 sm:my-3 px-1 sm:px-2 lg:px-3"},R={class:"mt-6 flex flex-col"},Y={class:"-my-2 -mx-4 sm:-mx-6 lg:-mx-8"},Z={class:"shadow-sm ring-1 ring-black ring-opacity-5 p-5 mb-3"},W={class:"pb-5"},X=e("div",{class:"relative mb-5"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-2 bg-white text-lg font-medium text-gray-900 rounded"}," Customer ")])],-1),ee={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},te={class:"sm:col-span-6 flex space-x-1"},se={key:0},oe={key:1},de={key:0,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-green-300"},le=e("div",{class:"flex flex-col"}," From CMS ",-1),re=[le],ae={key:1,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-gray-300"},ie=e("div",{class:"flex flex-col"}," No Customer Binding ",-1),ne=[ie],ue={key:0,class:"sm:col-span-1"},ce=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," ID ",-1),me={class:"mt-1"},ve=["value"],_e={key:1,class:"sm:col-span-5"},pe=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),fe={class:"mt-1"},be=["value"],xe={key:2,class:"sm:col-span-6 grid grid-cols-1 gap-3 sm:grid-cols-6"},ge={class:"sm:col-span-2"},ye={class:"sm:col-span-3"},he={key:3,class:"sm:col-span-6 text-blue-600 text-xs"},Ve=["href"],ke={class:"sm:col-span-5"},we=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Is Active? (Customer) ",-1),Ce={key:0,class:"text-sm text-red-600"},Se={class:"sm:col-span-2"},Oe={key:0,class:"sm:col-span-6 grid grid-cols-1 gap-3 sm:grid-cols-6"},Ue=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-6 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-4 bg-white text-lg font-medium text-gray-900 rounded"}," Contact ")])])],-1),Ne={class:"sm:col-span-3"},je={class:"sm:col-span-3"},Be={class:"sm:col-span-2"},De=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Phone Code ",-1),$e={key:0,class:"text-sm text-red-600"},Ee={class:"sm:col-span-4"},Ie=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Address ")])])],-1),Ae={class:"sm:col-span-6"},Pe={class:"sm:col-span-3"},Le={class:"sm:col-span-3"},Me={class:"sm:col-span-3"},Te={class:"sm:col-span-3"},Fe={class:"sm:col-span-3"},Je=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Country ",-1),Ge={key:0,class:"text-sm text-red-600"},qe={class:"sm:col-span-3 hidden"},ze={class:"sm:col-span-3 hidden"},He=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Operator ")])])],-1),Ke={class:"col-span-12 sm:col-span-6"},Qe=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"},[m(" Operator "),e("span",{class:"text-red-500"}," * ")],-1),Re={key:0,class:"text-sm text-red-600"},Ye=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Vending Machine ")])])],-1),Ze={key:1,class:"sm:col-span-6 mb-3"},We=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vend ID# ",-1),Xe={class:"mt-1"},et=["value"],tt={key:2,class:"sm:col-span-6"},st=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vend ID# ",-1),ot={class:"sm:col-span-6 mt-3"},dt={class:"flex justify-between"},lt={class:"flex space-x-1"},rt=e("span",null," Save Customer ",-1),at=e("span",null," Back ",-1),it=e("span",null," Unbind VM & Customer ",-1),nt=e("span",null," Delete Customer ",-1),Ut={__name:"Edit",props:{vendOptions:Object,countries:Object,operatorOptions:Object,customer:Object,type:String},setup(o){const r=o,t=p(C(U()));p([]);const x=p([{id:"true",value:"Yes"},{id:"false",value:"No"}]),f=p([]),S=p(1),w=p([]),g=A().props.auth.permissions,O=p([]);function U(){return{id:"",customer_id:"",person_id:"",operator_id:"",begin_date:"",termination_date:"",code:"",name:"",address:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""},contact:{name:"",email:"",phone_country_id:"",phone_num:""},vend_id:""}}P(()=>{f.value=r.countries.data,w.value=r.operatorOptions.data,t.value=r.customer?C({...JSON.parse(JSON.stringify(r.customer)),code:r.customer&&r.customer.person_id?r.customer.virtual_customer_code+" ("+r.customer.virtual_customer_prefix+")":r.customer?r.customer.code:null,operator_id:r.customer&&r.customer.operator_id?w.value.find(l=>l.id===r.customer.operator_id):null,vend_id:"",person_id:r.customer?r.customer.person_id:null,contact:r.customer?{...JSON.parse(JSON.stringify(r.customer.contact))}:{name:"",email:"",phone_country_id:"",phone_num:""},address:r.customer?{...r.customer.delivery_address,country_id:r.customer&&r.customer.delivery_address?f.value.find(l=>l.id===r.customer.delivery_address.country_id):null}:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""},is_active:r.customer?r.customer.is_active?x.value.find(l=>l.id==="true"):x.value.find(l=>l.id==="false"):x.value.find(l=>l.id==="true")}):C(U()),O.value=r.vendOptions.map(l=>({id:l.id,full_name:l.code}))});function B(l){t.value.clearErrors(),t.value.delete("/customers/"+l,{onSuccess:()=>{F.push("/customers")},preserveState:!0,replace:!0})}function D(l){t.value.clearErrors(),t.value.transform(s=>({id:s.vend_id?s.vend_id.id:null,customer:{...s,begin_date:s.begin_date&&s.begin_date!="Invalid date"?s.begin_date:null,termination_date:s.termination_date&&s.termination_date!="Invalid date"?s.termination_date:null,operator_id:s.operator_id?s.operator_id.id:null,contact:{...s.contact,phone_country_id:s.contact.phone_country_id?s.contact.phone_country_id.id:null},address:{...s.address,country_id:s.address.country_id?s.address.country_id.id:null},is_active:s.is_active.id,vend_id:s.vend_id?s.vend_id.id:null}})).post("/customers/"+l+"/update",{onSuccess:()=>{},preserveState:!0,replace:!0})}function $(){t.value.clearErrors(),t.value.post("/customers/"+t.value.id+"/update",{onSuccess:()=>{emit("modalClose")},preserveState:!0,replace:!0})}function E(l){t.value.address={block_num:l.BLK_NO,building:l.BUILDING,country_id:f.value[0],latitude:l.LATITUDE,longitude:l.LONGTITUDE,postcode:l.POSTAL,street_name:l.ROAD_NAME,unit_num:""}}function I(l){t.value.post("/vends/"+l+"/unbind-customer",{onSuccess:()=>{},preserveState:!0,replace:!0})}return(l,s)=>(n(),c(L,null,[a(_(M),{title:"Customer"}),a(J,null,{header:i(()=>[K]),default:i(()=>[e("div",Q,[e("div",R,[e("div",Y,[e("div",Z,[e("form",{onSubmit:y($,["prevent"]),id:"submit"},[e("div",W,[X,e("div",ee,[e("div",te,[e("div",{class:N(["inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit",[o.customer.is_active?"bg-green-300":"bg-red-300"]])},[o.customer.is_active?(n(),c("span",se," Active ")):u("",!0),o.customer.is_active?u("",!0):(n(),c("span",oe," Not Active "))],2),o.customer.person_id?(n(),c("div",de,re)):u("",!0),o.customer.vend?u("",!0):(n(),c("div",ae,ne))]),o.customer.id?(n(),c("div",ue,[ce,e("div",me,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:o.customer.id+1e4,disabled:""},null,8,ve)])])):u("",!0),o.customer.id&&o.customer.person_id?(n(),c("div",_e,[pe,e("div",fe,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:o.customer.person_id?o.customer.virtual_customer_code+" ("+o.customer.virtual_customer_prefix+") - "+o.customer.name:o.customer.code+" - "+o.customer.name,disabled:""},null,8,be)])])):u("",!0),o.customer.id&&!o.customer.person_id||!o.customer.id&&S.value!=1?(n(),c("div",xe,[e("div",ge,[a(v,{modelValue:t.value.code,"onUpdate:modelValue":s[0]||(s[0]=d=>t.value.code=d),error:t.value.errors.code,disabled:t.value.person_id},{default:i(()=>[m(" Cust Code ")]),_:1},8,["modelValue","error","disabled"])]),e("div",ye,[a(v,{modelValue:t.value.name,"onUpdate:modelValue":s[1]||(s[1]=d=>t.value.name=d),error:t.value.errors.name,required:"true",disabled:t.value.person_id},{default:i(()=>[m(" Cust Name ")]),_:1},8,["modelValue","error","disabled"])])])):u("",!0),o.customer.person_id?(n(),c("div",he,[m(" ** Customer Data only editable from CMS "),e("span",null,[e("a",{class:N([t.value.person_id?"text-blue-700":"text-gray-500"]),target:"_blank",href:"//admin.happyice.com.sg/person/"+t.value.person_id+"/edit"}," (Click Here) ",10,Ve)])])):u("",!0),e("div",ke,[we,a(b,{modelValue:t.value.is_active,"onUpdate:modelValue":s[2]||(s[2]=d=>t.value.is_active=d),options:x.value,trackBy:"id",valueProp:"id",label:"value",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),t.value.errors["customer.is_testing"]?(n(),c("div",Ce,h(t.value.errors["customer.is_testing"]),1)):u("",!0)]),e("div",Se,[_(g).includes("update customers")?(n(),V(G,{key:0,modelValue:t.value.begin_date,"onUpdate:modelValue":s[3]||(s[3]=d=>t.value.begin_date=d),error:t.value.errors.begin_date,onInput:s[4]||(s[4]=d=>l.onDateFromChanged())},{default:i(()=>[m(" Begin Date ")]),_:1},8,["modelValue","error"])):u("",!0)])]),o.customer.id&&!o.customer.person_id||!o.customer.id&&S.value!=1?(n(),c("div",Oe,[Ue,e("div",Ne,[a(v,{modelValue:t.value.contact.name,"onUpdate:modelValue":s[5]||(s[5]=d=>t.value.contact.name=d),error:t.value.errors["contact.name"],disabled:o.customer.person_id},{default:i(()=>[m(" Name ")]),_:1},8,["modelValue","error","disabled"])]),e("div",je,[a(v,{modelValue:t.value.contact.email,"onUpdate:modelValue":s[6]||(s[6]=d=>t.value.contact.email=d),error:t.value.errors["contact.email"],disabled:o.customer.person_id},{default:i(()=>[m(" Email ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Be,[De,a(b,{modelValue:t.value.contact.phone_country_id,"onUpdate:modelValue":s[7]||(s[7]=d=>t.value.contact.phone_country_id=d),options:f.value,disabled:t.value.person_id,trackBy:"id",valueProp:"id",label:"phone_code",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options","disabled"]),t.value.errors["contact.phone_country_id"]?(n(),c("div",$e,h(t.value.errors["contact.phone_country_id"]),1)):u("",!0)]),e("div",Ee,[a(v,{modelValue:t.value.contact.phone_num,"onUpdate:modelValue":s[8]||(s[8]=d=>t.value.contact.phone_num=d),error:t.value.errors["contact.phone_num"],disabled:o.customer.person_id},{default:i(()=>[m(" Phone Number ")]),_:1},8,["modelValue","error","disabled"])]),Ie,e("div",Ae,[a(q,{modelValue:t.value.address.postcode,"onUpdate:modelValue":s[9]||(s[9]=d=>t.value.address.postcode=d),onSelected:E,error:t.value.errors["address.postcode"],disabled:o.customer.person_id},{default:i(()=>[m(" Postcode ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Pe,[a(v,{modelValue:t.value.address.unit_num,"onUpdate:modelValue":s[10]||(s[10]=d=>t.value.address.unit_num=d),error:t.value.errors["address.unit_num"]},{default:i(()=>[m(" Unit Num ")]),_:1},8,["modelValue","error"])]),e("div",Le,[a(v,{modelValue:t.value.address.block_num,"onUpdate:modelValue":s[11]||(s[11]=d=>t.value.address.block_num=d),error:t.value.errors["address.block_num"],disabled:o.customer.person_id},{default:i(()=>[m(" Block Num ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Me,[a(v,{modelValue:t.value.address.building,"onUpdate:modelValue":s[12]||(s[12]=d=>t.value.address.building=d),error:t.value.errors["address.building"],disabled:o.customer.person_id},{default:i(()=>[m(" Building Name ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Te,[a(v,{modelValue:t.value.address.street_name,"onUpdate:modelValue":s[13]||(s[13]=d=>t.value.address.street_name=d),error:t.value.errors["address.street_name"],disabled:o.customer.person_id},{default:i(()=>[m(" Street Name ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Fe,[Je,a(b,{modelValue:t.value.address.country_id,"onUpdate:modelValue":s[14]||(s[14]=d=>t.value.address.country_id=d),options:f.value,trackBy:"id",valueProp:"id",label:"name",placeholder:"Select","open-direction":"bottom",class:"mt-1",disabled:o.customer.person_id},null,8,["modelValue","options","disabled"]),t.value.errors["address.country_id"]?(n(),c("div",Ge,h(t.value.errors["address.country_id"]),1)):u("",!0)]),e("div",qe,[a(v,{modelValue:t.value.address.latitude,"onUpdate:modelValue":s[15]||(s[15]=d=>t.value.address.latitude=d)},{default:i(()=>[m(" Latitude ")]),_:1},8,["modelValue"])]),e("div",ze,[a(v,{modelValue:t.value.address.longitude,"onUpdate:modelValue":s[16]||(s[16]=d=>t.value.address.longitude=d)},{default:i(()=>[m(" Longitude ")]),_:1},8,["modelValue"])])])):u("",!0),He,e("div",Ke,[Qe,a(b,{modelValue:t.value.operator_id,"onUpdate:modelValue":s[17]||(s[17]=d=>t.value.operator_id=d),options:w.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"top",class:"mt-1"},null,8,["modelValue","options"]),t.value.errors.operator_id?(n(),c("div",Re,h(t.value.errors.operator_id),1)):u("",!0)]),Ye,o.customer.vend?(n(),c("div",Ze,[We,e("div",Xe,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:o.customer.vend?o.customer.vend.code:"",disabled:""},null,8,et)])])):u("",!0),o.customer.vend?u("",!0):(n(),c("div",tt,[st,a(b,{modelValue:t.value.vend_id,"onUpdate:modelValue":s[18]||(s[18]=d=>t.value.vend_id=d),options:O.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"])])),e("div",ot,[e("span",dt,[e("span",lt,[_(g).includes("update customers")?(n(),V(k,{key:0,type:"button",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1",onClick:s[19]||(s[19]=y(d=>D(t.value.id),["prevent"]))},{default:i(()=>[a(_(z),{class:"w-4 h-4"}),rt]),_:1})):u("",!0),a(_(T),{href:"/customers"},{default:i(()=>[a(k,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1"},{default:i(()=>[a(_(H),{class:"w-4 h-4"}),at]),_:1})]),_:1})]),o.customer.vend&&_(g).includes("update customers")?(n(),V(k,{key:0,type:"button",class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:s[20]||(s[20]=y(d=>I(o.customer.vend.id),["prevent"]))},{default:i(()=>[a(_(j),{class:"w-4 h-4"}),it]),_:1})):u("",!0),!o.customer.vend&&_(g).includes("update customers")?(n(),V(k,{key:1,type:"button",class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:s[21]||(s[21]=y(d=>B(o.customer.id),["prevent"]))},{default:i(()=>[a(_(j),{class:"w-4 h-4"}),nt]),_:1})):u("",!0)])])])],32)])])])])]),_:1})],64))}};export{Ut as default};
