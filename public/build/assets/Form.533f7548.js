import{o as a,g as l,d as t,i as m,u as g,l as B,j as N,c as f,a as n,w as c,p as u,T as U,t as _,b as v,e as k,n as z,f as b}from"./app.e6c84446.js";import{_ as y}from"./Button.7514258e.js";import D from"./Uom.e8a1f8d9.js";import{_ as C}from"./FormInput.4db4024f.js";import{_ as E}from"./FormTextarea.a9afc9dc.js";import{_ as F}from"./MultiSelect.66ed4126.js";import{_ as P}from"./Modal.364f7810.js";import{r as T}from"./RectangleStackIcon.bf83fbfc.js";import{r as q}from"./ArrowUturnLeftIcon.53e84019.js";import{r as G}from"./CheckCircleIcon.4ac3de73.js";import"./open-closed.5200a5c6.js";function H(s,p){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M2 4.75C2 3.784 2.784 3 3.75 3h4.836c.464 0 .909.184 1.237.513l1.414 1.414a.25.25 0 00.177.073h4.836c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0116.25 17H3.75A1.75 1.75 0 012 15.25V4.75zm10.25 7a.75.75 0 000-1.5h-4.5a.75.75 0 000 1.5h4.5z","clip-rule":"evenodd"})])}function I(s,p){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M3.75 3A1.75 1.75 0 002 4.75v10.5c0 .966.784 1.75 1.75 1.75h12.5A1.75 1.75 0 0018 15.25v-8.5A1.75 1.75 0 0016.25 5h-4.836a.25.25 0 01-.177-.073L9.823 3.513A1.75 1.75 0 008.586 3H3.75zM10 8a.75.75 0 01.75.75v1.5h1.5a.75.75 0 010 1.5h-1.5v1.5a.75.75 0 01-1.5 0v-1.5h-1.5a.75.75 0 010-1.5h1.5v-1.5A.75.75 0 0110 8z","clip-rule":"evenodd"})])}const L={class:"flex flex-col md:flex-row space-x-2"},R={key:0,class:"text-gray-600"},J={key:1},K={key:2,class:"text-gray-600"},Q=["onSubmit"],W={class:"grid grid-cols-1 gap-y-3 gap-x-3 sm:grid-cols-6"},X={class:"sm:col-span-6 pb-3"},Y={class:"mt-1 flex flex-col md:flex-row space-y-2 md:space-y-0 items-center"},Z={class:"h-28 w-28 overflow-hidden rounded-full bg-gray-100"},ee=["src"],te=["value"],se={key:0,class:"text-sm text-red-600"},oe={class:"sm:col-span-2"},ae=b(" Code "),re={class:"sm:col-span-4"},le=b(" Name "),de={class:"sm:col-span-6"},ie=b(" Desc "),ne={class:"col-span-12 sm:col-span-6"},ue=t("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Operator ",-1),ce={key:0,class:"text-sm text-red-600"},me={key:0},pe={class:"sm:col-span-6"},ve={class:"flex space-x-1 mt-5 pt-5 justify-end"},fe=t("span",null," Back ",-1),_e={key:0,class:"flex space-x-1 items-center"},he=t("span",null," Deactivate ",-1),ge={key:1,class:"flex space-x-1 items-center"},ye=t("span",null," Activate ",-1),be=t("span",null," Save ",-1),Be={__name:"Form",props:{categories:Object,categoryGroups:Object,product:Object,uoms:Object,type:String,showModal:Boolean,operatorOptions:Object,permissions:[Array,Object]},emits:["modalClose"],setup(s,{emit:p}){const d=s,V=m([]),$=m([]),h=m(!1),M=m([]),O=m([]),e=m(g(w())),x=m([]);B().props.value.auth.operatorRole,N(()=>{e.value=d.product?g(d.product):g(w()),V.value=d.categories.data.map(o=>({id:o.id,name:o.name})),$.value=d.categoryGroups.data.map(o=>({id:o.id,name:o.name})),M.value=d.uoms.data.map(o=>({id:o.id,name:o.name})),x.value=d.operatorOptions.slice(1),O.value=d.product?d.product.unitCosts:null});function w(){return{code:"",date_from:"",desc:"",name:"",thumbnail:"",is_inventory:1,is_commission:"",is_supermarket_fee:"",category_id:"",category_group_id:"",operator_id:"",unit_cost:""}}function S(){e.value.clearErrors(),d.type==="create"&&e.value.transform(o=>({...o,operator_id:o.operator_id.id})).post("/products/create",{onSuccess:()=>{p("modalClose")},preserveState:!0,replace:!0}),d.type==="update"&&e.value.transform(o=>({...o,operator_id:o.operator_id.id})).post("/products/"+e.value.id+"/update",{onSuccess:()=>{p("modalClose")},preserveState:!0,replace:!0})}function A(){e.value.post("/products/"+e.value.id+"/toggle-activate-deactivate",{onSuccess:()=>{p("modalClose")},preserveState:!0,replace:!0})}function j(){h.value=!1}return(o,r)=>(a(),f(U,{to:"body"},[n(P,{open:s.showModal,onModalClose:r[6]||(r[6]=i=>o.$emit("modalClose"))},{header:c(()=>[t("div",L,[s.product?(a(),l("span",R," Editing ")):u("",!0),d.product?(a(),l("span",J,_(s.product.name),1)):(a(),l("span",K," Create New Product "))])]),default:c(()=>[t("form",{onSubmit:k(S,["prevent"]),id:"submit"},[t("div",W,[t("div",X,[t("div",Y,[t("span",Z,[s.product&&s.product.thumbnail?(a(),l("img",{key:0,class:"h-28 w-28 rounded-full border",src:s.product.thumbnail.full_url,alt:""},null,8,ee)):u("",!0),n(v(T),{class:"h-28 w-28 text-gray-300"})]),s.permissions.includes("update products")?(a(),l("input",{key:0,type:"file",onInput:r[0]||(r[0]=i=>e.value.thumbnail=i.target.files[0]),class:"ml-5 rounded-md border border-gray-300 bg-white py-2 px-3 text-sm font-medium leading-4 text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},null,32)):u("",!0),e.value.progress?(a(),l("progress",{key:1,value:e.value.progress.percentage,max:"100"},_(e.value.progress.percentage)+"% ",9,te)):u("",!0)]),e.value.errors.thumbnail?(a(),l("div",se,_(e.value.errors.thumbnail),1)):u("",!0)]),t("div",oe,[n(C,{modelValue:e.value.code,"onUpdate:modelValue":r[1]||(r[1]=i=>e.value.code=i),error:e.value.errors.code,disabled:!s.permissions.includes("update products"),required:"true"},{default:c(()=>[ae]),_:1},8,["modelValue","error","disabled"])]),t("div",re,[n(C,{modelValue:e.value.name,"onUpdate:modelValue":r[2]||(r[2]=i=>e.value.name=i),error:e.value.errors.name,disabled:!s.permissions.includes("update products"),required:"true"},{default:c(()=>[le]),_:1},8,["modelValue","error","disabled"])]),t("div",de,[n(E,{modelValue:e.value.desc,"onUpdate:modelValue":r[3]||(r[3]=i=>e.value.desc=i),disabled:!s.permissions.includes("update products"),error:e.value.errors.desc},{default:c(()=>[ie]),_:1},8,["modelValue","disabled","error"])]),t("div",ne,[ue,n(F,{modelValue:e.value.operator_id,"onUpdate:modelValue":r[4]||(r[4]=i=>e.value.operator_id=i),options:x.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"top",class:"mt-1"},null,8,["modelValue","options"]),e.value.errors.operator_id?(a(),l("div",ce,_(e.value.errors.operator_id),1)):u("",!0)])]),e.value.id?(a(),l("div",me)):u("",!0),t("div",pe,[t("div",ve,[n(y,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1",onClick:r[5]||(r[5]=k(i=>o.$emit("modalClose"),["prevent"])),form:"submit"},{default:c(()=>[n(v(q),{class:"w-4 h-4"}),fe]),_:1}),e.value.id&&s.permissions.includes("update products")?(a(),f(y,{key:0,type:"button",onClick:A,class:z(["text-white",[e.value.is_active?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"]])},{default:c(()=>[t("div",null,[e.value.is_active?(a(),l("span",_e,[n(v(H),{class:"w-4 h-4"}),he])):(a(),l("span",ge,[n(v(I),{class:"w-4 h-4"}),ye]))])]),_:1},8,["class"])):u("",!0),s.permissions.includes("update products")?(a(),f(y,{key:1,type:"submit",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1"},{default:c(()=>[n(v(G),{class:"w-4 h-4"}),be]),_:1})):u("",!0)])])],40,Q)]),_:1},8,["open"]),h.value?(a(),f(D,{key:0,product:s.product,uoms:s.uoms,showModal:h.value,onModalClose:j},null,8,["product","uoms","showModal"])):u("",!0)]))}};export{Be as default};
