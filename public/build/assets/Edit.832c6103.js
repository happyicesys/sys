import{g as _,T as k,Q as I,h as A,f as m,a as r,u as p,w as i,F as P,o as n,Z as L,b as e,e as x,n as N,l as u,d as c,c as g,t as w,i as T,O as M}from"./app.e2e8009f.js";import{_ as q}from"./Authenticated.9396108f.js";import{_ as y}from"./Button.43a1e8b0.js";import{_ as F}from"./DatePicker.a91439ee.js";import{_ as v}from"./FormInput.486838ec.js";import{_ as h}from"./MultiSelect.84894eaa.js";import{_ as J}from"./SearchAddressInput.25c3d6e2.js";import{r as G}from"./CheckCircleIcon.ff016b2d.js";import{r as z}from"./ArrowUturnLeftIcon.36b823a8.js";import{r as U}from"./XCircleIcon.78bc72ea.js";import"./keyboard.5e767ec3.js";import"./use-resolve-button-type.195f9253.js";import"./RectangleStackIcon.895605ca.js";import"./main.43fa5c03.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.da9dd820.js";import"./combobox.fd779225.js";import"./disposables.c3ed91b0.js";import"./MagnifyingGlassCircleIcon.7b05b4c1.js";const H=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Editing Customer ",-1),K={class:"m-2 sm:mx-5 sm:my-3 px-1 sm:px-2 lg:px-3"},Q={class:"mt-6 flex flex-col"},R={class:"-my-2 -mx-4 sm:-mx-6 lg:-mx-8"},Y={class:"shadow-sm ring-1 ring-black ring-opacity-5 p-5 mb-3"},Z={class:"pb-5"},W=e("div",{class:"relative mb-5"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-2 bg-white text-lg font-medium text-gray-900 rounded"}," Customer ")])],-1),X={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},ee={class:"sm:col-span-6 flex space-x-1"},te={key:0},se={key:1},oe={key:0,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-green-300"},de=e("div",{class:"flex flex-col"}," From CMS ",-1),re=[de],le={key:1,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-gray-300"},ae=e("div",{class:"flex flex-col"}," No Customer Binding ",-1),ie=[ae],ne={key:0,class:"sm:col-span-6"},ue=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vend ID# ",-1),ce={class:"mt-1"},me=["value"],ve={key:1,class:"sm:col-span-6"},pe=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vend ID# ",-1),_e={key:2,class:"sm:col-span-6"},fe=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),be={class:"mt-1"},xe=["value"],ge={key:3,class:"sm:col-span-6 grid grid-cols-1 gap-3 sm:grid-cols-6"},ye={class:"sm:col-span-2"},he={class:"sm:col-span-3"},Ve={key:4,class:"sm:col-span-6 text-blue-600 text-xs"},ke=["href"],we={class:"sm:col-span-2"},Ce={key:5,class:"sm:col-span-6 grid grid-cols-1 gap-3 sm:grid-cols-6"},Se=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-6 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-4 bg-white text-lg font-medium text-gray-900 rounded"}," Contact ")])])],-1),Oe={class:"sm:col-span-3"},Ne={class:"sm:col-span-3"},Ue={class:"sm:col-span-2"},je=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Phone Code ",-1),Be={key:0,class:"text-sm text-red-600"},De={class:"sm:col-span-4"},$e=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Address ")])])],-1),Ee={class:"sm:col-span-6"},Ie={class:"sm:col-span-3"},Ae={class:"sm:col-span-3"},Pe={class:"sm:col-span-3"},Le={class:"sm:col-span-3"},Te={class:"sm:col-span-3"},Me=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Country ",-1),qe={key:0,class:"text-sm text-red-600"},Fe={class:"sm:col-span-3 hidden"},Je={class:"sm:col-span-3 hidden"},Ge=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Operator ")])])],-1),ze={class:"col-span-12 sm:col-span-6"},He=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"},[c(" Operator "),e("span",{class:"text-red-500"}," * ")],-1),Ke={key:0,class:"text-sm text-red-600"},Qe={class:"sm:col-span-6"},Re={class:"flex justify-between"},Ye={class:"flex space-x-1"},Ze=e("span",null," Save Customer ",-1),We=e("span",null," Back ",-1),Xe=e("span",null," Unbind VM & Customer ",-1),et=e("span",null," Delete Customer ",-1),gt={__name:"Edit",props:{vendOptions:Object,countries:Object,operatorOptions:Object,customer:Object,type:String},setup(o){const l=o,t=_(k(O()));_([]),_([{id:"true",value:"Yes"},{id:"false",value:"No"}]);const f=_([]),C=_(1),V=_([]),b=I().props.auth.permissions,S=_([]);function O(){return{id:"",customer_id:"",operator_id:"",begin_date:"",termination_date:"",code:"",name:"",address:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""},contact:{name:"",email:"",phone_country_id:"",phone_num:""},vend_id:""}}A(()=>{f.value=l.countries.data,V.value=l.operatorOptions.data,t.value=l.customer?k({...JSON.parse(JSON.stringify(l.customer)),code:l.customer&&l.customer.person_id?l.customer.virtual_customer_code+" ("+l.customer.virtual_customer_prefix+")":l.customer?l.customer.code:null,operator_id:l.customer&&l.customer.operator_id?V.value.find(a=>a.id===l.customer.operator_id):null,vend_id:"",contact:l.customer?{...JSON.parse(JSON.stringify(l.customer.contact))}:{name:"",email:"",phone_country_id:"",phone_num:""},address:l.customer?{...l.customer.delivery_address,country_id:l.customer&&l.customer.delivery_address?f.value.find(a=>a.id===l.customer.delivery_address.country_id):null}:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""}}):k(O()),S.value=l.vendOptions.map(a=>({id:a.id,full_name:a.code}))});function j(a){t.value.clearErrors(),t.value.delete("/customers/"+a,{onSuccess:()=>{M.push("/customers")},preserveState:!0,replace:!0})}function B(a){t.value.clearErrors(),t.value.transform(s=>({id:s.vend_id?s.vend_id.id:null,customer:{...s,begin_date:s.begin_date&&s.begin_date!="Invalid date"?s.begin_date:null,termination_date:s.termination_date&&s.termination_date!="Invalid date"?s.termination_date:null,operator_id:s.operator_id?s.operator_id.id:null,contact:{...s.contact,phone_country_id:s.contact.phone_country_id?s.contact.phone_country_id.id:null},address:{...s.address,country_id:s.address.country_id?s.address.country_id.id:null}}})).post("/customers/"+a+"/update",{onSuccess:()=>{},preserveState:!0,replace:!0})}function D(){t.value.clearErrors(),t.value.post("/customers/"+t.value.id+"/update",{onSuccess:()=>{emit("modalClose")},preserveState:!0,replace:!0})}function $(a){t.value.customer.address={block_num:a.BLK_NO,building:a.BUILDING,country_id:f.value[0],latitude:a.LATITUDE,longitude:a.LONGTITUDE,postcode:a.POSTAL,street_name:a.ROAD_NAME,unit_num:""}}function E(a){t.value.post("/vends/"+a+"/unbind-customer",{onSuccess:()=>{},preserveState:!0,replace:!0})}return(a,s)=>(n(),m(P,null,[r(p(L),{title:"Customer"}),r(q,null,{header:i(()=>[H]),default:i(()=>[e("div",K,[e("div",Q,[e("div",R,[e("div",Y,[e("form",{onSubmit:x(D,["prevent"]),id:"submit"},[e("div",Z,[W,e("div",X,[e("div",ee,[e("div",{class:N(["inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit",[o.customer.is_active?"bg-green-300":"bg-red-300"]])},[o.customer.is_active?(n(),m("span",te," Active ")):u("",!0),o.customer.is_active?u("",!0):(n(),m("span",se," Not Active "))],2),o.customer.person_id?(n(),m("div",oe,re)):u("",!0),o.customer.vend?u("",!0):(n(),m("div",le,ie))]),o.customer.vend?(n(),m("div",ne,[ue,e("div",ce,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:o.customer.vend?o.customer.vend.code:"",disabled:""},null,8,me)])])):u("",!0),o.customer.vend?u("",!0):(n(),m("div",ve,[pe,r(h,{modelValue:t.value.vend_id,"onUpdate:modelValue":s[0]||(s[0]=d=>t.value.vend_id=d),options:S.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"])])),o.customer.id&&o.customer.person_id?(n(),m("div",_e,[fe,e("div",be,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:o.customer.person_id?o.customer.virtual_customer_code+" ("+o.customer.virtual_customer_prefix+") - "+o.customer.name:o.customer.code+" - "+o.customer.name,disabled:""},null,8,xe)])])):u("",!0),o.customer.id&&!o.customer.person_id||!o.customer.id&&C.value!=1?(n(),m("div",ge,[e("div",ye,[r(v,{modelValue:t.value.code,"onUpdate:modelValue":s[1]||(s[1]=d=>t.value.code=d),error:t.value.errors.code,disabled:t.value.person_id},{default:i(()=>[c(" Cust Code ")]),_:1},8,["modelValue","error","disabled"])]),e("div",he,[r(v,{modelValue:t.value.name,"onUpdate:modelValue":s[2]||(s[2]=d=>t.value.name=d),error:t.value.errors.name,required:"true",disabled:t.value.person_id},{default:i(()=>[c(" Cust Name ")]),_:1},8,["modelValue","error","disabled"])])])):u("",!0),o.customer.person_id?(n(),m("div",Ve,[c(" ** Customer Data only editable from CMS "),e("span",null,[e("a",{class:N([t.value.person_id?"text-blue-700":"text-gray-500"]),target:"_blank",href:"//admin.happyice.com.sg/person/"+t.value.person_id+"/edit"}," (Click Here) ",10,ke)])])):u("",!0),e("div",we,[p(b).includes("update customers")?(n(),g(F,{key:0,modelValue:t.value.begin_date,"onUpdate:modelValue":s[3]||(s[3]=d=>t.value.begin_date=d),error:t.value.errors.begin_date,onInput:s[4]||(s[4]=d=>a.onDateFromChanged())},{default:i(()=>[c(" Begin Date ")]),_:1},8,["modelValue","error"])):u("",!0)]),o.customer.id&&!o.customer.person_id||!o.customer.id&&C.value!=1?(n(),m("div",Ce,[Se,e("div",Oe,[r(v,{modelValue:t.value.contact.name,"onUpdate:modelValue":s[5]||(s[5]=d=>t.value.contact.name=d),error:t.value.errors["contact.name"],disabled:o.customer.person_id},{default:i(()=>[c(" Name ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Ne,[r(v,{modelValue:t.value.contact.email,"onUpdate:modelValue":s[6]||(s[6]=d=>t.value.contact.email=d),error:t.value.errors["contact.email"],disabled:o.customer.person_id},{default:i(()=>[c(" Email ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Ue,[je,r(h,{modelValue:t.value.contact.phone_country_id,"onUpdate:modelValue":s[7]||(s[7]=d=>t.value.contact.phone_country_id=d),options:f.value,disabled:t.value.person_id,trackBy:"id",valueProp:"id",label:"phone_code",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options","disabled"]),t.value.errors["contact.phone_country_id"]?(n(),m("div",Be,w(t.value.errors["contact.phone_country_id"]),1)):u("",!0)]),e("div",De,[r(v,{modelValue:t.value.contact.phone_num,"onUpdate:modelValue":s[8]||(s[8]=d=>t.value.contact.phone_num=d),required:"true",error:t.value.errors["contact.phone_num"],disabled:o.customer.person_id},{default:i(()=>[c(" Phone Number ")]),_:1},8,["modelValue","error","disabled"])]),$e,e("div",Ee,[r(J,{modelValue:t.value.address.postcode,"onUpdate:modelValue":s[9]||(s[9]=d=>t.value.address.postcode=d),onSelected:$,required:"true",error:t.value.errors["address.postcode"],disabled:o.customer.person_id},{default:i(()=>[c(" Postcode ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Ie,[r(v,{modelValue:t.value.address.unit_num,"onUpdate:modelValue":s[10]||(s[10]=d=>t.value.address.unit_num=d),required:"true",error:t.value.errors["address.unit_num"]},{default:i(()=>[c(" Unit Num ")]),_:1},8,["modelValue","error"])]),e("div",Ae,[r(v,{modelValue:t.value.address.block_num,"onUpdate:modelValue":s[11]||(s[11]=d=>t.value.address.block_num=d),error:t.value.errors["address.block_num"],disabled:o.customer.person_id},{default:i(()=>[c(" Block Num ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Pe,[r(v,{modelValue:t.value.address.building,"onUpdate:modelValue":s[12]||(s[12]=d=>t.value.address.building=d),error:t.value.errors["address.building"],disabled:o.customer.person_id},{default:i(()=>[c(" Building Name ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Le,[r(v,{modelValue:t.value.address.street_name,"onUpdate:modelValue":s[13]||(s[13]=d=>t.value.address.street_name=d),required:"true",error:t.value.errors["address.street_name"],disabled:o.customer.person_id},{default:i(()=>[c(" Street Name ")]),_:1},8,["modelValue","error","disabled"])]),e("div",Te,[Me,r(h,{modelValue:t.value.address.country_id,"onUpdate:modelValue":s[14]||(s[14]=d=>t.value.address.country_id=d),options:f.value,trackBy:"id",valueProp:"id",label:"name",placeholder:"Select","open-direction":"bottom",class:"mt-1",disabled:o.customer.person_id},null,8,["modelValue","options","disabled"]),t.value.errors["address.country_id"]?(n(),m("div",qe,w(t.value.errors["address.country_id"]),1)):u("",!0)]),e("div",Fe,[r(v,{modelValue:t.value.address.latitude,"onUpdate:modelValue":s[15]||(s[15]=d=>t.value.address.latitude=d)},{default:i(()=>[c(" Latitude ")]),_:1},8,["modelValue"])]),e("div",Je,[r(v,{modelValue:t.value.address.longitude,"onUpdate:modelValue":s[16]||(s[16]=d=>t.value.address.longitude=d)},{default:i(()=>[c(" Longitude ")]),_:1},8,["modelValue"])])])):u("",!0),Ge,e("div",ze,[He,r(h,{modelValue:t.value.operator_id,"onUpdate:modelValue":s[17]||(s[17]=d=>t.value.operator_id=d),options:V.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"top",class:"mt-1"},null,8,["modelValue","options"]),t.value.errors.operator_id?(n(),m("div",Ke,w(t.value.errors.operator_id),1)):u("",!0)]),e("div",Qe,[e("span",Re,[e("span",Ye,[p(b).includes("update customers")?(n(),g(y,{key:0,type:"button",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1",onClick:s[18]||(s[18]=x(d=>B(t.value.id),["prevent"]))},{default:i(()=>[r(p(G),{class:"w-4 h-4"}),Ze]),_:1})):u("",!0),r(p(T),{href:"/customers"},{default:i(()=>[r(y,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1"},{default:i(()=>[r(p(z),{class:"w-4 h-4"}),We]),_:1})]),_:1})]),o.customer.vend&&p(b).includes("update customers")?(n(),g(y,{key:0,type:"button",class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:s[19]||(s[19]=x(d=>E(o.customer.vend.id),["prevent"]))},{default:i(()=>[r(p(U),{class:"w-4 h-4"}),Xe]),_:1})):u("",!0),!o.customer.vend&&p(b).includes("update customers")?(n(),g(y,{key:1,type:"button",class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:s[20]||(s[20]=x(d=>j(o.customer.id),["prevent"]))},{default:i(()=>[r(p(U),{class:"w-4 h-4"}),et]),_:1})):u("",!0)])])])])],32)])])])])]),_:1})],64))}};export{gt as default};
