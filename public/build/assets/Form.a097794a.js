import{i as v,u as y,j as S,o as l,c as j,a as n,w as i,T as A,d as e,g as d,p as c,t as m,n as C,b as f,F as N,m as M,e as U,f as p}from"./app.38583bed.js";import{_ as x}from"./Button.b4603e63.js";import{_ as B}from"./FormInput.38b6eb49.js";import{_ as F}from"./FormTextarea.b6e73352.js";import{_ as D}from"./Modal.0e37089d.js";import{_ as h}from"./MultiSelect.02550665.js";import{r as T}from"./PlusCircleIcon.4ea41235.js";import{r as E}from"./ArrowUturnLeftIcon.2e8176c6.js";import{r as P}from"./CheckCircleIcon.4bc5cd6a.js";import{r as q}from"./BackspaceIcon.efac7a80.js";import"./open-closed.7c8cd034.js";const L={class:"flex flex-col md:flex-row space-x-2"},R={key:0,class:"text-gray-600"},G={key:1},H={key:2,class:"text-gray-600"},I=["onSubmit"],J={class:"grid grid-cols-1 gap-y-3 gap-x-3 sm:grid-cols-6"},K={class:"sm:col-span-2"},Q=p(" Code "),W={class:"sm:col-span-4"},X=p(" Name "),Y={class:"sm:col-span-6"},Z=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Country ",-1),ee={key:0,class:"text-sm text-red-600"},te={class:"sm:col-span-6"},se=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Timezone ",-1),oe={key:0,class:"text-sm text-red-600"},ae={class:"sm:col-span-6"},re=p(" Remarks "),le={key:0,class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},ne=e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-center"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900"}," Access Vending Machine(s) ")])],-1),de=[ne],ie={key:1,class:"sm:col-span-5"},ce=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vending Machine to Bind ",-1),me={key:0,class:"text-sm text-red-600"},ue={key:2,class:"sm:col-span-1"},pe=e("span",null," Add ",-1),_e={key:3,class:"sm:col-span-6 flex flex-col mt-3"},ve={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},fe={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},xe={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},ye={class:"min-w-full divide-y divide-gray-300"},he=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," # "),e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Vend ID "),e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Name "),e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Action ")])],-1),ge={class:"bg-white"},be={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},Ve={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},we={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},ke={key:0},Ce=e("br",null,null,-1),Be={key:1},ze={class:"whitespace-nowrap py-4 text-sm text-center"},$e={key:0},Oe=e("td",{colspan:"4",class:"whitespace-nowrap py-4 text-sm font-medium text-red-600 text-center"}," No Binding = Access to All ",-1),Se=[Oe],je={class:"sm:col-span-6"},Ae={class:"flex space-x-1 mt-5 justify-end"},Ne=e("span",null," Back ",-1),Me=e("span",null," Save ",-1),Je={__name:"Form",props:{countries:[Array,Object],operator:Object,timezones:[Array,Object],type:String,showModal:Boolean,unbindedVends:[Array,Object]},emits:["modalClose","refreshData"],setup(_,{emit:g}){const r=_,b=v([]),t=v(y(w())),V=v([]),u=v([]);S(()=>{b.value=r.countries.data,V.value=r.timezones.map((a,s)=>({id:s,name:a})),u.value=r.unbindedVends.data,t.value=r.operator?y(r.operator):y(w())});function w(){return{id:"",code:"",name:"",country_id:"",timezone:"",remarks:"",vend_id:""}}function z(){r.operator.vends.indexOf(t.value.vend_id)<0&&(r.operator.vends.push(t.value.vend_id),r.operator.vends.sort((a,s)=>a.code-s.code),u.value.splice(u.value.indexOf(t.value.vend_id),1),u.value.sort((a,s)=>a.code-s.code))}function $(a){r.operator.vends.splice(r.operator.vends.indexOf(a),1),u.value.push(a),u.value.sort((s,o)=>s.code-o.code)}function O(){t.value.clearErrors(),r.type==="create"&&t.value.transform(a=>({...a,timezone:a.timezone.name,country_id:a.country_id.id})).post("/operators/create",{onSuccess:()=>{g("modalClose")},preserveState:!0,replace:!0}),r.type==="update"&&t.value.transform(a=>({...a,timezone:a.timezone.name,country_id:a.country_id.id,operator:r.operator})).post("/operators/"+t.value.id+"/update",{onSuccess:()=>{g("modalClose")},preserveState:!0,replace:!0})}return(a,s)=>(l(),j(A,{to:"body"},[n(D,{open:_.showModal,onModalClose:s[8]||(s[8]=o=>a.$emit("modalClose"))},{header:i(()=>[e("div",L,[r.operator?(l(),d("span",R," Editing ")):c("",!0),r.operator?(l(),d("span",G,m(r.operator.name),1)):(l(),d("span",H," Create New Operator "))])]),default:i(()=>[e("form",{onSubmit:U(O,["prevent"]),id:"submit"},[e("div",J,[e("div",K,[n(B,{modelValue:t.value.code,"onUpdate:modelValue":s[0]||(s[0]=o=>t.value.code=o),error:t.value.errors.code},{default:i(()=>[Q]),_:1},8,["modelValue","error"])]),e("div",W,[n(B,{modelValue:t.value.name,"onUpdate:modelValue":s[1]||(s[1]=o=>t.value.name=o),error:t.value.errors.name,required:"true"},{default:i(()=>[X]),_:1},8,["modelValue","error"])]),e("div",Y,[Z,n(h,{modelValue:t.value.country_id,"onUpdate:modelValue":s[2]||(s[2]=o=>t.value.country_id=o),options:b.value,trackBy:"id",valueProp:"id",label:"name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),t.value.errors.country_id?(l(),d("div",ee,m(t.value.errors.country_id),1)):c("",!0)]),e("div",te,[se,n(h,{modelValue:t.value.timezone,"onUpdate:modelValue":s[3]||(s[3]=o=>t.value.timezone=o),options:V.value,trackBy:"id",valueProp:"id",label:"name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),t.value.errors.timezone?(l(),d("div",oe,m(t.value.errors.timezone),1)):c("",!0)]),e("div",ae,[n(F,{modelValue:t.value.remarks,"onUpdate:modelValue":s[4]||(s[4]=o=>t.value.remarks=o),error:t.value.errors.remarks},{default:i(()=>[re]),_:1},8,["modelValue","error"])]),t.value.id?(l(),d("div",le,de)):c("",!0),t.value.id?(l(),d("div",ie,[ce,n(h,{modelValue:t.value.vend_id,"onUpdate:modelValue":s[5]||(s[5]=o=>t.value.vend_id=o),options:u.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1",ref:"multiselect"},null,8,["modelValue","options"]),t.value.errors.vend_id?(l(),d("div",me,m(t.value.errors.vend_id),1)):c("",!0)])):c("",!0),t.value.id?(l(),d("div",ue,[n(x,{type:"button",onClick:s[6]||(s[6]=o=>z()),class:C(["bg-green-500 hover:bg-green-600 text-white flex space-x-1 sm:mt-6",[t.value.vend_id?"":"opacity-50 cursor-not-allowed"]]),disabled:!t.value.vend_id},{default:i(()=>[n(f(T),{class:"w-4 h-4"}),pe]),_:1},8,["class","disabled"])])):c("",!0),t.value.id?(l(),d("div",_e,[e("div",ve,[e("div",fe,[e("div",xe,[e("table",ye,[he,e("tbody",ge,[(l(!0),d(N,null,M(_.operator.vends,(o,k)=>(l(),d("tr",{key:o.id,class:C(k%2===0?void 0:"bg-gray-50")},[e("td",be,m(k+1),1),e("td",Ve,m(o.code),1),e("td",we,[o.latestVendBinding&&o.latestVendBinding.customer?(l(),d("span",ke,[p(m(o.latestVendBinding.customer.code)+" ",1),Ce,p(" "+m(o.latestVendBinding.customer.name),1)])):(l(),d("span",Be,m(o.name),1))]),e("td",ze,[n(x,{class:"bg-red-400 hover:bg-red-500 text-white",onClick:Ue=>$(o)},{default:i(()=>[n(f(q),{class:"w-4 h-4"})]),_:2},1032,["onClick"])])],2))),128)),_.operator.vends.length?c("",!0):(l(),d("tr",$e,Se))])])])])])])):c("",!0)]),e("div",je,[e("div",Ae,[n(x,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1",onClick:s[7]||(s[7]=o=>a.$emit("modalClose")),form:"submit"},{default:i(()=>[n(f(E),{class:"w-4 h-4"}),Ne]),_:1}),n(x,{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1"},{default:i(()=>[n(f(P),{class:"w-4 h-4"}),Me]),_:1})])])],40,I)]),_:1},8,["open"])]))}};export{Je as default};
