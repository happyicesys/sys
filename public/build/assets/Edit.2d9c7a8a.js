import{g as _,T as w,Q as A,h as P,f as l,a as c,u,w as m,F as $,o as d,Z as J,b as e,t as f,e as p,n as E,l as a,c as x,d as y,m as R,S as H,i as L,k as T,O as z}from"./app.fc610ccf.js";import{_ as K}from"./Authenticated.b95439c2.js";import{_ as h}from"./Button.c64439a1.js";import{_ as N}from"./DatePicker.78104d51.js";import{_ as k}from"./MultiSelect.1428cc3a.js";import{r as D}from"./CheckCircleIcon.4b5ef387.js";import{r as Q}from"./ArrowPathIcon.b2df11f9.js";import{r as Y}from"./ArrowUturnLeftIcon.3730de1a.js";import{r as Z}from"./XCircleIcon.507e5fd3.js";import{r as q}from"./PaperClipIcon.09c80caf.js";import"./keyboard.6c8867c9.js";import"./use-resolve-button-type.aa690f36.js";import"./RectangleStackIcon.db836e4e.js";import"./main.3dece1b5.js";import"./MultiSelect.vue_vue_type_style_index_1_lang.5df91af7.js";const G={class:"font-semibold text-xl text-gray-800 leading-tight"},W={class:"m-2 sm:mx-5 sm:my-3 px-1 sm:px-2 lg:px-3"},X={class:"mt-6 flex flex-col"},ee={class:"-my-2 -mx-4 sm:-mx-6 lg:-mx-8"},te={class:"shadow-sm ring-1 ring-black ring-opacity-5 p-5 mb-3"},se={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},oe=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," Vending Machine ")])])],-1),ie={class:"sm:col-span-6"},ne={key:0},de={key:1},re={key:0,class:"sm:col-span-5"},ae=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Vend ID# ",-1),le={class:"mt-1"},ce=["value"],ue={class:"sm:col-span-2"},me={class:"sm:col-span-2"},ve={class:"sm:col-span-3"},_e=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Is Factory? ",-1),ge={key:0,class:"text-sm text-red-600"},fe={class:"sm:col-span-3"},pe=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Is Active? (Vending Machine) ",-1),xe={key:0,class:"text-sm text-red-600"},he={class:"sm:col-span-6"},be={class:"flex space-x-1"},ye=e("span",null," Save Vending Machine ",-1),we=e("span",null," Restart ",-1),ke=e("div",{class:"relative mb-5"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-2 bg-white text-lg font-medium text-gray-900 rounded"}," Customer ")])],-1),Ce={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},Ve={class:"sm:col-span-6"},Se={key:0,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-green-300"},Oe=e("div",{class:"flex flex-col"}," From CMS ",-1),je=[Oe],$e={key:1,class:"inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit bg-gray-300"},Ee=e("div",{class:"flex flex-col"}," No Customer Binding ",-1),Ne=[Ee],De={key:0,class:"sm:col-span-6"},Me=e("legend",{class:"sr-only"},"Plan",-1),Be={class:"space-y-5"},Fe={class:"relative flex items-start"},Ie={class:"flex h-6 items-center"},Ue=e("div",{class:"ml-3 text-sm leading-6"},[e("label",{for:"is_existing",class:"font-medium text-gray-900"},"Select Existing Customer")],-1),Ae={key:1,class:"sm:col-span-6"},Pe={class:"sm:col-span-6"},Je=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),Re={key:2,class:"sm:col-span-6"},He=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),Le={class:"mt-1"},Te=["value"],ze={key:3,class:"sm:col-span-6"},Ke=e("label",{for:"text",class:"flex justify-start text-sm font-medium text-gray-700"}," Customer ",-1),Qe={class:"mt-1"},Ye=["value"],Ze={key:4,class:"sm:col-span-6 text-blue-600 text-xs"},qe=["href"],Ge={key:5,class:"sm:col-span-6 text-blue-600 text-xs"},We=["href"],Xe={class:"sm:col-span-6 pt-3"},et={class:"flex justify-between"},tt={class:"flex space-x-1"},st=e("span",null," Save Customer ",-1),ot=e("span",null," Back ",-1),it=e("span",null," Unbind VM & Customer ",-1),nt={class:"grid grid-cols-1 gap-3 sm:grid-cols-6 pb-5 mb-3"},dt=e("div",{class:"sm:col-span-6 pt-2 pb-1 md:pt-5 md:pb-3"},[e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-start"},[e("span",{class:"px-3 bg-white text-lg font-medium text-gray-900 rounded"}," APK Logs ")])])],-1),rt={class:"sm:col-span-6 flex flex-col mt-3"},at={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-3 lg:-mx-5"},lt={class:"inline-block min-w-full py-2 align-middle md:px-4 lg:px-6"},ct={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},ut={class:"min-w-full divide-y divide-gray-300"},mt=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," # "),e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," Created At "),e("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"}," File ")])],-1),vt={class:"bg-white"},_t={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 text-center"},gt={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"},ft={class:"whitespace-nowrap py-4 text-sm text-center"},pt={class:"flex w-0 space-x-2 items-center"},xt=["href"],ht={key:0},bt=e("td",{colspan:"3",class:"whitespace-nowrap py-4 text-sm font-medium text-black text-center"}," No records found ",-1),yt=[bt],Ut={__name:"Edit",props:{adminCustomerOptions:Object,countries:Object,operatorOptions:Object,vend:Object,type:String},setup(s){const n=s,i=_(w(O())),C=_([]),v=_([{id:"true",value:"Yes"},{id:"false",value:"No"}]),V=_([]),b=_(1),S=_([]),g=A().props.auth.permissions;function O(){return{id:"",begin_date:"",code:"",customer_id:"",customer:{operator_id:"",begin_date:"",termination_date:"",id:"",code:"",name:"",address:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""},contact:{name:"",email:"",phone_country_id:"",phone_num:""}},termination_date:"",is_testing:"",is_active:""}}P(()=>{V.value=n.countries.data,S.value=n.operatorOptions.data,i.value=n.vend?w({...n.vend,is_active:n.vend.is_active==1?v.value.find(o=>o.id==="true"):v.value.find(o=>o.id==="false"),is_testing:n.vend.is_testing==1?v.value.find(o=>o.id==="true"):v.value.find(o=>o.id==="false"),customer:{...JSON.parse(JSON.stringify(n.vend.customer)),code:n.vend.customer&&n.vend.customer.person_id?n.vend.customer.virtual_customer_code+" ("+n.vend.customer.virtual_customer_prefix+")":n.vend.customer?n.vend.customer.code:null,operator_id:n.vend.customer&&n.vend.customer.operator_id?S.value.find(o=>o.id===n.vend.customer.operator_id):null,contact:n.vend.customer?{...JSON.parse(JSON.stringify(n.vend.customer.contact))}:{name:"",email:"",phone_country_id:"",phone_num:""},address:n.vend.customer?{...n.vend.customer.delivery_address,country_id:n.vend&&n.vend.customer&&n.vend.customer.delivery_address?V.value.find(o=>o.id===n.vend.customer.delivery_address.country_id):null}:{block_num:"",building:"",country_id:"",latitude:"",longitude:"",postcode:"",street_name:"",unit_num:""}}}):w(O()),C.value=n.adminCustomerOptions.data.map(o=>({id:o.id,full_name:o.person_id?o.virtual_customer_code+" ("+o.virtual_customer_prefix+") - "+o.name:o.code+" - "+o.name}))});function M(o){z.post("/vends/"+o+"/restart",{},{preserveScroll:!0,preserveState:!0,replace:!0,onSuccess:()=>{emit("modalClose")}})}function B(o){i.value.clearErrors(),i.value.transform(t=>({...t,customer:{...t.customer,begin_date:t.customer.begin_date&&t.customer.begin_date!="Invalid date"?t.customer.begin_date:null,termination_date:t.customer.termination_date&&t.customer.termination_date!="Invalid date"?t.customer.termination_date:null,operator_id:t.customer.operator_id?t.customer.operator_id.id:null,contact:{...t.customer.contact,phone_country_id:t.customer.contact.phone_country_id?t.customer.contact.phone_country_id.id:null},address:{...t.customer.address,country_id:t.customer.address.country_id?t.customer.address.country_id.id:null}},customer_id:t.customer_id?t.customer_id.id:null,is_existing:b.value})).post("/customers/"+o+"/update",{onSuccess:()=>{},preserveState:!0,replace:!0})}function F(o){i.value.clearErrors(),i.value.transform(t=>({...t,begin_date:t.begin_date&&t.begin_date!="Invalid date"?t.begin_date:null,termination_date:t.termination_date&&t.termination_date!="Invalid date"?t.termination_date:null,is_testing:t.is_testing.id,is_active:t.is_active.id})).post("/vends/"+o+"/update",{onSuccess:()=>{},preserveState:!0,replace:!0})}function I(){i.value.clearErrors(),i.value.post("/vends/"+i.value.id+"/update",{onSuccess:()=>{emit("modalClose")},preserveState:!0,replace:!0})}function U(o){i.value.post("/vends/"+o+"/unbind-customer/settings",{onSuccess:()=>{},preserveState:!0,replace:!0})}return(o,t)=>(d(),l($,null,[c(u(J),{title:"VM Edit"}),c(K,null,{header:m(()=>[e("h2",G," Editing Vending Machine "+f(s.vend.code),1)]),default:m(()=>[e("div",W,[e("div",X,[e("div",ee,[e("div",te,[e("form",{onSubmit:p(I,["prevent"]),id:"submit"},[e("div",se,[oe,e("div",ie,[e("div",{class:E(["inline-flex justify-center items-center rounded px-1.5 py-0.5 text-xs font-medium border w-fit",[s.vend.is_active?"bg-green-300":"bg-red-300"]])},[s.vend.is_active?(d(),l("span",ne," Active ")):a("",!0),s.vend.is_active?a("",!0):(d(),l("span",de," Not Active "))],2)]),s.vend?(d(),l("div",re,[ae,e("div",le,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:s.vend?s.vend.code:"",disabled:""},null,8,ce)])])):a("",!0),e("div",ue,[u(g).includes("update vends")?(d(),x(N,{key:0,modelValue:i.value.begin_date,"onUpdate:modelValue":t[0]||(t[0]=r=>i.value.begin_date=r),error:i.value.errors.begin_date,onInput:t[1]||(t[1]=r=>o.onDateFromChanged())},{default:m(()=>[y(" Begin Date ")]),_:1},8,["modelValue","error"])):a("",!0)]),e("div",me,[u(g).includes("update vends")?(d(),x(N,{key:0,modelValue:i.value.termination_date,"onUpdate:modelValue":t[2]||(t[2]=r=>i.value.termination_date=r),error:i.value.errors.termination_date,minDate:i.value.begin_date},{default:m(()=>[y(" Retired Date ")]),_:1},8,["modelValue","error","minDate"])):a("",!0)]),e("div",ve,[_e,c(k,{modelValue:i.value.is_testing,"onUpdate:modelValue":t[3]||(t[3]=r=>i.value.is_testing=r),options:v.value,trackBy:"id",valueProp:"id",label:"value",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),i.value.errors["customer.is_testing"]?(d(),l("div",ge,f(i.value.errors["customer.is_testing"]),1)):a("",!0)]),e("div",fe,[pe,c(k,{modelValue:i.value.is_active,"onUpdate:modelValue":t[4]||(t[4]=r=>i.value.is_active=r),options:v.value,trackBy:"id",valueProp:"id",label:"value",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"]),i.value.errors.is_active?(d(),l("div",xe,f(i.value.errors.is_active),1)):a("",!0)]),e("div",he,[e("span",be,[u(g).includes("update vends")?(d(),x(h,{key:0,type:"button",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1",onClick:t[5]||(t[5]=p(r=>F(s.vend.id),["prevent"]))},{default:m(()=>[c(u(D),{class:"w-4 h-4"}),ye]),_:1})):a("",!0),c(h,{class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:t[6]||(t[6]=p(r=>M(s.vend.id),["prevent"]))},{default:m(()=>[c(u(Q),{class:"w-4 h-4"}),we]),_:1})])])]),e("div",null,[ke,e("div",Ce,[e("div",Ve,[s.vend.customer&&s.vend.customer.person_id?(d(),l("div",Se,je)):a("",!0),!s.vend.customer||!s.vend.customer.id?(d(),l("div",$e,Ne)):a("",!0)]),s.vend.customer?a("",!0):(d(),l("fieldset",De,[Me,e("div",Be,[e("div",Fe,[e("div",Ie,[R(e("input",{id:"isExisting","aria-describedby":"is-existing-description",name:"isExisting",type:"radio","onUpdate:modelValue":t[7]||(t[7]=r=>b.value=r),value:"1",class:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-600"},null,512),[[H,b.value]])]),Ue])])])),!s.vend.customer&&b.value==1?(d(),l("div",Ae,[e("div",Pe,[Je,c(k,{modelValue:i.value.customer_id,"onUpdate:modelValue":t[8]||(t[8]=r=>i.value.customer_id=r),options:C.value,trackBy:"id",valueProp:"id",label:"full_name",placeholder:"Select","open-direction":"bottom",class:"mt-1"},null,8,["modelValue","options"])])])):a("",!0),s.vend.customer&&s.vend.customer.person_id?(d(),l("div",Re,[He,e("div",Le,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:"#"+(s.vend.customer.id+1e4)+" - "+s.vend.customer_code+" - "+s.vend.customer_name,disabled:""},null,8,Te)])])):a("",!0),s.vend.customer&&!s.vend.customer.person_id?(d(),l("div",ze,[Ke,e("div",Qe,[e("input",{type:"text",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-sm border-gray-300 rounded-md bg-gray-200 hover:cursor-not-allowed",value:"#"+(s.vend.customer.id+1e4)+" - "+(s.vend.customer.code?s.vend.customer.code:"")+" - "+s.vend.customer_name,disabled:""},null,8,Ye)])])):a("",!0),s.vend.customer&&s.vend.customer.person_id?(d(),l("div",Ze,[y(" ** Customer Data only editable from CMS "),e("span",null,[e("a",{class:"text-blue-700",target:"_blank",href:"//admin.happyice.com.sg/person/"+s.vend.customer.person_id+"/edit"}," (Click Here) ",8,qe)])])):a("",!0),s.vend.customer&&!s.vend.customer.person_id?(d(),l("div",Ge,[y(" ** Edit customer data "),e("span",null,[e("a",{class:"text-blue-700",target:"_blank",href:"/customers/"+s.vend.customer.id+"/edit"}," (Click Here) ",8,We)])])):a("",!0),e("div",Xe,[e("span",et,[e("span",tt,[u(g).includes("update vends")&&!s.vend.customer?(d(),x(h,{key:0,type:"button",class:"bg-green-500 hover:bg-green-600 text-white flex space-x-1",onClick:t[9]||(t[9]=p(r=>B(i.value.customer_id),["prevent"]))},{default:m(()=>[c(u(D),{class:"w-4 h-4"}),st]),_:1})):a("",!0),c(u(L),{href:"/settings"},{default:m(()=>[c(h,{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 flex space-x-1"},{default:m(()=>[c(u(Y),{class:"w-4 h-4"}),ot]),_:1})]),_:1})]),s.vend&&s.vend.customer&&u(g).includes("update vends")?(d(),x(h,{key:0,type:"button",class:"bg-red-500 hover:bg-red-600 text-white flex space-x-1",onClick:t[10]||(t[10]=p(r=>U(i.value.id),["prevent"]))},{default:m(()=>[c(u(Z),{class:"w-4 h-4"}),it]),_:1})):a("",!0)])])])]),e("div",nt,[dt,e("div",rt,[e("div",at,[e("div",lt,[e("div",ct,[e("table",ut,[mt,e("tbody",vt,[(d(!0),l($,null,T(s.vend.logs,(r,j)=>(d(),l("tr",{key:r.id,class:E(j%2===0?void 0:"bg-gray-50")},[e("td",_t,f(j+1),1),e("td",gt,f(r.created_at),1),e("td",ft,[e("div",pt,[c(u(q),{class:"h-5 w-5 flex-shrink-0 text-gray-400","aria-hidden":"true"}),e("a",{href:r.full_url,target:"_blank",class:"font-medium text-indigo-600 hover:text-indigo-500"},"Download",8,xt)])])],2))),128)),!s.vend.logs||!s.vend.logs.length?(d(),l("tr",ht,yt)):a("",!0)])])])])])])])],32)])])])])]),_:1})],64))}};export{Ut as default};
